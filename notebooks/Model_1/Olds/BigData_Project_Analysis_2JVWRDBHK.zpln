{
  "paragraphs": [
    {
      "text": "%md\n\n# Load data from competitions.json",
      "user": "anonymous",
      "dateUpdated": "2024-05-19 11:44:15.365",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eLoad data from competitions.json\u003c/h1\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715623641282_2066904360",
      "id": "paragraph_1715345243476_1485694006",
      "dateCreated": "2024-05-13 18:07:21.282",
      "dateStarted": "2024-05-19 11:44:15.402",
      "dateFinished": "2024-05-19 11:44:18.017",
      "status": "FINISHED"
    },
    {
      "text": "import org.apache.spark.sql.SparkSession\r\n\r\nval spark \u003d SparkSession.builder()\r\n  .appName(\"Football Data Analysis\")\r\n  .getOrCreate()\r\n\r\nval bucketPath \u003d \"./data/competitions.json\"\r\n\r\nval footballData \u003d spark.read.option(\"header\", \"true\").option(\"multiline\", \"true\").json(bucketPath)\r\n\r\nfootballData.show(5)\r\n",
      "user": "anonymous",
      "dateUpdated": "2024-05-19 11:44:18.106",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------------------+--------------+-------------------------+--------------------+-----------------+------------+--------------------+-------------------+--------------------+--------------------+---------+-----------+\n|competition_gender|competition_id|competition_international|    competition_name|competition_youth|country_name|     match_available|match_available_360|       match_updated|   match_updated_360|season_id|season_name|\n+------------------+--------------+-------------------------+--------------------+-----------------+------------+--------------------+-------------------+--------------------+--------------------+---------+-----------+\n|              male|             9|                    false|       1. Bundesliga|            false|     Germany|2023-12-12T07:43:...|               NULL|2023-12-12T07:43:...|                NULL|       27|  2015/2016|\n|              male|          1267|                     true|African Cup of Na...|            false|      Africa|2024-02-14T05:41:...|               NULL|2024-02-14T05:41:...|                NULL|      107|       2023|\n|              male|            16|                    false|    Champions League|            false|      Europe|2023-03-07T12:20:...|               NULL|2023-03-07T12:20:...|2021-06-13T16:17:...|        4|  2018/2019|\n|              male|            16|                    false|    Champions League|            false|      Europe|2021-01-23T21:55:...|               NULL|2021-08-27T11:26:...|2021-06-13T16:17:...|        1|  2017/2018|\n|              male|            16|                    false|    Champions League|            false|      Europe|    2020-07-29T05:00|               NULL|2021-08-27T11:26:...|2021-06-13T16:17:...|        2|  2016/2017|\n+------------------+--------------+-------------------------+--------------------+-----------------+------------+--------------------+-------------------+--------------------+--------------------+---------+-----------+\nonly showing top 5 rows\n\nimport org.apache.spark.sql.SparkSession\nval \u001b[1m\u001b[34mspark\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.SparkSession\u001b[0m \u003d org.apache.spark.sql.SparkSession@4bc1687e\nval \u001b[1m\u001b[34mbucketPath\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d ./data/competitions.json\nval \u001b[1m\u001b[34mfootballData\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [competition_gender: string, competition_id: bigint ... 10 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d0"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d1"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715623641284_1548579593",
      "id": "paragraph_1715344189673_1137922785",
      "dateCreated": "2024-05-13 18:07:21.284",
      "dateStarted": "2024-05-19 11:44:18.132",
      "dateFinished": "2024-05-19 11:44:37.100",
      "status": "FINISHED"
    },
    {
      "text": "%md \n\n# Load data from matches folder",
      "user": "anonymous",
      "dateUpdated": "2024-05-19 11:44:37.160",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eLoad data from matches folder\u003c/h1\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715623641284_2060679766",
      "id": "paragraph_1715345075524_753520123",
      "dateCreated": "2024-05-13 18:07:21.285",
      "dateStarted": "2024-05-19 11:44:37.183",
      "dateFinished": "2024-05-19 11:44:37.190",
      "status": "FINISHED"
    },
    {
      "text": "import org.apache.spark.sql.{DataFrame, SparkSession}\r\n\r\nval spark \u003d SparkSession.builder()\r\n  .appName(\"Football Data Analysis\")\r\n  .getOrCreate()\r\n\r\nval competitionsPath \u003d \"./data/competitions.json\"\r\nval competitionsDF \u003d spark.read.option(\"header\", \"true\").option(\"multiline\", \"true\").json(competitionsPath)",
      "user": "anonymous",
      "dateUpdated": "2024-05-19 11:44:37.282",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "import org.apache.spark.sql.{DataFrame, SparkSession}\nval \u001b[1m\u001b[34mspark\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.SparkSession\u001b[0m \u003d org.apache.spark.sql.SparkSession@4bc1687e\nval \u001b[1m\u001b[34mcompetitionsPath\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d ./data/competitions.json\nval \u001b[1m\u001b[34mcompetitionsDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [competition_gender: string, competition_id: bigint ... 10 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d2"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715623641285_1619211032",
      "id": "paragraph_1715345391324_736008798",
      "dateCreated": "2024-05-13 18:07:21.285",
      "dateStarted": "2024-05-19 11:44:37.302",
      "dateFinished": "2024-05-19 11:44:37.635",
      "status": "FINISHED"
    },
    {
      "text": "// Filter for competition_id \u003d 9\r\nval competitionInfo \u003d competitionsDF.filter($\"competition_id\" \u003d\u003d\u003d 9)\r\n\r\nval number_of_id \u003d competitionInfo.select($\"competition_id\").as[Long].first()\r\n",
      "user": "anonymous",
      "dateUpdated": "2024-05-19 11:44:37.702",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "val \u001b[1m\u001b[34mcompetitionInfo\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [competition_gender: string, competition_id: bigint ... 10 more fields]\nval \u001b[1m\u001b[34mnumber_of_id\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m \u003d 9\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d3"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715623641285_2073618028",
      "id": "paragraph_1715347127215_628166428",
      "dateCreated": "2024-05-13 18:07:21.285",
      "dateStarted": "2024-05-19 11:44:37.725",
      "dateFinished": "2024-05-19 11:44:38.393",
      "status": "FINISHED"
    },
    {
      "text": "// Assuming matches are stored in a structured way in folders by competition_id\r\nspark.conf.set(\"spark.sql.files.ignoreCorruptFiles\", \"true\") // Ignore corrupt files\r\nspark.conf.set(\"spark.sql.json.recursiveFileLookup\", \"true\") // Enable recursive file lookup\r\n\r\nval matchesPath \u003d \"./data/matches/\" + number_of_id + \"/\"\r\n\r\nprintln(matchesPath)\r\n\r\nval matchesDF \u003d spark.read.option(\"multiline\", \"true\").json(matchesPath)\r\n\r\nmatchesDF\r\n",
      "user": "anonymous",
      "dateUpdated": "2024-05-19 11:44:38.425",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "./data/matches/9/\nval \u001b[1m\u001b[34mmatchesPath\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d ./data/matches/9/\nval \u001b[1m\u001b[34mmatchesDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [away_score: bigint, away_team: struct\u003caway_team_gender: string, away_team_group: string ... 4 more fields\u003e ... 16 more fields]\nval \u001b[1m\u001b[34mres2\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [away_score: bigint, away_team: struct\u003caway_team_gender: string, away_team_group: string ... 4 more fields\u003e ... 16 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d4"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715623641285_532308875",
      "id": "paragraph_1715345972412_1710035536",
      "dateCreated": "2024-05-13 18:07:21.285",
      "dateStarted": "2024-05-19 11:44:38.451",
      "dateFinished": "2024-05-19 11:44:38.892",
      "status": "FINISHED"
    },
    {
      "text": "val rowCount \u003d matchesDF.count()\r\nprintln(s\"Number of rows in matchesDF: $rowCount\")",
      "user": "anonymous",
      "dateUpdated": "2024-05-19 11:44:38.951",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Number of rows in matchesDF: 306\nval \u001b[1m\u001b[34mrowCount\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m \u003d 306\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d5"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d6"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715623641285_1885444178",
      "id": "paragraph_1715345841786_730555164",
      "dateCreated": "2024-05-13 18:07:21.285",
      "dateStarted": "2024-05-19 11:44:38.978",
      "dateFinished": "2024-05-19 11:44:39.806",
      "status": "FINISHED"
    },
    {
      "text": "spark.conf.set(\"spark.sql.files.ignoreCorruptFiles\", \"true\") \r\nspark.conf.set(\"spark.sql.json.recursiveFileLookup\", \"true\")\r\n\r\nval matchesPath \u003d \"./data/matches/\"+ number_of_id + \"/\"\r\n\r\nval matchesDF \u003d spark.read.option(\"multiline\", \"true\").json(matchesPath)\r\n\r\nval matchesWithFiles \u003d matchesDF.withColumn(\"file_path\", input_file_name())\r\n\r\nval distinctFiles \u003d matchesWithFiles.select(\"file_path\").distinct()\r\n\r\ndistinctFiles.show(false)\r\n",
      "user": "anonymous",
      "dateUpdated": "2024-05-19 11:44:39.879",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-------------------------------------------+\n|file_path                                  |\n+-------------------------------------------+\n|file:///opt/zeppelin/data/matches/9/27.json|\n+-------------------------------------------+\n\nval \u001b[1m\u001b[34mmatchesPath\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d ./data/matches/9/\nval \u001b[1m\u001b[34mmatchesDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [away_score: bigint, away_team: struct\u003caway_team_gender: string, away_team_group: string ... 4 more fields\u003e ... 16 more fields]\nval \u001b[1m\u001b[34mmatchesWithFiles\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [away_score: bigint, away_team: struct\u003caway_team_gender: string, away_team_group: string ... 4 more fields\u003e ... 17 more fields]\nval \u001b[1m\u001b[34mdistinctFiles\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [file_path: string]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d7"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d8"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d9"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715623641285_1992194586",
      "id": "paragraph_1715346367177_1474962718",
      "dateCreated": "2024-05-13 18:07:21.285",
      "dateStarted": "2024-05-19 11:44:39.900",
      "dateFinished": "2024-05-19 11:44:41.172",
      "status": "FINISHED"
    },
    {
      "text": "val df_matches_all \u003d spark.read.option(\"multiline\", \"true\").json(\"./data/matches/*/*\")\n\nval rowCount \u003d df_matches_all.count()\nprintln(s\"Number of rows in matchesDF: $rowCount\")",
      "user": "anonymous",
      "dateUpdated": "2024-05-19 11:44:41.201",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Number of rows in matchesDF: 3316\nval \u001b[1m\u001b[34mdf_matches_all\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [away_score: bigint, away_team: struct\u003caway_team_gender: string, away_team_group: string ... 4 more fields\u003e ... 16 more fields]\nval \u001b[1m\u001b[34mrowCount\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m \u003d 3316\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d10"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d11"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d12"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d13"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715623641285_342299421",
      "id": "paragraph_1715346232209_63657840",
      "dateCreated": "2024-05-13 18:07:21.285",
      "dateStarted": "2024-05-19 11:44:41.224",
      "dateFinished": "2024-05-19 11:44:48.595",
      "status": "FINISHED"
    },
    {
      "text": "\r\ndf_matches_all.show()",
      "user": "anonymous",
      "dateUpdated": "2024-05-19 11:44:48.634",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----------+--------------------+--------------------+-------------------+----------+--------------------+------------+--------------------+----------------+----------+--------+------------+----------------+----------+-------------+--------------------+---------------+--------------------+\n|away_score|           away_team|         competition|  competition_stage|home_score|           home_team|    kick_off|        last_updated|last_updated_360|match_date|match_id|match_status|match_status_360|match_week|     metadata|             referee|         season|             stadium|\n+----------+--------------------+--------------------+-------------------+----------+--------------------+------------+--------------------+----------------+----------+--------+------------+----------------+----------+-------------+--------------------+---------------+--------------------+\n|         2|{male, NULL, 322,...|{11, La Liga, Spain}|{1, Regular Season}|         2|{{214, Spain}, ma...|20:00:00.000|2023-02-21T15:19:...|            NULL|2015-09-23| 3825848|   available|     unscheduled|         5|{1.1.0, 2, 2}|                NULL|{27, 2015/2016}|{{214, Spain}, 35...|\n|         0|{male, NULL, 213,...|{11, La Liga, Spain}|{1, Regular Season}|         2|{{214, Spain}, ma...|22:00:00.000|2023-02-21T15:19:...|            NULL|2015-09-23| 3825895|   available|     unscheduled|         5|{1.1.0, 2, 2}|{{214, Spain}, 27...|{27, 2015/2016}|{{214, Spain}, 35...|\n|         2|{male, NULL, 216,...|{11, La Liga, Spain}|{1, Regular Season}|         0|{{214, Spain}, ma...|18:15:00.000|2022-08-30T12:53:...|            NULL|2016-05-01| 3825894|   available|     unscheduled|        36|{1.1.0, 2, 2}|{{214, Spain}, 10...|{27, 2015/2016}|{{214, Spain}, 46...|\n|         1|{male, NULL, 221,...|{11, La Liga, Spain}|{1, Regular Season}|         3|{{214, Spain}, ma...|20:30:00.000|2022-08-30T12:53:...|            NULL|2016-05-02| 3825855|   available|     unscheduled|        36|{1.1.0, 2, 2}|{{214, Spain}, 24...|{27, 2015/2016}|{{214, Spain}, 34...|\n|         2|{male, NULL, 322,...|{11, La Liga, Spain}|{1, Regular Season}|         4|{{214, Spain}, ma...|19:00:00.000|2022-04-06T22:39:...|            NULL|2016-05-15| 3825908|   available|     unscheduled|        38|{1.1.0, 2, 2}|{{214, Spain}, 26...|{27, 2015/2016}|{{214, Spain}, 35...|\n|         1|{male, NULL, 208,...|{11, La Liga, Spain}|{1, Regular Season}|         4|{{214, Spain}, ma...|12:00:00.000|2022-08-30T13:15:...|            NULL|2016-05-15| 3825883|   available|     unscheduled|        38|{1.1.0, 2, 2}|{{214, Spain}, 26...|{27, 2015/2016}|{{214, Spain}, 34...|\n|         0|{male, NULL, 222,...|{11, La Liga, Spain}|{1, Regular Season}|         2|{{214, Spain}, ma...|19:30:00.000|2022-04-06T22:37:...|            NULL|2016-05-15| 3825900|   available|     unscheduled|        38|{1.1.0, 2, 2}|{{214, Spain}, 22...|{27, 2015/2016}|{{214, Spain}, 46...|\n|         1|{male, NULL, 221,...|{11, La Liga, Spain}|{1, Regular Season}|         3|{{214, Spain}, ma...|19:30:00.000|2022-04-06T22:35:...|            NULL|2016-05-15| 3825902|   available|     unscheduled|        38|{1.1.0, 2, 2}|{{214, Spain}, 10...|{27, 2015/2016}|{{214, Spain}, 46...|\n|         1|{male, NULL, 216,...|{11, La Liga, Spain}|{1, Regular Season}|         2|{{214, Spain}, ma...|19:30:00.000|2022-04-06T22:34:...|            NULL|2016-05-15| 3825876|   available|     unscheduled|        38|{1.1.0, 2, 2}|{{214, Spain}, 18...|{27, 2015/2016}|{{214, Spain}, 35...|\n|         2|{male, NULL, 220,...|{11, La Liga, Spain}|{1, Regular Season}|         0|{{214, Spain}, ma...|17:00:00.000|2022-04-06T22:33:...|            NULL|2016-05-14| 3825846|   available|     unscheduled|        38|{1.1.0, 2, 2}|{{214, Spain}, 18...|{27, 2015/2016}|{{214, Spain}, 46...|\n|         1|{male, NULL, 213,...|{11, La Liga, Spain}|{1, Regular Season}|         3|{{214, Spain}, ma...|19:30:00.000|2022-08-30T13:07:...|            NULL|2016-05-14| 3825869|   available|     unscheduled|        38|{1.1.0, 2, 2}|{{214, Spain}, 21...|{27, 2015/2016}|{{214, Spain}, 34...|\n|         0|{male, NULL, 209,...|{11, La Liga, Spain}|{1, Regular Season}|         2|{{214, Spain}, ma...|19:30:00.000|2022-04-06T22:30:...|            NULL|2016-05-14| 3825882|   available|     unscheduled|        38|{1.1.0, 2, 2}|{{214, Spain}, 22...|{27, 2015/2016}|{{214, Spain}, 62...|\n|         1|{male, NULL, 210,...|{11, La Liga, Spain}|{1, Regular Season}|         0|{{214, Spain}, ma...|20:30:00.000|2022-04-06T22:29:...|            NULL|2016-05-13| 3825849|   available|     unscheduled|        38|{1.1.0, 2, 2}|{{214, Spain}, 25...|{27, 2015/2016}|{{214, Spain}, 34...|\n|         1|{male, NULL, 212,...|{11, La Liga, Spain}|{1, Regular Season}|         2|{{214, Spain}, ma...|17:00:00.000|2022-04-06T22:28:...|            NULL|2016-05-08| 3825860|   available|     unscheduled|        37|{1.1.0, 2, 2}|{{214, Spain}, 21...|{27, 2015/2016}|{{214, Spain}, 35...|\n|         1|{male, NULL, 219,...|{11, La Liga, Spain}|{1, Regular Season}|         1|{{214, Spain}, ma...|22:05:00.000|2022-03-26T14:52:...|            NULL|2016-04-23| 3825847|   available|     unscheduled|        35|{1.1.0, 2, 2}|{{214, Spain}, 24...|{27, 2015/2016}|{{214, Spain}, 34...|\n|         1|{male, NULL, 322,...|{11, La Liga, Spain}|{1, Regular Season}|         1|{{214, Spain}, ma...|21:30:00.000|2022-05-08T21:31:...|            NULL|2016-03-18| 3825817|   available|     unscheduled|        30|{1.1.0, 2, 2}|{{214, Spain}, 21...|{27, 2015/2016}|{{214, Spain}, 35...|\n|         1|{male, NULL, 1041...|{11, La Liga, Spain}|{1, Regular Season}|         1|{{214, Spain}, ma...|21:30:00.000|2022-03-26T14:39:...|            NULL|2016-02-20| 3825778|   available|     unscheduled|        25|{1.1.0, 2, 2}|{{214, Spain}, 21...|{27, 2015/2016}|{{214, Spain}, 35...|\n|         0|{male, NULL, 216,...|{11, La Liga, Spain}|{1, Regular Season}|         3|{{214, Spain}, ma...|21:30:00.000|2022-05-08T21:01:...|            NULL|2016-02-19| 3825777|   available|     unscheduled|        25|{1.1.0, 2, 2}|{{214, Spain}, 21...|{27, 2015/2016}|{{214, Spain}, 35...|\n|         1|{male, NULL, 1049...|{11, La Liga, Spain}|{1, Regular Season}|         5|{{214, Spain}, ma...|21:30:00.000|2022-03-26T14:32:...|            NULL|2016-01-18| 3825740|   available|     unscheduled|        20|{1.1.0, 2, 2}|{{214, Spain}, 26...|{27, 2015/2016}|{{214, Spain}, 34...|\n|         0|{male, NULL, 210,...|{11, La Liga, Spain}|{1, Regular Season}|         0|{{214, Spain}, ma...|20:30:00.000|2022-03-22T17:53:...|            NULL|2016-04-24| 3825875|   available|     unscheduled|        35|{1.1.0, 2, 2}|{{214, Spain}, 22...|{27, 2015/2016}|{{214, Spain}, 36...|\n+----------+--------------------+--------------------+-------------------+----------+--------------------+------------+--------------------+----------------+----------+--------+------------+----------------+----------+-------------+--------------------+---------------+--------------------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d14"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715623641286_1871405505",
      "id": "paragraph_1715347440649_2116474166",
      "dateCreated": "2024-05-13 18:07:21.286",
      "dateStarted": "2024-05-19 11:44:48.654",
      "dateFinished": "2024-05-19 11:44:49.232",
      "status": "FINISHED"
    },
    {
      "text": "val targetMatchId \u003d 3890561\r\n\r\nval df_specificMatch \u003d df_matches_all.filter($\"match_id\" \u003d\u003d\u003d targetMatchId)\r\n\r\ndf_specificMatch.show()\r\n",
      "user": "anonymous",
      "dateUpdated": "2024-05-19 11:44:49.254",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----------+--------------------+--------------------+-------------------+----------+--------------------+------------+--------------------+----------------+----------+--------+------------+----------------+----------+-------------+--------------------+---------------+--------------------+\n|away_score|           away_team|         competition|  competition_stage|home_score|           home_team|    kick_off|        last_updated|last_updated_360|match_date|match_id|match_status|match_status_360|match_week|     metadata|             referee|         season|             stadium|\n+----------+--------------------+--------------------+-------------------+----------+--------------------+------------+--------------------+----------------+----------+--------+------------+----------------+----------+-------------+--------------------+---------------+--------------------+\n|         4|{male, NULL, 181,...|{9, 1. Bundesliga...|{1, Regular Season}|         1|{{85, Germany}, m...|15:30:00.000|2023-07-24T07:47:...|            NULL|2016-05-14| 3890561|   available|     unscheduled|        34|{1.1.0, 2, 2}|{{85, Germany}, 1...|{27, 2015/2016}|{{85, Germany}, 4...|\n+----------+--------------------+--------------------+-------------------+----------+--------------------+------------+--------------------+----------------+----------+--------+------------+----------------+----------+-------------+--------------------+---------------+--------------------+\n\nval \u001b[1m\u001b[34mtargetMatchId\u001b[0m: \u001b[1m\u001b[32mInt\u001b[0m \u003d 3890561\nval \u001b[1m\u001b[34mdf_specificMatch\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [away_score: bigint, away_team: struct\u003caway_team_gender: string, away_team_group: string ... 4 more fields\u003e ... 16 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d15"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d16"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d17"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715623641286_1549802920",
      "id": "paragraph_1715530916237_160733383",
      "dateCreated": "2024-05-13 18:07:21.286",
      "dateStarted": "2024-05-19 11:44:49.277",
      "dateFinished": "2024-05-19 11:44:50.566",
      "status": "FINISHED"
    },
    {
      "text": "val matchId \u003d 3890561\r\nval filePath \u003d s\"./data/events/$matchId.json\"\r\n\r\nval df_events \u003d spark.read.option(\"multiline\", \"true\").json(filePath)\r\ndf_events.show()",
      "user": "anonymous",
      "dateUpdated": "2024-05-19 11:44:50.579",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------------+-------------+-----+--------------+---------+------------+-------+----+--------+--------------+--------+----------+--------------------+-----+------------+------------+------+----------+----+--------------------+------+------------------+--------------------+--------------------+----------+-----------------+--------------------+------+----+------------+--------------------+-----------------+------------+-------------------+--------------+\n|ball_receipt|ball_recovery|block|         carry|clearance|counterpress|dribble|duel|duration|foul_committed|foul_won|goalkeeper|                  id|index|interception|    location|minute|off_camera| out|                pass|period|      play_pattern|              player|            position|possession|  possession_team|      related_events|second|shot|substitution|             tactics|             team|   timestamp|               type|under_pressure|\n+------------+-------------+-----+--------------+---------+------------+-------+----+--------+--------------+--------+----------+--------------------+-----+------------+------------+------+----------+----+--------------------+------+------------------+--------------------+--------------------+----------+-----------------+--------------------+------+----+------------+--------------------+-----------------+------------+-------------------+--------------+\n|        NULL|         NULL| NULL|          NULL|     NULL|        NULL|   NULL|NULL|     0.0|          NULL|    NULL|      NULL|41bd60ac-9b2c-4cb...|    1|        NULL|        NULL|     0|      NULL|NULL|                NULL|     1| {1, Regular Play}|                NULL|                NULL|         1|{175, Hoffenheim}|                NULL|     0|NULL|        NULL|{3421, [{13, {379...|{175, Hoffenheim}|00:00:00.000|  {35, Starting XI}|          NULL|\n|        NULL|         NULL| NULL|          NULL|     NULL|        NULL|   NULL|NULL|     0.0|          NULL|    NULL|      NULL|fbca533d-f3f4-4a8...|    2|        NULL|        NULL|     0|      NULL|NULL|                NULL|     1| {1, Regular Play}|                NULL|                NULL|         1|{175, Hoffenheim}|                NULL|     0|NULL|        NULL|{4141, [{1, {8517...|{181, Schalke 04}|00:00:00.000|  {35, Starting XI}|          NULL|\n|        NULL|         NULL| NULL|          NULL|     NULL|        NULL|   NULL|NULL|     0.0|          NULL|    NULL|      NULL|b15ba6b1-61ac-4d9...|    3|        NULL|        NULL|     0|      NULL|NULL|                NULL|     1| {1, Regular Play}|                NULL|                NULL|         1|{175, Hoffenheim}|[442128f8-2e38-49...|     0|NULL|        NULL|                NULL|{175, Hoffenheim}|00:00:00.000|   {18, Half Start}|          NULL|\n|        NULL|         NULL| NULL|          NULL|     NULL|        NULL|   NULL|NULL|     0.0|          NULL|    NULL|      NULL|442128f8-2e38-491...|    4|        NULL|        NULL|     0|      NULL|NULL|                NULL|     1| {1, Regular Play}|                NULL|                NULL|         1|{175, Hoffenheim}|[b15ba6b1-61ac-4d...|     0|NULL|        NULL|                NULL|{181, Schalke 04}|00:00:00.000|   {18, Half Start}|          NULL|\n|        NULL|         NULL| NULL|          NULL|     NULL|        NULL|   NULL|NULL|0.453238|          NULL|    NULL|      NULL|644e16d7-10ca-45f...|    5|        NULL|[61.0, 40.1]|     0|      NULL|NULL|{NULL, -1.9195673...|     1|{9, From Kick Off}|    {8387, Mark Uth}|{18, Right Attack...|         2|{175, Hoffenheim}|[7602c8d9-d988-4e...|     0|NULL|        NULL|                NULL|{175, Hoffenheim}|00:00:00.482|         {30, Pass}|          NULL|\n|        NULL|         NULL| NULL|          NULL|     NULL|        NULL|   NULL|NULL|    NULL|          NULL|    NULL|      NULL|7602c8d9-d988-4ea...|    6|        NULL|[60.2, 37.9]|     0|      NULL|NULL|                NULL|     1|{9, From Kick Off}|{5460, Andrej Kra...|{23, Center Forward}|         2|{175, Hoffenheim}|[644e16d7-10ca-45...|     0|NULL|        NULL|                NULL|{175, Hoffenheim}|00:00:00.935|{42, Ball Receipt*}|          NULL|\n|        NULL|         NULL| NULL|{[59.4, 38.3]}|     NULL|        NULL|   NULL|NULL|    0.08|          NULL|    NULL|      NULL|329a1879-2521-461...|    7|        NULL|[60.2, 37.9]|     0|      NULL|NULL|                NULL|     1|{9, From Kick Off}|{5460, Andrej Kra...|{23, Center Forward}|         2|{175, Hoffenheim}|[7602c8d9-d988-4e...|     0|NULL|        NULL|                NULL|{175, Hoffenheim}|00:00:00.935|        {43, Carry}|          NULL|\n|        NULL|         NULL| NULL|          NULL|     NULL|        NULL|   NULL|NULL|1.151865|          NULL|    NULL|      NULL|77e2ddaf-6de3-49e...|    8|        NULL|[59.4, 38.3]|     0|      NULL|NULL|{NULL, 2.536994, ...|     1|{9, From Kick Off}|{5460, Andrej Kra...|{23, Center Forward}|         2|{175, Hoffenheim}|[69e3b0a7-5847-40...|     1|NULL|        NULL|                NULL|{175, Hoffenheim}|00:00:01.015|         {30, Pass}|          NULL|\n|        NULL|         NULL| NULL|          NULL|     NULL|        NULL|   NULL|NULL|    NULL|          NULL|    NULL|      NULL|69e3b0a7-5847-40d...|    9|        NULL|[53.9, 42.1]|     0|      NULL|NULL|                NULL|     1|{9, From Kick Off}|{6039, Sebastian ...|{11, Left Defensi...|         2|{175, Hoffenheim}|[77e2ddaf-6de3-49...|     2|NULL|        NULL|                NULL|{175, Hoffenheim}|00:00:02.167|{42, Ball Receipt*}|          NULL|\n|        NULL|         NULL| NULL|{[52.3, 45.2]}|     NULL|        NULL|   NULL|NULL|0.787612|          NULL|    NULL|      NULL|1b91a029-f722-4b0...|   10|        NULL|[53.9, 42.1]|     0|      NULL|NULL|                NULL|     1|{9, From Kick Off}|{6039, Sebastian ...|{11, Left Defensi...|         2|{175, Hoffenheim}|[2c51f271-c812-45...|     2|NULL|        NULL|                NULL|{175, Hoffenheim}|00:00:02.167|        {43, Carry}|          NULL|\n|        NULL|         NULL| NULL|          NULL|     NULL|        NULL|   NULL|NULL|1.389406|          NULL|    NULL|      NULL|2c51f271-c812-45a...|   11|        NULL|[52.3, 45.2]|     0|      NULL|NULL|{NULL, 2.3906636,...|     1|{9, From Kick Off}|{6039, Sebastian ...|{11, Left Defensi...|         2|{175, Hoffenheim}|[c30d7035-bb00-40...|     2|NULL|        NULL|                NULL|{175, Hoffenheim}|00:00:02.954|         {30, Pass}|          NULL|\n|        NULL|         NULL| NULL|          NULL|     NULL|        NULL|   NULL|NULL|    NULL|          NULL|    NULL|      NULL|c30d7035-bb00-401...|   12|        NULL|[34.3, 62.0]|     0|      NULL|NULL|                NULL|     1|{9, From Kick Off}|{5537, Fabian Luk...|{3, Right Center ...|         2|{175, Hoffenheim}|[2c51f271-c812-45...|     4|NULL|        NULL|                NULL|{175, Hoffenheim}|00:00:04.344|{42, Ball Receipt*}|          NULL|\n|        NULL|         NULL| NULL|{[34.3, 61.9]}|     NULL|        NULL|   NULL|NULL|1.549877|          NULL|    NULL|      NULL|4e93eb34-ac12-4a2...|   13|        NULL|[34.3, 62.0]|     0|      NULL|NULL|                NULL|     1|{9, From Kick Off}|{5537, Fabian Luk...|{3, Right Center ...|         2|{175, Hoffenheim}|[8b29246d-1d69-4f...|     4|NULL|        NULL|                NULL|{175, Hoffenheim}|00:00:04.344|        {43, Carry}|          NULL|\n|        NULL|         NULL| NULL|          NULL|     NULL|        NULL|   NULL|NULL|2.557696|          NULL|    NULL|      NULL|8b29246d-1d69-4f0...|   14|        NULL|[34.3, 61.9]|     0|      NULL|NULL|{NULL, -1.4872218...|     1|{9, From Kick Off}|{5537, Fabian Luk...|{3, Right Center ...|         2|{175, Hoffenheim}|[9b73ba37-f40c-4a...|     5|NULL|        NULL|                NULL|{175, Hoffenheim}|00:00:05.894|         {30, Pass}|          NULL|\n|        NULL|         NULL| NULL|          NULL|     NULL|        NULL|   NULL|NULL|    NULL|          NULL|    NULL|      NULL|9b73ba37-f40c-4ad...|   15|        NULL|[37.5, 23.7]|     0|      NULL|NULL|                NULL|     1|{9, From Kick Off}|{12321, Tobias St...|{5, Left Center B...|         2|{175, Hoffenheim}|[8b29246d-1d69-4f...|     8|NULL|        NULL|                NULL|{175, Hoffenheim}|00:00:08.451|{42, Ball Receipt*}|          NULL|\n|        NULL|         NULL| NULL|{[38.5, 22.2]}|     NULL|        NULL|   NULL|NULL|2.200544|          NULL|    NULL|      NULL|0d3f0101-1b31-46f...|   16|        NULL|[37.5, 23.7]|     0|      NULL|NULL|                NULL|     1|{9, From Kick Off}|{12321, Tobias St...|{5, Left Center B...|         2|{175, Hoffenheim}|[9b73ba37-f40c-4a...|     8|NULL|        NULL|                NULL|{175, Hoffenheim}|00:00:08.451|        {43, Carry}|          NULL|\n|        NULL|         NULL| NULL|          NULL|     NULL|        NULL|   NULL|NULL|1.417774|          NULL|    NULL|      NULL|ed35929b-31b4-42b...|   17|        NULL|[38.5, 22.2]|     0|      NULL|NULL|{NULL, 1.7053174,...|     1|{9, From Kick Off}|{12321, Tobias St...|{5, Left Center B...|         2|{175, Hoffenheim}|[0ab25e43-7b9d-40...|    10|NULL|        NULL|                NULL|{175, Hoffenheim}|00:00:10.652|         {30, Pass}|          NULL|\n|        NULL|         NULL| NULL|          NULL|     NULL|        NULL|   NULL|NULL|    NULL|          NULL|    NULL|      NULL|0ab25e43-7b9d-402...|   18|        NULL|[36.7, 35.5]|     0|      NULL|NULL|                NULL|     1|{9, From Kick Off}|{9396, Ermin Biča...|    {4, Center Back}|         2|{175, Hoffenheim}|[ed35929b-31b4-42...|    12|NULL|        NULL|                NULL|{175, Hoffenheim}|00:00:12.070|{42, Ball Receipt*}|          NULL|\n|        NULL|         NULL| NULL|{[39.6, 32.7]}|     NULL|        NULL|   NULL|NULL| 2.32185|          NULL|    NULL|      NULL|87748ce9-72e9-488...|   19|        NULL|[36.7, 35.5]|     0|      NULL|NULL|                NULL|     1|{9, From Kick Off}|{9396, Ermin Biča...|    {4, Center Back}|         2|{175, Hoffenheim}|[0ab25e43-7b9d-40...|    12|NULL|        NULL|                NULL|{175, Hoffenheim}|00:00:12.070|        {43, Carry}|          NULL|\n|        NULL|         NULL| NULL|          NULL|     NULL|        NULL|   NULL|NULL|1.778888|          NULL|    NULL|      NULL|50c65a61-8f10-4c4...|   20|        NULL|[39.6, 32.7]|     0|      NULL|NULL|{NULL, -1.1973677...|     1|{9, From Kick Off}|{9396, Ermin Biča...|    {4, Center Back}|         2|{175, Hoffenheim}|[4c2177fb-6bcd-4a...|    14|NULL|        NULL|                NULL|{175, Hoffenheim}|00:00:14.391|         {30, Pass}|          NULL|\n+------------+-------------+-----+--------------+---------+------------+-------+----+--------+--------------+--------+----------+--------------------+-----+------------+------------+------+----------+----+--------------------+------+------------------+--------------------+--------------------+----------+-----------------+--------------------+------+----+------------+--------------------+-----------------+------------+-------------------+--------------+\nonly showing top 20 rows\n\nval \u001b[1m\u001b[34mmatchId\u001b[0m: \u001b[1m\u001b[32mInt\u001b[0m \u003d 3890561\nval \u001b[1m\u001b[34mfilePath\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d ./data/events/3890561.json\nval \u001b[1m\u001b[34mdf_events\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [ball_receipt: struct\u003coutcome: struct\u003cid: bigint, name: string\u003e\u003e, ball_recovery: struct\u003crecovery_failure: boolean\u003e ... 33 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d18"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d19"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715623641286_2116977257",
      "id": "paragraph_1715532323634_49851259",
      "dateCreated": "2024-05-13 18:07:21.286",
      "dateStarted": "2024-05-19 11:44:50.612",
      "dateFinished": "2024-05-19 11:44:51.562",
      "status": "FINISHED"
    },
    {
      "text": "%md\n\n# Read one event (match id) and plot the number of passes of each team during the hole game",
      "user": "anonymous",
      "dateUpdated": "2024-05-19 11:44:51.613",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eRead one event (match id) and plot the number of passes of each team during the hole game\u003c/h1\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715623641287_1500607021",
      "id": "paragraph_1715532870282_763289410",
      "dateCreated": "2024-05-13 18:07:21.287",
      "dateStarted": "2024-05-19 11:44:51.632",
      "dateFinished": "2024-05-19 11:44:51.639",
      "status": "FINISHED"
    },
    {
      "text": "val matchId \u003d 3890561  \r\nval filePath \u003d s\"./data/events/$matchId.json\"\r\n\r\nval df_events \u003d spark.read.option(\"multiline\", \"true\").json(filePath)\r\nval df_tmp \u003d df_events.select(\"index\", \"timestamp\", \"type\", \"possession_team\")\r\n",
      "user": "anonymous",
      "dateUpdated": "2024-05-19 11:44:51.732",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "val \u001b[1m\u001b[34mmatchId\u001b[0m: \u001b[1m\u001b[32mInt\u001b[0m \u003d 3890561\nval \u001b[1m\u001b[34mfilePath\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d ./data/events/3890561.json\nval \u001b[1m\u001b[34mdf_events\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [ball_receipt: struct\u003coutcome: struct\u003cid: bigint, name: string\u003e\u003e, ball_recovery: struct\u003crecovery_failure: boolean\u003e ... 33 more fields]\nval \u001b[1m\u001b[34mdf_tmp\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [index: bigint, timestamp: string ... 2 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d20"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715623641287_403211358",
      "id": "paragraph_1715532045932_1825741487",
      "dateCreated": "2024-05-13 18:07:21.287",
      "dateStarted": "2024-05-19 11:44:51.752",
      "dateFinished": "2024-05-19 11:44:52.124",
      "status": "FINISHED"
    },
    {
      "text": "df_tmp.show()",
      "user": "anonymous",
      "dateUpdated": "2024-05-19 11:44:52.152",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+------------+-------------------+-----------------+\n|index|   timestamp|               type|  possession_team|\n+-----+------------+-------------------+-----------------+\n|    1|00:00:00.000|  {35, Starting XI}|{175, Hoffenheim}|\n|    2|00:00:00.000|  {35, Starting XI}|{175, Hoffenheim}|\n|    3|00:00:00.000|   {18, Half Start}|{175, Hoffenheim}|\n|    4|00:00:00.000|   {18, Half Start}|{175, Hoffenheim}|\n|    5|00:00:00.482|         {30, Pass}|{175, Hoffenheim}|\n|    6|00:00:00.935|{42, Ball Receipt*}|{175, Hoffenheim}|\n|    7|00:00:00.935|        {43, Carry}|{175, Hoffenheim}|\n|    8|00:00:01.015|         {30, Pass}|{175, Hoffenheim}|\n|    9|00:00:02.167|{42, Ball Receipt*}|{175, Hoffenheim}|\n|   10|00:00:02.167|        {43, Carry}|{175, Hoffenheim}|\n|   11|00:00:02.954|         {30, Pass}|{175, Hoffenheim}|\n|   12|00:00:04.344|{42, Ball Receipt*}|{175, Hoffenheim}|\n|   13|00:00:04.344|        {43, Carry}|{175, Hoffenheim}|\n|   14|00:00:05.894|         {30, Pass}|{175, Hoffenheim}|\n|   15|00:00:08.451|{42, Ball Receipt*}|{175, Hoffenheim}|\n|   16|00:00:08.451|        {43, Carry}|{175, Hoffenheim}|\n|   17|00:00:10.652|         {30, Pass}|{175, Hoffenheim}|\n|   18|00:00:12.070|{42, Ball Receipt*}|{175, Hoffenheim}|\n|   19|00:00:12.070|        {43, Carry}|{175, Hoffenheim}|\n|   20|00:00:14.391|         {30, Pass}|{175, Hoffenheim}|\n+-----+------------+-------------------+-----------------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d21"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715623641287_1613843704",
      "id": "paragraph_1715533014607_426786810",
      "dateCreated": "2024-05-13 18:07:21.287",
      "dateStarted": "2024-05-19 11:44:52.175",
      "dateFinished": "2024-05-19 11:44:52.534",
      "status": "FINISHED"
    },
    {
      "text": "import org.apache.spark.sql.functions._\r\n\r\nval passEvents \u003d df_events.filter(col(\"type.name\").contains(\"Pass\"))\r\nval passCountByTeam \u003d passEvents.groupBy(\"possession_team\")\r\n  .count()\r\n  .withColumnRenamed(\"count\", \"pass_count\")\r\n\r\nval teamWithMostPasses \u003d passCountByTeam.orderBy(desc(\"pass_count\"))\r\nteamWithMostPasses.show()\r\n",
      "user": "anonymous",
      "dateUpdated": "2024-05-19 11:44:52.576",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----------------+----------+\n|  possession_team|pass_count|\n+-----------------+----------+\n|{181, Schalke 04}|       611|\n|{175, Hoffenheim}|       485|\n+-----------------+----------+\n\nimport org.apache.spark.sql.functions._\nval \u001b[1m\u001b[34mpassEvents\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [ball_receipt: struct\u003coutcome: struct\u003cid: bigint, name: string\u003e\u003e, ball_recovery: struct\u003crecovery_failure: boolean\u003e ... 33 more fields]\nval \u001b[1m\u001b[34mpassCountByTeam\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [possession_team: struct\u003cid: bigint, name: string\u003e, pass_count: bigint]\nval \u001b[1m\u001b[34mteamWithMostPasses\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [possession_team: struct\u003cid: bigint, name: string\u003e, pass_count: bigint]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d22"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d23"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715623641287_784438050",
      "id": "paragraph_1715532943798_879864538",
      "dateCreated": "2024-05-13 18:07:21.287",
      "dateStarted": "2024-05-19 11:44:52.597",
      "dateFinished": "2024-05-19 11:44:53.407",
      "status": "FINISHED"
    },
    {
      "text": "%spark\nz.show(teamWithMostPasses)",
      "user": "anonymous",
      "dateUpdated": "2024-05-19 11:44:53.498",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {
          "0": {
            "graph": {
              "mode": "pieChart",
              "height": 300.0,
              "optionOpen": false,
              "setting": {
                "table": {
                  "tableGridState": {},
                  "tableColumnTypeState": {
                    "names": {
                      "possession_team": "string",
                      "pass_count": "string"
                    },
                    "updated": false
                  },
                  "tableOptionSpecHash": "[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]",
                  "tableOptionValue": {
                    "useFilter": false,
                    "showPagination": false,
                    "showAggregationFooter": false
                  },
                  "updated": false,
                  "initialized": false
                },
                "lineChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                },
                "stackedAreaChart": {
                  "rotate": {
                    "degree": "-45"
                  },
                  "xLabelStatus": "default"
                }
              },
              "commonSetting": {},
              "keys": [
                {
                  "name": "possession_team",
                  "index": 0.0,
                  "aggr": "sum"
                }
              ],
              "groups": [],
              "values": [
                {
                  "name": "pass_count",
                  "index": 1.0,
                  "aggr": "sum"
                }
              ]
            },
            "helium": {}
          }
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TABLE",
            "data": "possession_team\tpass_count\n[181,Schalke 04]\t611\n[175,Hoffenheim]\t485\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d24"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d25"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715623641287_1661781458",
      "id": "paragraph_1715529305848_1426575372",
      "dateCreated": "2024-05-13 18:07:21.287",
      "dateStarted": "2024-05-19 11:44:53.517",
      "dateFinished": "2024-05-19 11:44:53.914",
      "status": "FINISHED"
    },
    {
      "text": "%md\n\n# Number of total objects in our json files\n",
      "user": "anonymous",
      "dateUpdated": "2024-05-19 11:44:53.917",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eNumber of total objects in our json files\u003c/h1\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715624700489_93534945",
      "id": "paragraph_1715624700489_93534945",
      "dateCreated": "2024-05-13 18:25:00.489",
      "dateStarted": "2024-05-19 11:44:53.953",
      "dateFinished": "2024-05-19 11:44:53.960",
      "status": "FINISHED"
    },
    {
      "text": "/**import org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\n\nval directoryPath \u003d \"./data/*\"\n\nval df \u003d spark.read.option(\"multiline\", \"true\").json(directoryPath)\nval fileCount \u003d df.inputFiles.length\nval avgObjectsPerFile \u003d df.count().toDouble / fileCount.toDouble\n\nprintln(s\"Total number of files: $fileCount\")\nprintln(s\"Average number of JSON objects per file: $avgObjectsPerFile\")*/",
      "user": "anonymous",
      "dateUpdated": "2024-05-19 11:44:54.053",
      "progress": 99,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "INCOMPLETE",
        "msg": [
          {
            "type": "TEXT",
            "data": "Incomplete expression"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715623641287_812904975",
      "id": "paragraph_1715533404905_219182043",
      "dateCreated": "2024-05-13 18:07:21.287",
      "dateStarted": "2024-05-19 11:44:54.074",
      "dateFinished": "2024-05-19 11:44:54.081",
      "status": "FINISHED"
    },
    {
      "text": "%md \n\n# Total number of competitions \n\n--\u003e Count the number of competitions in whole dataset\n--\u003e Show the number for parameters per object in the competetions.json",
      "user": "anonymous",
      "dateUpdated": "2024-05-19 11:44:54.174",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eTotal number of competitions\u003c/h1\u003e\n\u003cp\u003e\u0026ndash;\u0026gt; Count the number of competitions in whole dataset\u003cbr /\u003e\n\u0026ndash;\u0026gt; Show the number for parameters per object in the competetions.json\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715624747709_1556966832",
      "id": "paragraph_1715624747709_1556966832",
      "dateCreated": "2024-05-13 18:25:47.709",
      "dateStarted": "2024-05-19 11:44:54.195",
      "dateFinished": "2024-05-19 11:44:54.208",
      "status": "FINISHED"
    },
    {
      "text": "import org.apache.spark.sql.SparkSession\r\nimport org.apache.spark.sql.functions._\r\n\r\nval spark \u003d SparkSession.builder\r\n  .appName(\"Football Data Analysis\")\r\n  .getOrCreate()\r\n\r\nval competitionPath \u003d \"./data/competitions.json\"\r\n\r\n// Load the JSON data\r\nval df_competitions \u003d spark.read.option(\"multiline\", \"true\").json(competitionPath)\r\n\r\nval numCompetitions \u003d df_competitions.count()\r\ndf_competitions.printSchema()\r\n\r\nprintln(s\"Total number of competitions: $numCompetitions\")\r\n",
      "user": "anonymous",
      "dateUpdated": "2024-05-19 11:44:54.295",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[33mwarning: \u001b[0m1 deprecation (since 2.13.3); for details, enable `:setting -deprecation` or `:replay -deprecation`\nroot\n |-- competition_gender: string (nullable \u003d true)\n |-- competition_id: long (nullable \u003d true)\n |-- competition_international: boolean (nullable \u003d true)\n |-- competition_name: string (nullable \u003d true)\n |-- competition_youth: boolean (nullable \u003d true)\n |-- country_name: string (nullable \u003d true)\n |-- match_available: string (nullable \u003d true)\n |-- match_available_360: string (nullable \u003d true)\n |-- match_updated: string (nullable \u003d true)\n |-- match_updated_360: string (nullable \u003d true)\n |-- season_id: long (nullable \u003d true)\n |-- season_name: string (nullable \u003d true)\n\nTotal number of competitions: 71\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nval \u001b[1m\u001b[34mspark\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.SparkSession\u001b[0m \u003d org.apache.spark.sql.SparkSession@4bc1687e\nval \u001b[1m\u001b[34mcompetitionPath\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d ./data/competitions.json\nval \u001b[1m\u001b[34mdf_competitions\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [competition_gender: string, competition_id: bigint ... 10 more fields]\nval \u001b[1m\u001b[34mnumCompetitions\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m \u003d 71\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d26"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d27"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d28"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715625528872_1499366403",
      "id": "paragraph_1715625528872_1499366403",
      "dateCreated": "2024-05-13 18:38:48.872",
      "dateStarted": "2024-05-19 11:44:54.318",
      "dateFinished": "2024-05-19 11:44:54.719",
      "status": "FINISHED"
    },
    {
      "text": "%md \n\n# Folder matches\n\n--\u003e **Count the number of competitions** by counting the distinct subfolders in the matches directory.\n--\u003e **Count the number of seasons per competition** by accessing each subfolder and counting the JSON files.\n--\u003e **Count the number of matches inside each season by reading each JSON file**, which represents a season, and counting the number of match objects within.\n",
      "user": "anonymous",
      "dateUpdated": "2024-05-19 11:44:54.819",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eFolder matches\u003c/h1\u003e\n\u003cp\u003e\u0026ndash;\u0026gt; \u003cstrong\u003eCount the number of competitions\u003c/strong\u003e by counting the distinct subfolders in the matches directory.\u003cbr /\u003e\n\u0026ndash;\u0026gt; \u003cstrong\u003eCount the number of seasons per competition\u003c/strong\u003e by accessing each subfolder and counting the JSON files.\u003cbr /\u003e\n\u0026ndash;\u0026gt; \u003cstrong\u003eCount the number of matches inside each season by reading each JSON file\u003c/strong\u003e, which represents a season, and counting the number of match objects within.\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715625554563_829487545",
      "id": "paragraph_1715625554563_829487545",
      "dateCreated": "2024-05-13 18:39:14.563",
      "dateStarted": "2024-05-19 11:44:54.841",
      "dateFinished": "2024-05-19 11:44:54.849",
      "status": "FINISHED"
    },
    {
      "text": "import org.apache.spark.sql.SparkSession\r\nimport org.apache.spark.sql.functions._\r\nimport org.apache.spark.sql.DataFrame\r\nimport java.io.File\r\n\r\nval spark \u003d SparkSession.builder\r\n  .appName(\"Detailed Football Matches Analysis\")\r\n  .master(\"local[*]\")\r\n  .getOrCreate()\r\n\r\ndef listDirectories(path: String): Array[String] \u003d {\r\n  new File(path).listFiles.filter(_.isDirectory).map(_.getPath)\r\n}\r\n\r\ndef listFiles(directory: String): Array[String] \u003d {\r\n  new File(directory).listFiles.filter(_.isFile).map(_.getPath)\r\n}\r\n\r\nval basePath \u003d \"./data/matches\"\r\nval competitionsPath \u003d \"./data/competitions.json\"\r\n\r\nval competitionsDf \u003d spark.read.option(\"multiLine\", true).json(competitionsPath)\r\n  .select(\"competition_id\", \"competition_name\")\r\n\r\nval competitionDirs \u003d listDirectories(basePath)\r\nprintln(s\"Total number of competitions: ${competitionDirs.length}\")\r\n\r\ncompetitionDirs.foreach { dir \u003d\u003e\r\n  val competitionId \u003d new File(dir).getName\r\n  println(s\"Analyzing competition: $competitionId\")\r\n\r\n  val seasonFiles \u003d listFiles(dir)\r\n  val df \u003d seasonFiles.map(file \u003d\u003e {\r\n    val seasonDf \u003d spark.read.option(\"multiline\", \"true\").json(file)\r\n    val seasonYear \u003d seasonDf.select(\"season.season_name\").first().getString(0)\r\n    val numMatches \u003d seasonDf.count()\r\n    val competition_name \u003d seasonDf.select(\"competition.competition_name\").first().getString(0)\r\n    \r\n    (competition_name, seasonYear, numMatches)\r\n  }).toSeq.toDF(\"competition_name\", \"season_name\", \"num_matches\")\r\n\r\n    df.show()\r\n}\r\n",
      "user": "anonymous",
      "dateUpdated": "2024-05-19 11:44:54.941",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[33mwarning: \u001b[0m1 deprecation (since 2.13.3); for details, enable `:setting -deprecation` or `:replay -deprecation`\nTotal number of competitions: 20\nAnalyzing competition: 11\n+----------------+-----------+-----------+\n|competition_name|season_name|num_matches|\n+----------------+-----------+-----------+\n|         La Liga|  2017/2018|         36|\n|         La Liga|  2016/2017|         34|\n|         La Liga|  2009/2010|         35|\n|         La Liga|  2010/2011|         33|\n|         La Liga|  2011/2012|         37|\n|         La Liga|  2012/2013|         32|\n|         La Liga|  2013/2014|         31|\n|         La Liga|  2014/2015|         38|\n|         La Liga|  2015/2016|        380|\n|         La Liga|  1973/1974|          1|\n|         La Liga|  2004/2005|          7|\n|         La Liga|  2005/2006|         17|\n|         La Liga|  2006/2007|         26|\n|         La Liga|  2018/2019|         34|\n|         La Liga|  2007/2008|         28|\n|         La Liga|  2008/2009|         31|\n|         La Liga|  2019/2020|         33|\n|         La Liga|  2020/2021|         35|\n+----------------+-----------+-----------+\n\nAnalyzing competition: 116\n+--------------------+-----------+-----------+\n|    competition_name|season_name|num_matches|\n+--------------------+-----------+-----------+\n|North American Le...|       1977|          1|\n+--------------------+-----------+-----------+\n\nAnalyzing competition: 12\n+----------------+-----------+-----------+\n|competition_name|season_name|num_matches|\n+----------------+-----------+-----------+\n|         Serie A|  2015/2016|        380|\n|         Serie A|  1986/1987|          1|\n+----------------+-----------+-----------+\n\nAnalyzing competition: 1238\n+-------------------+-----------+-----------+\n|   competition_name|season_name|num_matches|\n+-------------------+-----------+-----------+\n|Indian Super league|  2021/2022|        115|\n+-------------------+-----------+-----------+\n\nAnalyzing competition: 1267\n+--------------------+-----------+-----------+\n|    competition_name|season_name|num_matches|\n+--------------------+-----------+-----------+\n|African Cup of Na...|       2023|         52|\n+--------------------+-----------+-----------+\n\nAnalyzing competition: 1470\n+------------------+-----------+-----------+\n|  competition_name|season_name|num_matches|\n+------------------+-----------+-----------+\n|FIFA U20 World Cup|       1979|          1|\n+------------------+-----------+-----------+\n\nAnalyzing competition: 16\n+----------------+-----------+-----------+\n|competition_name|season_name|num_matches|\n+----------------+-----------+-----------+\n|Champions League|  2017/2018|          1|\n|Champions League|  2016/2017|          1|\n|Champions League|  2009/2010|          1|\n|Champions League|  2010/2011|          1|\n|Champions League|  2011/2012|          1|\n|Champions League|  2012/2013|          1|\n|Champions League|  2013/2014|          1|\n|Champions League|  2014/2015|          1|\n|Champions League|  2015/2016|          1|\n|Champions League|  1970/1971|          1|\n|Champions League|  1972/1973|          1|\n|Champions League|  2004/2005|          1|\n|Champions League|  2006/2007|          1|\n|Champions League|  2018/2019|          1|\n|Champions League|  2008/2009|          1|\n|Champions League|  2003/2004|          1|\n|Champions League|  1971/1972|          1|\n|Champions League|  1999/2000|          1|\n+----------------+-----------+-----------+\n\nAnalyzing competition: 2\n+----------------+-----------+-----------+\n|competition_name|season_name|num_matches|\n+----------------+-----------+-----------+\n|  Premier League|  2015/2016|        380|\n|  Premier League|  2003/2004|         38|\n+----------------+-----------+-----------+\n\nAnalyzing competition: 35\n+------------------+-----------+-----------+\n|  competition_name|season_name|num_matches|\n+------------------+-----------+-----------+\n|UEFA Europa League|  1988/1989|          3|\n+------------------+-----------+-----------+\n\nAnalyzing competition: 37\n+--------------------+-----------+-----------+\n|    competition_name|season_name|num_matches|\n+--------------------+-----------+-----------+\n|FA Women\u0027s Super ...|  2018/2019|        108|\n|FA Women\u0027s Super ...|  2019/2020|         87|\n|FA Women\u0027s Super ...|  2020/2021|        131|\n+--------------------+-----------+-----------+\n\nAnalyzing competition: 43\n+----------------+-----------+-----------+\n|competition_name|season_name|num_matches|\n+----------------+-----------+-----------+\n|  FIFA World Cup|       2022|         64|\n|  FIFA World Cup|       1958|          2|\n|  FIFA World Cup|       1962|          1|\n|  FIFA World Cup|       1970|          6|\n|  FIFA World Cup|       2018|         64|\n|  FIFA World Cup|       1974|          6|\n|  FIFA World Cup|       1986|          3|\n|  FIFA World Cup|       1990|          1|\n+----------------+-----------+-----------+\n\nAnalyzing competition: 44\n+-------------------+-----------+-----------+\n|   competition_name|season_name|num_matches|\n+-------------------+-----------+-----------+\n|Major League Soccer|       2023|          6|\n+-------------------+-----------+-----------+\n\nAnalyzing competition: 49\n+----------------+-----------+-----------+\n|competition_name|season_name|num_matches|\n+----------------+-----------+-----------+\n|            NWSL|       2018|         36|\n+----------------+-----------+-----------+\n\nAnalyzing competition: 53\n+-----------------+-----------+-----------+\n| competition_name|season_name|num_matches|\n+-----------------+-----------+-----------+\n|UEFA Women\u0027s Euro|       2022|         31|\n+-----------------+-----------+-----------+\n\nAnalyzing competition: 55\n+----------------+-----------+-----------+\n|competition_name|season_name|num_matches|\n+----------------+-----------+-----------+\n|       UEFA Euro|       2020|         51|\n+----------------+-----------+-----------+\n\nAnalyzing competition: 7\n+----------------+-----------+-----------+\n|competition_name|season_name|num_matches|\n+----------------+-----------+-----------+\n|         Ligue 1|  2021/2022|         26|\n|         Ligue 1|  2022/2023|         32|\n|         Ligue 1|  2015/2016|        377|\n+----------------+-----------+-----------+\n\nAnalyzing competition: 72\n+-----------------+-----------+-----------+\n| competition_name|season_name|num_matches|\n+-----------------+-----------+-----------+\n|Women\u0027s World Cup|       2023|         64|\n|Women\u0027s World Cup|       2019|         52|\n+-----------------+-----------+-----------+\n\nAnalyzing competition: 81\n+----------------+-----------+-----------+\n|competition_name|season_name|num_matches|\n+----------------+-----------+-----------+\n|Liga Profesional|       1981|          1|\n|Liga Profesional|  1997/1998|          1|\n+----------------+-----------+-----------+\n\nAnalyzing competition: 87\n+----------------+-----------+-----------+\n|competition_name|season_name|num_matches|\n+----------------+-----------+-----------+\n|    Copa del Rey|  1982/1983|          1|\n|    Copa del Rey|  1977/1978|          1|\n|    Copa del Rey|  1983/1984|          1|\n+----------------+-----------+-----------+\n\nAnalyzing competition: 9\n+----------------+-----------+-----------+\n|competition_name|season_name|num_matches|\n+----------------+-----------+-----------+\n|   1. Bundesliga|  2015/2016|        306|\n+----------------+-----------+-----------+\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.DataFrame\nimport java.io.File\nval \u001b[1m\u001b[34mspark\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.SparkSession\u001b[0m \u003d org.apache.spark.sql.SparkSession@4bc1687e\ndef listDirectories(path: String): \u001b[1m\u001b[32mArray[String]\u001b[0m\ndef listFiles(directory: String): \u001b[1m\u001b[32mArray[String]\u001b[0m\nval \u001b[1m\u001b[34mbasePath\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d ./data/matches\nval \u001b[1m\u001b[34mcompetitionsPath\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d ./data/competitions.json\nval \u001b[1m\u001b[34mcompetitionsDf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [competition_id: bigint, competition_name: string]\nval \u001b[1m\u001b[34mcompetitionDirs\u001b[0m: \u001b[1m\u001b[32mArray[String]\u001b[0m \u003d Array(./data/matches/11, ./data/matches/116, ./data/matches/12, ./data/matches/1...\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d29"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d30"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d31"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d32"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d33"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d34"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d35"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d36"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d37"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d38"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d39"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d40"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d41"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d42"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d43"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d44"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d45"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d46"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d47"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d48"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d49"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d50"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d51"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d52"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d53"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d54"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d55"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d56"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d57"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d58"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d59"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d60"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d61"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d62"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d63"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d64"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d65"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d66"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d67"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d68"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d69"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d70"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d71"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d72"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d73"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d74"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d75"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d76"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d77"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d78"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d79"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d80"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d81"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d82"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d83"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d84"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d85"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d86"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d87"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d88"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d89"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d90"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d91"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d92"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d93"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d94"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d95"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d96"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d97"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d98"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d99"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d100"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d101"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d102"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d103"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d104"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d105"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d106"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d107"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d108"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d109"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d110"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d111"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d112"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d113"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d114"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d115"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d116"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d117"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d118"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d119"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d120"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d121"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d122"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d123"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d124"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d125"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d126"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d127"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d128"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d129"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d130"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d131"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d132"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d133"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d134"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d135"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d136"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d137"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d138"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d139"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d140"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d141"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d142"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d143"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d144"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d145"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d146"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d147"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d148"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d149"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d150"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d151"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d152"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d153"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d154"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d155"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d156"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d157"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d158"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d159"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d160"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d161"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d162"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d163"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d164"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d165"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d166"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d167"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d168"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d169"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d170"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d171"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d172"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d173"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d174"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d175"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d176"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d177"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d178"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d179"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d180"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d181"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d182"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d183"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d184"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d185"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d186"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d187"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d188"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d189"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d190"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d191"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d192"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d193"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d194"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d195"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d196"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d197"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d198"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d199"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d200"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d201"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d202"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d203"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d204"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d205"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d206"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d207"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d208"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d209"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d210"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d211"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d212"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d213"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d214"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d215"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d216"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d217"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d218"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d219"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d220"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d221"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d222"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d223"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d224"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d225"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d226"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d227"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d228"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d229"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d230"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d231"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d232"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d233"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d234"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d235"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d236"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d237"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d238"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d239"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d240"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d241"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d242"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d243"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d244"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d245"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d246"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d247"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d248"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d249"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d250"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d251"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d252"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d253"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d254"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d255"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d256"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d257"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d258"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d259"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d260"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d261"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d262"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d263"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d264"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d265"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d266"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d267"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d268"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d269"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d270"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d271"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d272"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d273"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d274"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d275"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d276"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d277"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d278"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d279"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d280"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d281"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d282"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d283"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d284"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d285"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d286"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d287"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d288"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d289"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d290"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d291"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d292"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d293"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d294"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d295"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d296"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d297"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d298"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d299"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d300"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d301"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d302"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d303"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d304"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d305"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d306"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d307"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d308"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d309"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d310"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d311"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d312"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d313"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d314"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d315"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d316"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d317"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d318"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d319"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d320"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d321"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d322"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d323"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d324"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d325"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d326"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d327"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d328"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d329"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d330"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d331"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d332"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d333"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d334"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d335"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d336"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d337"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d338"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d339"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d340"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d341"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d342"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d343"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d344"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d345"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d346"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d347"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d348"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d349"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d350"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d351"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d352"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d353"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d354"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d355"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d356"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d357"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d358"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d359"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d360"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d361"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d362"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d363"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d364"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d365"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d366"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d367"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d368"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d369"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d370"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d371"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d372"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d373"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d374"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d375"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d376"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d377"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d378"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d379"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d380"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d381"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d382"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d383"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d384"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715625697445_1149186727",
      "id": "paragraph_1715625697445_1149186727",
      "dateCreated": "2024-05-13 18:41:37.445",
      "dateStarted": "2024-05-19 11:44:54.963",
      "dateFinished": "2024-05-19 11:45:20.131",
      "status": "FINISHED"
    },
    {
      "text": "%md \n\n# Get all matches in a dataframe \n\nthis version is for locally use in docker ",
      "user": "anonymous",
      "dateUpdated": "2024-05-19 11:45:20.194",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eGet all matches in a dataframe\u003c/h1\u003e\n\u003cp\u003ethis version is for locally use in docker\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715712413945_588439423",
      "id": "paragraph_1715712413945_588439423",
      "dateCreated": "2024-05-14 18:46:53.945",
      "dateStarted": "2024-05-19 11:45:20.214",
      "dateFinished": "2024-05-19 11:45:20.219",
      "status": "FINISHED"
    },
    {
      "text": "import org.apache.spark.sql.SparkSession\r\nimport org.apache.spark.sql.functions._\r\nimport org.apache.spark.sql.DataFrame\r\nimport java.io.File\r\n\r\nval spark \u003d SparkSession.builder\r\n  .appName(\"Detailed Football Matches Analysis\")\r\n  .master(\"local[*]\")\r\n  .getOrCreate()\r\n\r\nimport spark.implicits._\r\n\r\ndef listDirectories(path: String): Array[String] \u003d {\r\n  new File(path).listFiles.filter(_.isDirectory).map(_.getPath)\r\n}\r\n\r\ndef listFiles(directory: String): Array[String] \u003d {\r\n  new File(directory).listFiles.filter(_.isFile).map(_.getPath)\r\n}\r\n\r\nval basePath \u003d \"./data/matches\"\r\nval competitionsPath \u003d \"./data/competitions.json\"\r\n\r\n// Start time\r\nval startTime \u003d System.currentTimeMillis()\r\n\r\nval competitionsDf \u003d spark.read.option(\"multiLine\", true).json(competitionsPath)\r\n  .select(\"competition_id\", \"competition_name\")\r\n\r\nval competitionDirs \u003d listDirectories(basePath)\r\nprintln(s\"Total number of competitions: ${competitionDirs.length}\")\r\n\r\nvar matchesDf: DataFrame \u003d spark.emptyDataFrame\r\n\r\ncompetitionDirs.foreach { dir \u003d\u003e\r\n  val competitionId \u003d new File(dir).getName\r\n  println(s\"Analyzing competition: $competitionId\")\r\n\r\n  val seasonFiles \u003d listFiles(dir)\r\n  seasonFiles.foreach { file \u003d\u003e\r\n    val seasonDf \u003d spark.read.option(\"multiline\", \"true\").json(file)\r\n    val seasonYear \u003d seasonDf.select(\"season.season_name\").first().getString(0)\r\n    val competitionName \u003d seasonDf.select(\"competition.competition_name\").first().getString(0)\r\n\r\n    val matches \u003d seasonDf.select(\r\n      $\"match_id\",\r\n      lit(competitionName).alias(\"competition_name\"),\r\n      lit(seasonYear).alias(\"year\"),\r\n      $\"home_team.home_team_name\".alias(\"home_team\"),\r\n      $\"home_team.home_team_id\".alias(\"home_team_id\"),\r\n      $\"away_team.away_team_name\".alias(\"away_team\"),\r\n      $\"away_team.away_team_id\".alias(\"away_team_id\"),\r\n      $\"home_score\",\r\n      $\"away_score\",\r\n      $\"match_date\"\r\n    )\r\n\r\n    matchesDf \u003d if (matchesDf.isEmpty) matches else matchesDf.union(matches)\r\n  }\r\n}\r\n\r\nmatchesDf.show()\r\n\r\n// Save the aggregated DataFrame to a Parquet file\r\nmatchesDf.write.mode(\"overwrite\").parquet(\"./data/all_matches.parquet\")\r\n\r\n// End time\r\nval endTime \u003d System.currentTimeMillis()\r\n\r\n// Calculate and print the execution time\r\nval duration \u003d (endTime - startTime) / 1000.0\r\nprintln(s\"Execution time: $duration seconds\")\r\n",
      "user": "anonymous",
      "dateUpdated": "2024-05-19 11:45:20.314",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[33mwarning: \u001b[0m1 deprecation (since 2.13.3); for details, enable `:setting -deprecation` or `:replay -deprecation`\nTotal number of competitions: 20\nAnalyzing competition: 11\nAnalyzing competition: 116\nAnalyzing competition: 12\nAnalyzing competition: 1238\nAnalyzing competition: 1267\nAnalyzing competition: 1470\nAnalyzing competition: 16\nAnalyzing competition: 2\nAnalyzing competition: 35\nAnalyzing competition: 37\nAnalyzing competition: 43\nAnalyzing competition: 44\nAnalyzing competition: 49\nAnalyzing competition: 53\nAnalyzing competition: 55\nAnalyzing competition: 7\nAnalyzing competition: 72\nAnalyzing competition: 81\nAnalyzing competition: 87\nAnalyzing competition: 9\n+--------+----------------+---------+--------------------+------------+-------------+------------+----------+----------+----------+\n|match_id|competition_name|     year|           home_team|home_team_id|    away_team|away_team_id|home_score|away_score|match_date|\n+--------+----------------+---------+--------------------+------------+-------------+------------+----------+----------+----------+\n|    9880|         La Liga|2017/2018|           Barcelona|         217|     Valencia|         207|         2|         1|2018-04-14|\n|    9912|         La Liga|2017/2018|RC Deportivo La C...|         219|    Barcelona|         217|         2|         4|2018-04-29|\n|    9924|         La Liga|2017/2018|           Barcelona|         217|  Real Madrid|         220|         2|         2|2018-05-06|\n|    9855|         La Liga|2017/2018|           Barcelona|         217|Athletic Club|         215|         2|         0|2018-03-18|\n|    9827|         La Liga|2017/2018|          Las Palmas|         208|    Barcelona|         217|         1|         1|2018-03-01|\n|    9799|         La Liga|2017/2018|               Eibar|         322|    Barcelona|         217|         0|         2|2018-02-17|\n|    9636|         La Liga|2017/2018|           Barcelona|         217|   Las Palmas|         208|         3|         0|2017-10-01|\n|    9609|         La Liga|2017/2018|           Barcelona|         217|        Eibar|         322|         6|         1|2017-09-19|\n|    9575|         La Liga|2017/2018|           Barcelona|         217|   Real Betis|         218|         2|         0|2017-08-20|\n|    9928|         La Liga|2017/2018|           Barcelona|         217|   Villarreal|         222|         5|         1|2018-05-09|\n|    9736|         La Liga|2017/2018|         Real Madrid|         220|    Barcelona|         217|         0|         3|2017-12-23|\n|    9742|         La Liga|2017/2018|           Barcelona|         217|   Levante UD|         221|         3|         0|2018-01-07|\n|    9765|         La Liga|2017/2018|          Real Betis|         218|    Barcelona|         217|         0|         5|2018-01-21|\n|    9661|         La Liga|2017/2018|       Athletic Club|         215|    Barcelona|         217|         0|         2|2017-10-28|\n|    9592|         La Liga|2017/2018|           Barcelona|         217|     Espanyol|         214|         5|         0|2017-09-09|\n|    9870|         La Liga|2017/2018|           Barcelona|         217|      Leganés|         205|         3|         1|2018-04-07|\n|    9783|         La Liga|2017/2018|            Espanyol|         214|    Barcelona|         217|         1|         1|2018-02-04|\n|    9700|         La Liga|2017/2018|           Barcelona|         217|   Celta Vigo|         209|         2|         2|2017-12-02|\n|    9860|         La Liga|2017/2018|             Sevilla|         213|    Barcelona|         217|         2|         2|2018-03-31|\n|    9695|         La Liga|2017/2018|            Valencia|         207|    Barcelona|         217|         1|         1|2017-11-26|\n+--------+----------------+---------+--------------------+------------+-------------+------------+----------+----------+----------+\nonly showing top 20 rows\n\nExecution time: 58.83 seconds\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.DataFrame\nimport java.io.File\nval \u001b[1m\u001b[34mspark\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.SparkSession\u001b[0m \u003d org.apache.spark.sql.SparkSession@4bc1687e\nimport spark.implicits._\ndef listDirectories(path: String): \u001b[1m\u001b[32mArray[String]\u001b[0m\ndef listFiles(directory: String): \u001b[1m\u001b[32mArray[String]\u001b[0m\nval \u001b[1m\u001b[34mbasePath\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d ./data/matches\nval \u001b[1m\u001b[34mcompetitionsPath\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d ./data/competitions.json\nval \u001b[1m\u001b[34mstartTime\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m \u003d 1716119120567\nval \u001b[1m\u001b[34mcompetitionsDf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [competition_id: bigint, competition_name: string]\nval \u001b[1m\u001b[34mcompetitionDirs\u001b[0m: \u001b[1m\u001b[32mArray[String]...\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d385"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d386"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d387"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d388"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d389"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d390"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d391"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d392"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d393"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d394"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d395"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d396"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d397"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d398"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d399"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d400"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d401"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d402"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d403"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d404"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d405"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d406"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d407"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d408"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d409"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d410"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d411"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d412"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d413"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d414"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d415"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d416"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d417"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d418"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d419"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d420"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d421"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d422"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d423"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d424"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d425"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d426"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d427"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d428"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d429"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d430"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d431"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d432"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d433"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d434"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d435"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d436"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d437"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d438"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d439"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d440"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d441"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d442"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d443"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d444"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d445"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d446"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d447"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d448"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d449"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d450"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d451"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d452"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d453"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d454"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d455"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d456"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d457"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d458"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d459"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d460"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d461"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d462"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d463"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d464"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d465"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d466"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d467"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d468"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d469"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d470"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d471"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d472"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d473"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d474"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d475"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d476"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d477"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d478"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d479"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d480"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d481"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d482"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d483"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d484"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d485"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d486"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d487"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d488"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d489"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d490"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d491"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d492"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d493"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d494"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d495"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d496"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d497"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d498"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d499"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d500"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d501"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d502"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d503"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d504"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d505"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d506"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d507"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d508"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d509"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d510"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d511"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d512"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d513"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d514"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d515"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d516"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d517"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d518"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d519"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d520"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d521"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d522"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d523"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d524"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d525"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d526"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d527"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d528"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d529"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d530"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d531"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d532"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d533"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d534"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d535"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d536"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d537"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d538"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d539"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d540"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d541"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d542"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d543"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d544"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d545"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d546"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d547"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d548"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d549"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d550"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d551"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d552"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d553"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d554"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d555"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d556"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d557"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d558"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d559"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d560"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d561"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d562"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d563"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d564"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d565"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d566"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d567"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d568"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d569"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d570"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d571"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d572"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d573"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d574"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d575"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d576"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d577"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d578"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d579"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d580"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d581"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d582"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d583"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d584"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d585"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d586"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d587"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d588"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d589"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d590"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d591"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d592"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d593"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d594"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d595"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d596"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d597"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d598"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d599"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d600"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d601"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d602"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d603"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d604"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d605"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d606"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d607"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d608"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d609"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d610"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d611"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d612"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d613"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d614"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d615"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d616"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d617"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d618"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d619"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d620"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d621"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d622"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d623"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d624"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d625"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d626"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d627"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d628"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d629"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d630"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d631"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d632"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d633"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d634"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d635"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d636"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d637"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d638"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d639"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d640"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d641"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d642"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d643"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d644"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d645"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d646"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d647"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d648"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d649"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d650"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d651"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d652"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d653"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d654"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d655"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d656"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d657"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d658"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d659"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d660"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d661"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d662"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d663"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d664"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d665"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d666"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d667"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d668"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d669"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d670"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715712424342_640682152",
      "id": "paragraph_1715712424342_640682152",
      "dateCreated": "2024-05-14 18:47:04.342",
      "dateStarted": "2024-05-19 11:45:20.332",
      "dateFinished": "2024-05-19 11:46:19.722",
      "status": "FINISHED"
    },
    {
      "text": "%md\n\nThe data above is save in parquet folder (it\u0027s normal to see in a \"folder\")",
      "user": "anonymous",
      "dateUpdated": "2024-05-19 11:46:19.812",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eThe data above is save in parquet folder (it\u0026rsquo;s normal to see in a \u0026ldquo;folder\u0026rdquo;)\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715712872885_1705171494",
      "id": "paragraph_1715712872885_1705171494",
      "dateCreated": "2024-05-14 18:54:32.885",
      "dateStarted": "2024-05-19 11:46:19.832",
      "dateFinished": "2024-05-19 11:46:19.839",
      "status": "FINISHED"
    },
    {
      "text": "%md\n\nThe code below needs to be only executed in google dataproc compare the two times local vs distributed",
      "user": "anonymous",
      "dateUpdated": "2024-05-19 11:46:19.932",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003eThe code below needs to be only executed in google dataproc compare the two times local vs distributed\u003c/p\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715713980139_1796056247",
      "id": "paragraph_1715713980139_1796056247",
      "dateCreated": "2024-05-14 19:13:00.139",
      "dateStarted": "2024-05-19 11:46:19.950",
      "dateFinished": "2024-05-19 11:46:19.956",
      "status": "FINISHED"
    },
    {
      "text": "/**import org.apache.spark.sql.SparkSession\r\nimport org.apache.spark.sql.functions._\r\nimport java.io.File\r\n\r\nval spark \u003d SparkSession.builder\r\n  .appName(\"Detailed Football Matches Analysis\")\r\n  .getOrCreate()\r\n\r\nimport spark.implicits._\r\n\r\ndef listDirectories(path: String): Array[String] \u003d {\r\n  new File(path).listFiles.filter(_.isDirectory).map(_.getPath)\r\n}\r\n\r\ndef listFiles(directory: String): Array[String] \u003d {\r\n  new File(directory).listFiles.filter(_.isFile).map(_.getPath)\r\n}\r\n\r\nval basePath \u003d \"./data/matches\"\r\nval competitionsPath \u003d \"./data/competitions.json\"\r\n\r\n// Start time\r\nval startTime \u003d System.currentTimeMillis()\r\n\r\nval competitionsDf \u003d spark.read.option(\"multiLine\", true).json(competitionsPath)\r\n  .select(\"competition_id\", \"competition_name\")\r\n\r\nval competitionDirs \u003d listDirectories(basePath)\r\nprintln(s\"Total number of competitions: ${competitionDirs.length}\")\r\n\r\n// Use Spark to read all JSON files in parallel\r\nval allFiles \u003d competitionDirs.flatMap(listFiles)\r\n\r\nval matchesDf \u003d spark.read.option(\"multiline\", \"true\").json(allFiles: _*)\r\n  .select(\r\n    $\"match_id\",\r\n    $\"competition.competition_name\".alias(\"competition_name\"),\r\n    $\"season.season_name\".alias(\"year\"),\r\n    $\"home_team.home_team_name\".alias(\"home_team\"),\r\n    $\"home_team.home_team_id\".alias(\"home_team_id\"),\r\n    $\"away_team.away_team_name\".alias(\"away_team\"),\r\n    $\"away_team.away_team_id\".alias(\"away_team_id\"),\r\n    $\"home_score\",\r\n    $\"away_score\",\r\n    $\"match_date\"\r\n  )\r\n\r\nmatchesDf.show()\r\n\r\n// Save the aggregated DataFrame to a Parquet file\r\nmatchesDf.write.mode(\"overwrite\").parquet(\"gs://your-bucket-name/path/to/all_matches.parquet\")\r\n\r\n// End time\r\nval endTime \u003d System.currentTimeMillis()\r\n\r\n// Calculate and print the execution time\r\nval duration \u003d (endTime - startTime) / 1000.0\r\nprintln(s\"Execution time: $duration seconds\")**/\r\n",
      "user": "anonymous",
      "dateUpdated": "2024-05-19 11:46:20.050",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "ERROR",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715713941278_232701867",
      "id": "paragraph_1715713941278_232701867",
      "dateCreated": "2024-05-14 19:12:21.278",
      "dateStarted": "2024-05-19 11:46:20.070",
      "dateFinished": "2024-05-19 11:46:20.075",
      "status": "ERROR"
    },
    {
      "text": "%md\n# Load the parquet folder",
      "user": "anonymous",
      "dateUpdated": "2024-05-14 18:55:32.576",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eLoad the parquet folder\u003c/h1\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715712923234_520042757",
      "id": "paragraph_1715712923234_520042757",
      "dateCreated": "2024-05-14 18:55:23.234",
      "dateStarted": "2024-05-14 18:55:32.575",
      "dateFinished": "2024-05-14 18:55:32.580",
      "status": "FINISHED"
    },
    {
      "text": "import org.apache.spark.sql.SparkSession\r\nimport org.apache.spark.sql.functions._\r\nimport org.apache.spark.sql.DataFrame\r\n\r\nval spark \u003d SparkSession.builder\r\n  .appName(\"Load Football Matches Analysis\")\r\n  .master(\"local[*]\")  // Use all available cores\r\n  .getOrCreate()\r\n\r\n// Load the Parquet file into a DataFrame\r\nval matchesDf \u003d spark.read.parquet(\"./data/all_matches.parquet\")\r\n\r\n// Show the schema of the DataFrame\r\nmatchesDf.printSchema()\r\n\r\n// Show the first few rows of the DataFrame\r\nmatchesDf.show()\r\n\r\n// Perform some basic operations\r\nval totalMatches \u003d matchesDf.count()\r\nprintln(s\"Total number of matches: $totalMatches\")\r\n\r\n// Example: Group by year and count the number of matches per year\r\nval matchesPerYear \u003d matchesDf.groupBy(\"year\").count()\r\nmatchesPerYear.show()\r\n\r\n// Example: Find the average home and away scores\r\nval avgScores \u003d matchesDf.agg(avg(\"home_score\").alias(\"avg_home_score\"), avg(\"away_score\").alias(\"avg_away_score\"))\r\navgScores.show()\r\n",
      "user": "anonymous",
      "dateUpdated": "2024-05-14 18:56:24.897",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[33mwarning: \u001b[0m1 deprecation (since 2.13.3); for details, enable `:setting -deprecation` or `:replay -deprecation`\nroot\n |-- match_id: long (nullable \u003d true)\n |-- competition_name: string (nullable \u003d true)\n |-- year: string (nullable \u003d true)\n |-- home_team: string (nullable \u003d true)\n |-- home_team_id: long (nullable \u003d true)\n |-- away_team: string (nullable \u003d true)\n |-- away_team_id: long (nullable \u003d true)\n |-- home_score: long (nullable \u003d true)\n |-- away_score: long (nullable \u003d true)\n |-- match_date: string (nullable \u003d true)\n\n+--------+----------------+---------+--------------------+------------+--------------------+------------+----------+----------+----------+\n|match_id|competition_name|     year|           home_team|home_team_id|           away_team|away_team_id|home_score|away_score|match_date|\n+--------+----------------+---------+--------------------+------------+--------------------+------------+----------+----------+----------+\n| 3825848|         La Liga|2015/2016|          Levante UD|         221|               Eibar|         322|         2|         2|2015-09-23|\n| 3825895|         La Liga|2015/2016|          Las Palmas|         208|             Sevilla|         213|         2|         0|2015-09-23|\n| 3825894|         La Liga|2015/2016|RC Deportivo La C...|         219|              Getafe|         216|         0|         2|2016-05-01|\n| 3825855|         La Liga|2015/2016|              Málaga|         223|          Levante UD|         221|         3|         1|2016-05-02|\n| 3825908|         La Liga|2015/2016|            Espanyol|         214|               Eibar|         322|         4|         2|2016-05-15|\n| 3825883|         La Liga|2015/2016|              Málaga|         223|          Las Palmas|         208|         4|         1|2016-05-15|\n| 3825900|         La Liga|2015/2016|      Sporting Gijón|        1041|          Villarreal|         222|         2|         0|2016-05-15|\n| 3825902|         La Liga|2015/2016|      Rayo Vallecano|         360|          Levante UD|         221|         3|         1|2016-05-15|\n| 3825876|         La Liga|2015/2016|          Real Betis|         218|              Getafe|         216|         2|         1|2016-05-15|\n| 3825846|         La Liga|2015/2016|RC Deportivo La C...|         219|         Real Madrid|         220|         0|         2|2016-05-14|\n| 3825869|         La Liga|2015/2016|       Athletic Club|         215|             Sevilla|         213|         3|         1|2016-05-14|\n| 3825882|         La Liga|2015/2016|     Atlético Madrid|         212|          Celta Vigo|         209|         2|         0|2016-05-14|\n| 3825849|         La Liga|2015/2016|            Valencia|         207|       Real Sociedad|         210|         0|         1|2016-05-13|\n| 3825860|         La Liga|2015/2016|          Levante UD|         221|     Atlético Madrid|         212|         2|         1|2016-05-08|\n| 3825847|         La Liga|2015/2016|               Eibar|         322|RC Deportivo La C...|         219|         1|         1|2016-04-23|\n| 3825817|         La Liga|2015/2016|              Getafe|         216|               Eibar|         322|         1|         1|2016-03-18|\n| 3825778|         La Liga|2015/2016|          Real Betis|         218|      Sporting Gijón|        1041|         1|         1|2016-02-20|\n| 3825777|         La Liga|2015/2016|          Levante UD|         221|              Getafe|         216|         3|         0|2016-02-19|\n| 3825740|         La Liga|2015/2016|               Eibar|         322|             Granada|        1049|         5|         1|2016-01-18|\n| 3825875|         La Liga|2015/2016|          Villarreal|         222|       Real Sociedad|         210|         0|         0|2016-04-24|\n+--------+----------------+---------+--------------------+------------+--------------------+------------+----------+----------+----------+\nonly showing top 20 rows\n\nTotal number of matches: 3316\n+---------+-----+\n|     year|count|\n+---------+-----+\n|2020/2021|  166|\n|2015/2016| 1824|\n|2021/2022|  141|\n|     2018|  100|\n|2019/2020|  120|\n|     2022|   95|\n|     2023|  122|\n|2018/2019|  143|\n|     2020|   51|\n|     2019|   52|\n|2003/2004|   39|\n|2014/2015|   39|\n|2011/2012|   38|\n|2016/2017|   35|\n|2017/2018|   37|\n|2009/2010|   36|\n|2012/2013|   33|\n|2010/2011|   34|\n|2007/2008|   28|\n|2008/2009|   32|\n+---------+-----+\nonly showing top 20 rows\n\n+------------------+------------------+\n|    avg_home_score|    avg_away_score|\n+------------------+------------------+\n|1.5980096501809409|1.2605548854041013|\n+------------------+------------------+\n\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.DataFrame\nval \u001b[1m\u001b[34mspark\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.SparkSession\u001b[0m \u003d org.apache.spark.sql.SparkSession@6a78d7e2\nval \u001b[1m\u001b[34mmatchesDf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [match_id: bigint, competition_name: string ... 8 more fields]\nval \u001b[1m\u001b[34mtotalMatches\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m \u003d 3316\nval \u001b[1m\u001b[34mmatchesPerYear\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [year: string, count: bigint]\nval \u001b[1m\u001b[34mavgScores\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [avg_home_score: double, avg_away_score: double]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d960"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d961"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d962"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d963"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d964"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d965"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d966"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d967"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715711637896_1086499620",
      "id": "paragraph_1715711637896_1086499620",
      "dateCreated": "2024-05-14 18:33:57.896",
      "dateStarted": "2024-05-14 18:55:35.391",
      "dateFinished": "2024-05-14 18:55:39.146",
      "status": "FINISHED"
    },
    {
      "text": "%md \n\n# Get number of matches done by each team",
      "user": "anonymous",
      "dateUpdated": "2024-05-14 19:22:58.186",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eGet number of matches done by each team\u003c/h1\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715714561051_1172726842",
      "id": "paragraph_1715714561051_1172726842",
      "dateCreated": "2024-05-14 19:22:41.051",
      "dateStarted": "2024-05-14 19:22:58.185",
      "dateFinished": "2024-05-14 19:22:58.192",
      "status": "FINISHED"
    },
    {
      "text": "\r\nval homeMatches \u003d matchesDf.groupBy(\"home_team\").agg(count(\"*\").alias(\"matches_count\"))\r\nval awayMatches \u003d matchesDf.groupBy(\"away_team\").agg(count(\"*\").alias(\"matches_count\"))\r\n\r\nval homeMatchesRenamed \u003d homeMatches.withColumnRenamed(\"home_team\", \"team\")\r\nval awayMatchesRenamed \u003d awayMatches.withColumnRenamed(\"away_team\", \"team\")\r\n\r\nval totalMatches \u003d homeMatchesRenamed.union(awayMatchesRenamed)\r\n  .groupBy(\"team\")\r\n  .agg(sum(\"matches_count\").alias(\"total_matches\"))\r\n  .orderBy(desc(\"total_matches\"))\r\n\r\ntotalMatches.show(100)",
      "user": "anonymous",
      "dateUpdated": "2024-05-17 09:23:36.066",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------------------+-------------+\n|                team|total_matches|\n+--------------------+-------------+\n|           Barcelona|          532|\n| Paris Saint-Germain|           95|\n|   Manchester United|           79|\n|             Arsenal|           76|\n|         Real Madrid|           71|\n|     Atlético Madrid|           68|\n|             Sevilla|           66|\n|            Valencia|           65|\n|       Athletic Club|           64|\n|            Espanyol|           63|\n|         Aston Villa|           62|\n|          Villarreal|           61|\n|              Getafe|           61|\n| Manchester City WFC|           59|\n|       Real Sociedad|           59|\n|          Real Betis|           58|\n|Brighton \u0026 Hove A...|           57|\n|         Chelsea FCW|           57|\n|          Levante UD|           57|\n|         Arsenal WFC|           57|\n| West Ham United LFC|           56|\n|    Bristol City WFC|           56|\n|         Reading WFC|           56|\n|         Everton LFC|           55|\n|          Celta Vigo|           54|\n|RC Deportivo La C...|           53|\n|              Málaga|           53|\n| Birmingham City WFC|           53|\n|             Granada|           50|\n|               Eibar|           48|\n|      Rayo Vallecano|           47|\n|           Liverpool|           44|\n|      Sporting Gijón|           44|\n|          Las Palmas|           43|\n|            Juventus|           43|\n|               Lille|           42|\n|              Nantes|           42|\n|           Marseille|           42|\n|            OGC Nice|           42|\n|              Rennes|           42|\n|              Napoli|           42|\n|         Montpellier|           41|\n|                Lyon|           41|\n|      Stade de Reims|           41|\n|   Tottenham Hotspur|           41|\n|           AS Monaco|           41|\n|             Chelsea|           41|\n|             Lorient|           41|\n|         Inter Milan|           40|\n|              Angers|           40|\n|    Newcastle United|           40|\n|     Manchester City|           40|\n|         Southampton|           40|\n|      Leicester City|           40|\n|            Toulouse|           40|\n|            AC Milan|           40|\n|             Everton|           40|\n|       Saint-Étienne|           39|\n|          Fiorentina|           39|\n|              Troyes|           39|\n|             Palermo|           38|\n|               Carpi|           38|\n|        Swansea City|           38|\n|       Hellas Verona|           38|\n|          Sunderland|           38|\n|             Bologna|           38|\n|               Lazio|           38|\n|          Stoke City|           38|\n|      Crystal Palace|           38|\n|     AFC Bournemouth|           38|\n|                Caen|           38|\n|            Sassuolo|           38|\n|               Genoa|           38|\n|            Bordeaux|           38|\n|            Guingamp|           38|\n|              Chievo|           38|\n|       Bayern Munich|           38|\n|             AS Roma|           38|\n|        Norwich City|           38|\n|           Frosinone|           38|\n|West Bromwich Albion|           38|\n|              Torino|           38|\n|              Empoli|           38|\n|            Atalanta|           38|\n|             Watford|           38|\n|     West Ham United|           38|\n|           Sampdoria|           38|\n|             Udinese|           38|\n|              Bastia|           37|\n|     Gazélec Ajaccio|           37|\n|Tottenham Hotspur...|           36|\n|       VfB Stuttgart|           35|\n|   Borussia Dortmund|           35|\n|          Schalke 04|           34|\n|         Hannover 96|           34|\n|          Hoffenheim|           34|\n|       Werder Bremen|           34|\n|             FC Köln|           34|\n|        Darmstadt 98|           34|\n|           Wolfsburg|           34|\n+--------------------+-------------+\nonly showing top 100 rows\n\nval \u001b[1m\u001b[34mhomeMatches\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [home_team: string, matches_count: bigint]\nval \u001b[1m\u001b[34mawayMatches\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [away_team: string, matches_count: bigint]\nval \u001b[1m\u001b[34mhomeMatchesRenamed\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [team: string, matches_count: bigint]\nval \u001b[1m\u001b[34mawayMatchesRenamed\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [team: string, matches_count: bigint]\nval \u001b[1m\u001b[34mtotalMatches\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [team: string, total_matches: bigint]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d976"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d977"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d978"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d979"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715714207334_22907267",
      "id": "paragraph_1715714207334_22907267",
      "dateCreated": "2024-05-14 19:16:47.334",
      "dateStarted": "2024-05-14 19:19:20.181",
      "dateFinished": "2024-05-14 19:19:21.822",
      "status": "FINISHED"
    },
    {
      "text": "totalMatches.show(totalMatches.count().toInt, false)",
      "user": "anonymous",
      "dateUpdated": "2024-05-14 19:21:47.083",
      "progress": 8,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+---------------------------+-------------+\n|team                       |total_matches|\n+---------------------------+-------------+\n|Barcelona                  |532          |\n|Paris Saint-Germain        |95           |\n|Manchester United          |79           |\n|Arsenal                    |76           |\n|Real Madrid                |71           |\n|Atlético Madrid            |68           |\n|Sevilla                    |66           |\n|Valencia                   |65           |\n|Athletic Club              |64           |\n|Espanyol                   |63           |\n|Aston Villa                |62           |\n|Villarreal                 |61           |\n|Getafe                     |61           |\n|Manchester City WFC        |59           |\n|Real Sociedad              |59           |\n|Real Betis                 |58           |\n|Brighton \u0026 Hove Albion WFC |57           |\n|Chelsea FCW                |57           |\n|Levante UD                 |57           |\n|Arsenal WFC                |57           |\n|West Ham United LFC        |56           |\n|Bristol City WFC           |56           |\n|Reading WFC                |56           |\n|Everton LFC                |55           |\n|Celta Vigo                 |54           |\n|RC Deportivo La Coruña     |53           |\n|Málaga                     |53           |\n|Birmingham City WFC        |53           |\n|Granada                    |50           |\n|Eibar                      |48           |\n|Rayo Vallecano             |47           |\n|Liverpool                  |44           |\n|Sporting Gijón             |44           |\n|Las Palmas                 |43           |\n|Juventus                   |43           |\n|Lille                      |42           |\n|Nantes                     |42           |\n|Marseille                  |42           |\n|OGC Nice                   |42           |\n|Rennes                     |42           |\n|Napoli                     |42           |\n|Montpellier                |41           |\n|Lyon                       |41           |\n|Stade de Reims             |41           |\n|Tottenham Hotspur          |41           |\n|AS Monaco                  |41           |\n|Chelsea                    |41           |\n|Lorient                    |41           |\n|Inter Milan                |40           |\n|Angers                     |40           |\n|Newcastle United           |40           |\n|Manchester City            |40           |\n|Southampton                |40           |\n|Leicester City             |40           |\n|Toulouse                   |40           |\n|AC Milan                   |40           |\n|Everton                    |40           |\n|Saint-Étienne              |39           |\n|Fiorentina                 |39           |\n|Troyes                     |39           |\n|Palermo                    |38           |\n|Carpi                      |38           |\n|Swansea City               |38           |\n|Hellas Verona              |38           |\n|Sunderland                 |38           |\n|Bologna                    |38           |\n|Lazio                      |38           |\n|Stoke City                 |38           |\n|Crystal Palace             |38           |\n|AFC Bournemouth            |38           |\n|Caen                       |38           |\n|Sassuolo                   |38           |\n|Genoa                      |38           |\n|Bordeaux                   |38           |\n|Guingamp                   |38           |\n|Chievo                     |38           |\n|Bayern Munich              |38           |\n|AS Roma                    |38           |\n|Norwich City               |38           |\n|Frosinone                  |38           |\n|West Bromwich Albion       |38           |\n|Torino                     |38           |\n|Empoli                     |38           |\n|Atalanta                   |38           |\n|Watford                    |38           |\n|West Ham United            |38           |\n|Sampdoria                  |38           |\n|Udinese                    |38           |\n|Bastia                     |37           |\n|Gazélec Ajaccio            |37           |\n|Tottenham Hotspur Women    |36           |\n|VfB Stuttgart              |35           |\n|Borussia Dortmund          |35           |\n|Schalke 04                 |34           |\n|Hannover 96                |34           |\n|Hoffenheim                 |34           |\n|Werder Bremen              |34           |\n|FC Köln                    |34           |\n|Darmstadt 98               |34           |\n|Wolfsburg                  |34           |\n|Hertha Berlin              |34           |\n|Hamburger SV               |34           |\n|Ingolstadt                 |34           |\n|Bayer Leverkusen           |34           |\n|Borussia Mönchengladbach   |34           |\n|Augsburg                   |34           |\n|FSV Mainz 05               |34           |\n|Eintracht Frankfurt        |34           |\n|Liverpool WFC              |33           |\n|Kerala Blasters            |23           |\n|Hyderabad                  |23           |\n|Jamshedpur                 |22           |\n|ATK Mohun Bagan            |22           |\n|Brazil                     |21           |\n|England                    |21           |\n|Odisha                     |20           |\n|NorthEast United           |20           |\n|East Bengal                |20           |\n|Goa                        |20           |\n|Chennaiyin                 |20           |\n|Mumbai City                |20           |\n|Osasuna                    |20           |\n|Bengaluru                  |20           |\n|England Women\u0027s            |20           |\n|Yeovil Town LFC            |19           |\n|France                     |19           |\n|Sweden Women\u0027s             |19           |\n|Croatia                    |18           |\n|Netherlands Women\u0027s        |16           |\n|Argentina                  |16           |\n|Belgium                    |16           |\n|France Women\u0027s             |15           |\n|Spain Women\u0027s              |15           |\n|Germany Women\u0027s            |14           |\n|Spain                      |14           |\n|Morocco                    |14           |\n|Netherlands                |14           |\n|Germany                    |13           |\n|Real Valladolid            |13           |\n|North Carolina Courage     |13           |\n|Racing Santander           |13           |\n|Denmark                    |13           |\n|Real Zaragoza              |13           |\n|Switzerland                |13           |\n|Portugal                   |13           |\n|Norway Women\u0027s             |12           |\n|Mallorca                   |12           |\n|Senegal                    |11           |\n|Sweden                     |11           |\n|Australia Women\u0027s          |11           |\n|United States Women\u0027s      |11           |\n|Deportivo Alavés           |11           |\n|Italy Women\u0027s              |11           |\n|Almería                    |11           |\n|Nigeria                    |10           |\n|Poland                     |10           |\n|Japan Women\u0027s              |9            |\n|Utah Royals                |9            |\n|Washington Spirit          |9            |\n|Uruguay                    |9            |\n|Tunisia                    |9            |\n|Russia                     |8            |\n|Leganés                    |8            |\n|Italy                      |8            |\n|Orlando Pride              |8            |\n|Mexico                     |8            |\n|Nigeria Women\u0027s            |8            |\n|Japan                      |8            |\n|Côte d\u0027Ivoire              |7            |\n|Switzerland Women\u0027s        |7            |\n|Chicago Red Stars          |7            |\n|Denmark Women\u0027s            |7            |\n|Congo DR                   |7            |\n|Wales                      |7            |\n|OL Reign                   |7            |\n|Portland Thorns            |7            |\n|South Korea                |7            |\n|NJ/NY Gotham FC            |7            |\n|China PR Women\u0027s           |7            |\n|South Africa Women\u0027s       |7            |\n|Australia                  |7            |\n|Cameroon                   |7            |\n|Jamaica Women\u0027s            |7            |\n|Egypt                      |7            |\n|Canada Women\u0027s             |7            |\n|South Africa               |7            |\n|Brazil Women\u0027s             |7            |\n|Argentina Women\u0027s          |6            |\n|New Zealand Women\u0027s        |6            |\n|Ghana                      |6            |\n|Inter Miami                |6            |\n|Iran                       |6            |\n|Portugal Women\u0027s           |6            |\n|Saudi Arabia               |6            |\n|Costa Rica                 |6            |\n|Serbia                     |6            |\n|Korea Republic Women\u0027s     |6            |\n|Angola                     |5            |\n|Ukraine                    |5            |\n|Guinea                     |5            |\n|Houston Dash               |5            |\n|Cape Verde Islands         |5            |\n|Czech Republic             |5            |\n|Colombia Women\u0027s           |5            |\n|Recreativo Huelva          |5            |\n|Mali                       |5            |\n|Cameroon Women\u0027s           |4            |\n|Equatorial Guinea          |4            |\n|Peru                       |4            |\n|United States              |4            |\n|Elche                      |4            |\n|Mauritania                 |4            |\n|Austria Women\u0027s            |4            |\n|Belgium Women\u0027s            |4            |\n|Namibia                    |4            |\n|Girona                     |4            |\n|Austria                    |4            |\n|Burkina Faso               |4            |\n|Morocco Women\u0027s            |4            |\n|Colombia                   |4            |\n|Turkey                     |3            |\n|Zambia Women\u0027s             |3            |\n|Ajax                       |3            |\n|Algeria                    |3            |\n|Slovakia                   |3            |\n|Ecuador                    |3            |\n|Qatar                      |3            |\n|Finland                    |3            |\n|Chile Women\u0027s              |3            |\n|Clermont Foot              |3            |\n|Haiti Women\u0027s              |3            |\n|Lens                       |3            |\n|Vietnam Women\u0027s            |3            |\n|Philippines Women\u0027s        |3            |\n|Panama                     |3            |\n|WNT Finland                |3            |\n|Iceland                    |3            |\n|Panama Women\u0027s             |3            |\n|Scotland Women\u0027s           |3            |\n|Republic of Ireland Women\u0027s|3            |\n|Costa Rica Women\u0027s         |3            |\n|Zambia                     |3            |\n|Canada                     |3            |\n|North Macedonia            |3            |\n|Mozambique                 |3            |\n|Gambia                     |3            |\n|Thailand Women\u0027s           |3            |\n|Huesca                     |3            |\n|Tanzania                   |3            |\n|Cádiz                      |3            |\n|Guinea-Bissau              |3            |\n|Scotland                   |3            |\n|Northern Ireland           |3            |\n|Hungary                    |3            |\n|Iceland Women\u0027s            |3            |\n|AC Ajaccio                 |2            |\n|Birmingham City            |2            |\n|Bolton Wanderers           |2            |\n|Leeds United               |2            |\n|Xerez                      |2            |\n|Tenerife                   |2            |\n|Boca Juniors               |2            |\n|Auxerre                    |2            |\n|Stade Brestois             |2            |\n|Fulham                     |2            |\n|Hércules                   |2            |\n|Albacete                   |2            |\n|German DR                  |2            |\n|River Plate                |2            |\n|CD Numancia de Soria       |2            |\n|Strasbourg                 |2            |\n|Wolverhampton Wanderers    |2            |\n|Blackburn Rovers           |2            |\n|Portsmouth                 |2            |\n|Charlton Athletic          |2            |\n|Córdoba CF                 |2            |\n|Middlesbrough              |2            |\n|Real Murcia CF             |1            |\n|LAFC                       |1            |\n|Argentina U20              |1            |\n|NY Cosmos                  |1            |\n|Gimnàstic Tarragona        |1            |\n|Charlotte                  |1            |\n|New York Red Bulls         |1            |\n|Toronto FC                 |1            |\n|Panathinaikos              |1            |\n|Seattle Sounders           |1            |\n|Nashville SC               |1            |\n|Czechoslovakia             |1            |\n|Metz                       |1            |\n|FC Porto                   |1            |\n|Soviet Union U20           |1            |\n|Cincinnati                 |1            |\n|Romania                    |1            |\n+---------------------------+-------------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d980"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d981"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d982"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d983"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d984"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d985"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d986"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d987"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d988"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715712935390_488590743",
      "id": "paragraph_1715712935390_488590743",
      "dateCreated": "2024-05-14 18:55:35.390",
      "dateStarted": "2024-05-14 19:21:47.101",
      "dateFinished": "2024-05-14 19:21:50.373",
      "status": "FINISHED"
    },
    {
      "text": "%md\n\n## Show the number of teams in all dataset",
      "user": "anonymous",
      "dateUpdated": "2024-05-14 19:23:40.947",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch2\u003eShow the number of teams in all dataset\u003c/h2\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715714600577_1539139755",
      "id": "paragraph_1715714600577_1539139755",
      "dateCreated": "2024-05-14 19:23:20.577",
      "dateStarted": "2024-05-14 19:23:40.947",
      "dateFinished": "2024-05-14 19:23:40.954",
      "status": "FINISHED"
    },
    {
      "text": "totalMatches.select(\"team\").count()",
      "user": "anonymous",
      "dateUpdated": "2024-05-14 19:22:32.229",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "val \u001b[1m\u001b[34mres24\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m \u003d 294\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d989"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d990"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d991"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d992"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d993"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715714507100_2048034654",
      "id": "paragraph_1715714507100_2048034654",
      "dateCreated": "2024-05-14 19:21:47.101",
      "dateStarted": "2024-05-14 19:22:32.240",
      "dateFinished": "2024-05-14 19:22:33.711",
      "status": "FINISHED"
    },
    {
      "text": "%md\n# Create the features",
      "user": "anonymous",
      "dateUpdated": "2024-05-14 19:29:13.303",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eCreate the features\u003c/h1\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715714932467_1289973490",
      "id": "paragraph_1715714932467_1289973490",
      "dateCreated": "2024-05-14 19:28:52.467",
      "dateStarted": "2024-05-14 19:29:13.303",
      "dateFinished": "2024-05-14 19:29:13.313",
      "status": "FINISHED"
    },
    {
      "text": "val orderedMatchesDf \u003d matchesDf.orderBy(\"match_date\")\norderedMatchesDf.show()",
      "user": "anonymous",
      "dateUpdated": "2024-05-18 11:44:54.649",
      "progress": 45,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+--------------------+---------+-----------+------------+----------------+------------+----------+----------+----------+\n|match_id|    competition_name|     year|  home_team|home_team_id|       away_team|away_team_id|home_score|away_score|match_date|\n+--------+--------------------+---------+-----------+------------+----------------+------------+----------+----------+----------+\n| 3888704|      FIFA World Cup|     1958|     Brazil|         781|          France|         771|         5|         2|1958-06-24|\n| 3888705|      FIFA World Cup|     1958|     Brazil|         781|          Sweden|         790|         5|         2|1958-06-29|\n| 3888854|      FIFA World Cup|     1962|     Brazil|         781|          Mexico|         794|         2|         0|1962-05-30|\n| 3888699|      FIFA World Cup|     1970|     Brazil|         781|  Czechoslovakia|       17469|         4|         1|1970-06-04|\n| 3888700|      FIFA World Cup|     1970|     Brazil|         781|         England|         768|         1|         0|1970-06-07|\n| 3889217|      FIFA World Cup|     1970|     Brazil|         781|         Romania|         905|         3|         2|1970-06-10|\n| 3889218|      FIFA World Cup|     1970|     Brazil|         781|            Peru|         784|         4|         2|1970-06-14|\n| 3888701|      FIFA World Cup|     1970|     Brazil|         781|         Uruguay|         783|         3|         1|1970-06-18|\n| 3888702|      FIFA World Cup|     1970|     Brazil|         781|           Italy|         914|         4|         1|1970-06-21|\n| 3888711|    Champions League|1970/1971|       Ajax|         806|   Panathinaikos|         952|         2|         0|1971-06-02|\n| 3750235|    Champions League|1971/1972|       Ajax|         806|     Inter Milan|         238|         2|         0|1972-05-31|\n| 3888706|    Champions League|1972/1973|       Ajax|         806|        Juventus|         224|         1|         0|1973-05-30|\n| 3888713|             La Liga|1973/1974|Real Madrid|         220|       Barcelona|         217|         0|         5|1974-02-17|\n| 3888716|      FIFA World Cup|     1974|Netherlands|         941|          Sweden|         790|         0|         0|1974-06-19|\n| 3750180|      FIFA World Cup|     1974|  German DR|        2721|         Germany|         770|         1|         0|1974-06-22|\n| 3888717|      FIFA World Cup|     1974|Netherlands|         941|       Argentina|         779|         4|         0|1974-06-26|\n| 3888718|      FIFA World Cup|     1974|  German DR|        2721|     Netherlands|         941|         0|         2|1974-06-30|\n| 3888719|      FIFA World Cup|     1974|Netherlands|         941|          Brazil|         781|         2|         0|1974-07-03|\n| 3888720|      FIFA World Cup|     1974|Netherlands|         941|         Germany|         770|         1|         2|1974-07-07|\n| 3750234|North American Le...|     1977|  NY Cosmos|        2735|Seattle Sounders|         488|         2|         1|1977-08-28|\n+--------+--------------------+---------+-----------+------------+----------------+------------+----------+----------+----------+\nonly showing top 20 rows\n\nval \u001b[1m\u001b[34morderedMatchesDf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m \u003d [match_id: bigint, competition_name: string ... 8 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d674"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715714552240_2128002507",
      "id": "paragraph_1715714552240_2128002507",
      "dateCreated": "2024-05-14 19:22:32.240",
      "dateStarted": "2024-05-18 11:44:54.676",
      "dateFinished": "2024-05-18 11:44:57.969",
      "status": "FINISHED"
    },
    {
      "text": "%md\n\n# Load only one match event and the corresponding line in the dataframe",
      "user": "anonymous",
      "dateUpdated": "2024-05-17 08:20:09.148",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eLoad only one match event and the corresponding line in the dataframe\u003c/h1\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715933975299_1128675364",
      "id": "paragraph_1715933975299_1128675364",
      "dateCreated": "2024-05-17 08:19:35.309",
      "dateStarted": "2024-05-17 08:20:09.151",
      "dateFinished": "2024-05-17 08:20:09.227",
      "status": "FINISHED"
    },
    {
      "text": "import org.apache.spark.sql.SparkSession\r\n\r\nval spark \u003d SparkSession.builder.appName(\"MatchLoader\").getOrCreate()\r\nval matchIdToLoad \u003d \"7298\"\r\n\r\nval jsonFilePath \u003d s\"./data/events/$matchIdToLoad.json\"\r\nval matchDf \u003d spark.read.option(\"multiLine\", true).json(jsonFilePath)\r\n//val filteredDf \u003d orderedMatchesDf.filter($\"match_id\" \u003d\u003d\u003d matchIdToLoad)",
      "user": "anonymous",
      "dateUpdated": "2024-05-18 13:58:09.193",
      "progress": 45,
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {}
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[33mwarning: \u001b[0m1 deprecation (since 2.13.3); for details, enable `:setting -deprecation` or `:replay -deprecation`\nimport org.apache.spark.sql.SparkSession\nval \u001b[1m\u001b[34mspark\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.SparkSession\u001b[0m \u003d org.apache.spark.sql.SparkSession@58eeab74\nval \u001b[1m\u001b[34mmatchIdToLoad\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d 7298\nval \u001b[1m\u001b[34mjsonFilePath\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m \u003d ./data/events/7298.json\nval \u001b[1m\u001b[34mmatchDf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [bad_behaviour: struct\u003ccard: struct\u003cid: bigint, name: string\u003e\u003e, ball_receipt: struct\u003coutcome: struct\u003cid: bigint, name: string\u003e\u003e ... 32 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d1765"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715714974914_824221180",
      "id": "paragraph_1715714974914_824221180",
      "dateCreated": "2024-05-14 19:29:34.915",
      "dateStarted": "2024-05-18 13:58:09.204",
      "dateFinished": "2024-05-18 13:58:09.402",
      "status": "FINISHED"
    },
    {
      "text": "orderedMatchesDf.show()",
      "user": "anonymous",
      "dateUpdated": "2024-05-18 13:20:45.735",
      "progress": 54,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+--------+--------------------+---------+-----------+------------+----------------+------------+----------+----------+----------+\n|match_id|    competition_name|     year|  home_team|home_team_id|       away_team|away_team_id|home_score|away_score|match_date|\n+--------+--------------------+---------+-----------+------------+----------------+------------+----------+----------+----------+\n| 3888704|      FIFA World Cup|     1958|     Brazil|         781|          France|         771|         5|         2|1958-06-24|\n| 3888705|      FIFA World Cup|     1958|     Brazil|         781|          Sweden|         790|         5|         2|1958-06-29|\n| 3888854|      FIFA World Cup|     1962|     Brazil|         781|          Mexico|         794|         2|         0|1962-05-30|\n| 3888699|      FIFA World Cup|     1970|     Brazil|         781|  Czechoslovakia|       17469|         4|         1|1970-06-04|\n| 3888700|      FIFA World Cup|     1970|     Brazil|         781|         England|         768|         1|         0|1970-06-07|\n| 3889217|      FIFA World Cup|     1970|     Brazil|         781|         Romania|         905|         3|         2|1970-06-10|\n| 3889218|      FIFA World Cup|     1970|     Brazil|         781|            Peru|         784|         4|         2|1970-06-14|\n| 3888701|      FIFA World Cup|     1970|     Brazil|         781|         Uruguay|         783|         3|         1|1970-06-18|\n| 3888702|      FIFA World Cup|     1970|     Brazil|         781|           Italy|         914|         4|         1|1970-06-21|\n| 3888711|    Champions League|1970/1971|       Ajax|         806|   Panathinaikos|         952|         2|         0|1971-06-02|\n| 3750235|    Champions League|1971/1972|       Ajax|         806|     Inter Milan|         238|         2|         0|1972-05-31|\n| 3888706|    Champions League|1972/1973|       Ajax|         806|        Juventus|         224|         1|         0|1973-05-30|\n| 3888713|             La Liga|1973/1974|Real Madrid|         220|       Barcelona|         217|         0|         5|1974-02-17|\n| 3888716|      FIFA World Cup|     1974|Netherlands|         941|          Sweden|         790|         0|         0|1974-06-19|\n| 3750180|      FIFA World Cup|     1974|  German DR|        2721|         Germany|         770|         1|         0|1974-06-22|\n| 3888717|      FIFA World Cup|     1974|Netherlands|         941|       Argentina|         779|         4|         0|1974-06-26|\n| 3888718|      FIFA World Cup|     1974|  German DR|        2721|     Netherlands|         941|         0|         2|1974-06-30|\n| 3888719|      FIFA World Cup|     1974|Netherlands|         941|          Brazil|         781|         2|         0|1974-07-03|\n| 3888720|      FIFA World Cup|     1974|Netherlands|         941|         Germany|         770|         1|         2|1974-07-07|\n| 3750234|North American Le...|     1977|  NY Cosmos|        2735|Seattle Sounders|         488|         2|         1|1977-08-28|\n+--------+--------------------+---------+-----------+------------+----------------+------------+----------+----------+----------+\nonly showing top 20 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d1061"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715938225332_1972557942",
      "id": "paragraph_1715938225332_1972557942",
      "dateCreated": "2024-05-17 09:30:25.332",
      "dateStarted": "2024-05-18 13:20:45.748",
      "dateFinished": "2024-05-18 13:20:47.503",
      "status": "FINISHED"
    },
    {
      "text": "import org.apache.spark.sql.{SparkSession, DataFrame}\r\nimport org.apache.spark.sql.functions._\r\nimport org.apache.spark.sql.expressions.Window\r\n\r\nval startTime \u003d System.nanoTime()\r\n\r\nval spark \u003d SparkSession.builder\r\n  .appName(\"Soccer Match Analysis\")\r\n  .getOrCreate()\r\n\r\n\r\nval updatedDf \u003d matchDf.select(\r\n  col(\"*\"),\r\n  when(col(\"type.name\") \u003d\u003d\u003d \"Pass\", 1).otherwise(0).alias(\"Pass_feature\"),\r\n  when(col(\"type.name\") \u003d\u003d\u003d \"Shot\", 1).otherwise(0).alias(\"Shot_feature\"),\r\n  when(col(\"type.name\") \u003d\u003d\u003d \"Foul Won\", 1).otherwise(0).alias(\"Foul_won_feature\"),\r\n  when(col(\"type.name\") \u003d\u003d\u003d \"Foul Committed\", 1).otherwise(0).alias(\"Foul_committed_feature\"),\r\n  when(col(\"type.name\") \u003d\u003d\u003d \"Bad Behaviour\" \u0026\u0026 col(\"bad_behaviour.card.name\") \u003d\u003d\u003d \"Yellow Card\", 1).otherwise(0).alias(\"Bad_Behaviour_Yellow_Card_feature\"),\r\n  when(col(\"type.name\") \u003d\u003d\u003d \"Bad Behaviour\" \u0026\u0026 col(\"bad_behaviour.card.name\") \u003d\u003d\u003d \"Second Yellow\", 1).otherwise(0).alias(\"Bad_Behaviour_Second_Yellow_feature\"),\r\n  when(col(\"type.name\") \u003d\u003d\u003d \"Bad Behaviour\" \u0026\u0026 col(\"bad_behaviour.card.name\").isin(\"Red Card\", \"Second Yellow\"), 1).otherwise(0).alias(\"Bad_Behaviour_Red_Card_feature\"),\r\n  when(col(\"type.name\") \u003d\u003d\u003d \"Goal Keeper\" \u0026\u0026 col(\"goalkeeper.type.name\") \u003d\u003d\u003d \"Penalty Saved\", 1).otherwise(0).alias(\"Goalkeeper_Penalty_Saved_feature\"),\r\n  when(col(\"type.name\") \u003d\u003d\u003d \"Goal Keeper\" \u0026\u0026 col(\"goalkeeper.type.name\") \u003d\u003d\u003d \"Punch\", 1).otherwise(0).alias(\"Goalkeeper_Punch_feature\"),\r\n  when(col(\"type.name\") \u003d\u003d\u003d \"Goal Keeper\" \u0026\u0026 col(\"goalkeeper.type.name\") \u003d\u003d\u003d \"Save\", 1).otherwise(0).alias(\"Goalkeeper_Save_feature\"),\r\n  when(col(\"type.name\") \u003d\u003d\u003d \"Goal Keeper\" \u0026\u0026 col(\"goalkeeper.type.name\") \u003d\u003d\u003d \"Shot Saved\", 1).otherwise(0).alias(\"Goalkeeper_Shot_Saved_feature\"),\r\n  when(col(\"type.name\") \u003d\u003d\u003d \"Goal Keeper\" \u0026\u0026 col(\"goalkeeper.type.name\") \u003d\u003d\u003d \"Smother\", 1).otherwise(0).alias(\"Goalkeeper_Smother_feature\"),\r\n  when(col(\"type.name\") \u003d\u003d\u003d \"Goal Keeper\" \u0026\u0026 col(\"goalkeeper.type.name\") \u003d\u003d\u003d \"Shot Saved To Post\", 1).otherwise(0).alias(\"Goalkeeper_Shot_Saved_To_Post_feature\")\r\n)\r\n\r\nval aggregatedDf \u003dupdatedDf.groupBy(\"possession_team.name\").agg(\r\n  sum(\"Pass_feature\").alias(\"Pass\"),\r\n  sum(\"Shot_feature\").alias(\"Shot\"),\r\n  sum(\"Foul_won_feature\").alias(\"Foul won\"),\r\n  sum(\"Foul_committed_feature\").alias(\"Foul committed\"),\r\n  sum(\"Bad_Behaviour_Yellow_Card_feature\").alias(\"Bad Behaviour - Yellow Card\"),\r\n  sum(\"Bad_Behaviour_Second_Yellow_feature\").alias(\"Bad Behaviour - Second Yellow\"),\r\n  sum(\"Bad_Behaviour_Red_Card_feature\").alias(\"Bad Behaviour - Red Card\"),\r\n  sum(\"Goalkeeper_Penalty_Saved_feature\").alias(\"Goalkeeper - Penalty Saved\"),\r\n  sum(\"Goalkeeper_Punch_feature\").alias(\"Goalkeeper - Punch\"),\r\n  sum(\"Goalkeeper_Save_feature\").alias(\"Goalkeeper - Save\"),\r\n  sum(\"Goalkeeper_Shot_Saved_feature\").alias(\"Goalkeeper - Shot Saved\"),\r\n  sum(\"Goalkeeper_Smother_feature\").alias(\"Goalkeeper - Smother\"),\r\n  sum(\"Goalkeeper_Shot_Saved_To_Post_feature\").alias(\"Goalkeeper - Shot Saved To Post\")\r\n)\r\n\r\nval team1 \u003d aggregatedDf.withColumnRenamed(\"possession_team.name\", \"team1\")\r\n  .withColumnRenamed(\"Pass\", \"Pass_team1\")\r\n  .withColumnRenamed(\"Shot\", \"Shot_team1\")\r\n  .withColumnRenamed(\"Foul won\", \"Foul_won_team1\")\r\n  .withColumnRenamed(\"Foul committed\", \"Foul_committed_team1\")\r\n  .withColumnRenamed(\"Bad Behaviour - Yellow Card\", \"Bad_Behaviour_Yellow_Card_team1\")\r\n  .withColumnRenamed(\"Bad Behaviour - Second Yellow\", \"Bad_Behaviour_Second_Yellow_team1\")\r\n  .withColumnRenamed(\"Bad Behaviour - Red Card\", \"Bad_Behaviour_Red_Card_team1\")\r\n  .withColumnRenamed(\"Goalkeeper - Penalty Saved\", \"Goalkeeper_Penalty_Saved_team1\")\r\n  .withColumnRenamed(\"Goalkeeper - Punch\", \"Goalkeeper_Punch_team1\")\r\n  .withColumnRenamed(\"Goalkeeper - Save\", \"Goalkeeper_Save_team1\")\r\n  .withColumnRenamed(\"Goalkeeper - Shot Saved\", \"Goalkeeper_Shot_Saved_team1\")\r\n  .withColumnRenamed(\"Goalkeeper - Smother\", \"Goalkeeper_Smother_team1\")\r\n  .withColumnRenamed(\"Goalkeeper - Shot Saved To Post\", \"Goalkeeper_Shot_Saved_To_Post_team1\")\r\n\r\nval team2 \u003d aggregatedDf.withColumnRenamed(\"possession_team.name\", \"team2\")\r\n  .withColumnRenamed(\"Pass\", \"Pass_team2\")\r\n  .withColumnRenamed(\"Shot\", \"Shot_team2\")\r\n  .withColumnRenamed(\"Foul won\", \"Foul_won_team2\")\r\n  .withColumnRenamed(\"Foul committed\", \"Foul_committed_team2\")\r\n  .withColumnRenamed(\"Bad Behaviour - Yellow Card\", \"Bad_Behaviour_Yellow_Card_team2\")\r\n  .withColumnRenamed(\"Bad Behaviour - Second Yellow\", \"Bad_Behaviour_Second_Yellow_team2\")\r\n  .withColumnRenamed(\"Bad Behaviour - Red Card\", \"Bad_Behaviour_Red_Card_team2\")\r\n  .withColumnRenamed(\"Goalkeeper - Penalty Saved\", \"Goalkeeper_Penalty_Saved_team2\")\r\n  .withColumnRenamed(\"Goalkeeper - Punch\", \"Goalkeeper_Punch_team2\")\r\n  .withColumnRenamed(\"Goalkeeper - Save\", \"Goalkeeper_Save_team2\")\r\n  .withColumnRenamed(\"Goalkeeper - Shot Saved\", \"Goalkeeper_Shot_Saved_team2\")\r\n  .withColumnRenamed(\"Goalkeeper - Smother\", \"Goalkeeper_Smother_team2\")\r\n  .withColumnRenamed(\"Goalkeeper - Shot Saved To Post\", \"Goalkeeper_Shot_Saved_To_Post_team2\")\r\n\r\n// Create a self-join to combine team pairs\r\nval joinedDf \u003d aggregatedDf.as(\"df1\")\r\n  .crossJoin(aggregatedDf.as(\"df2\"))\r\n  .filter(col(\"df1.name\") \u003c col(\"df2.name\"))\r\n\r\n// Merge feature vectors for both teams in each match\r\nval finalDf \u003d joinedDf.select(\r\n  concat_ws(\" vs \", col(\"df1.name\"), col(\"df2.name\")).alias(\"match_teams\"),\r\n  col(\"df1.Pass\").alias(\"Pass_team1\"),\r\n  col(\"df2.Pass\").alias(\"Pass_team2\"),\r\n  col(\"df1.Shot\").alias(\"Shot_team1\"),\r\n  col(\"df2.Shot\").alias(\"Shot_team2\"),\r\n  col(\"df1.Foul won\").alias(\"Foul_won_team1\"),\r\n  col(\"df2.Foul won\").alias(\"Foul_won_team2\"),\r\n  col(\"df1.Foul committed\").alias(\"Foul_committed_team1\"),\r\n  col(\"df2.Foul committed\").alias(\"Foul_committed_team2\"),\r\n  col(\"df1.Bad Behaviour - Yellow Card\").alias(\"Bad_Behaviour_Yellow_Card_team1\"),\r\n  col(\"df2.Bad Behaviour - Yellow Card\").alias(\"Bad_Behaviour_Yellow_Card_team2\"),\r\n  (col(\"df1.Bad Behaviour - Red Card\") + col(\"df1.Bad Behaviour - Second Yellow\")).alias(\"total_red_cards_team1\"),\r\n  (col(\"df2.Bad Behaviour - Red Card\") + col(\"df2.Bad Behaviour - Second Yellow\")).alias(\"total_red_cards_team2\"),\r\n  (col(\"df1.Goalkeeper - Penalty Saved\") +\r\n    col(\"df1.Goalkeeper - Punch\") +\r\n    col(\"df1.Goalkeeper - Save\") +\r\n    col(\"df1.Goalkeeper - Shot Saved\") +\r\n    col(\"df1.Goalkeeper - Smother\") +\r\n    col(\"df1.Goalkeeper - Shot Saved To Post\")).alias(\"total_actions_team1\"),\r\n  (col(\"df2.Goalkeeper - Penalty Saved\") +\r\n    col(\"df2.Goalkeeper - Punch\") +\r\n    col(\"df2.Goalkeeper - Save\") +\r\n    col(\"df2.Goalkeeper - Shot Saved\") +\r\n    col(\"df2.Goalkeeper - Smother\") +\r\n    col(\"df2.Goalkeeper - Shot Saved To Post\")).alias(\"total_actions_team2\")\r\n)\r\nfinalDf.show()\r\n// End timing\r\nval endTime \u003d System.nanoTime()\r\nval duration \u003d (endTime - startTime) / 1e9d\r\nprintln(s\"Time taken: $duration seconds\")\r\n",
      "user": "anonymous",
      "dateUpdated": "2024-05-18 13:58:12.122",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[33mwarning: \u001b[0m1 deprecation (since 2.13.3); for details, enable `:setting -deprecation` or `:replay -deprecation`\n+--------------------+----------+----------+----------+----------+--------------+--------------+--------------------+--------------------+-------------------------------+-------------------------------+---------------------+---------------------+-------------------+-------------------+\n|         match_teams|Pass_team1|Pass_team2|Shot_team1|Shot_team2|Foul_won_team1|Foul_won_team2|Foul_committed_team1|Foul_committed_team2|Bad_Behaviour_Yellow_Card_team1|Bad_Behaviour_Yellow_Card_team2|total_red_cards_team1|total_red_cards_team2|total_actions_team1|total_actions_team2|\n+--------------------+----------+----------+----------+----------+--------------+--------------+--------------------+--------------------+-------------------------------+-------------------------------+---------------------+---------------------+-------------------+-------------------+\n|Chelsea FCW vs Ma...|       494|       506|        25|         9|             7|             6|                   7|                   6|                              1|                              0|                    0|                    0|                  4|                  5|\n+--------------------+----------+----------+----------+----------+--------------+--------------+--------------------+--------------------+-------------------------------+-------------------------------+---------------------+---------------------+-------------------+-------------------+\n\nTime taken: 0.246296017 seconds\nimport org.apache.spark.sql.{SparkSession, DataFrame}\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.expressions.Window\nval \u001b[1m\u001b[34mstartTime\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m \u003d 13633517178578\nval \u001b[1m\u001b[34mspark\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.SparkSession\u001b[0m \u003d org.apache.spark.sql.SparkSession@58eeab74\nval \u001b[1m\u001b[34mupdatedDf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [bad_behaviour: struct\u003ccard: struct\u003cid: bigint, name: string\u003e\u003e, ball_receipt: struct\u003coutcome: struct\u003cid: bigint, name: string\u003e\u003e ... 45 more fields]\nval \u001b[1m\u001b[34maggregatedDf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [name: string, Pass: bigint ... 12 more fields]\nval \u001b[1m\u001b[34mteam1\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m \u003d [name: string, Pass_team1: bigint ... 12 more fields]\nval \u001b[...\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d1766"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d1767"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d1768"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715934400736_1925714121",
      "id": "paragraph_1715934400736_1925714121",
      "dateCreated": "2024-05-17 08:26:40.738",
      "dateStarted": "2024-05-18 13:58:12.134",
      "dateFinished": "2024-05-18 13:58:12.500",
      "status": "FINISHED"
    },
    {
      "text": "%md\n\n# Portion of events",
      "user": "anonymous",
      "dateUpdated": "2024-05-18 14:34:07.796",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003ePortion of events\u003c/h1\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1716040769428_904321019",
      "id": "paragraph_1716040769428_904321019",
      "dateCreated": "2024-05-18 13:59:29.431",
      "dateStarted": "2024-05-18 14:34:07.797",
      "dateFinished": "2024-05-18 14:34:07.872",
      "status": "FINISHED"
    },
    {
      "text": "import org.apache.spark.sql.SparkSession\r\nimport org.apache.spark.sql.functions._\r\nimport org.apache.spark.sql.types._\r\nimport org.apache.hadoop.fs.{FileSystem, Path}\r\n\r\n\r\nval spark \u003d SparkSession.builder.appName(\"Soccer Match Analysis\").getOrCreate()\r\nval sc \u003d spark.sparkContext\r\nval hadoopConf \u003d sc.hadoopConfiguration\r\nval fs \u003d FileSystem.get(hadoopConf)\r\n\r\nval jsonDirectory \u003d \"./data/events\"\r\nval fileStatus \u003d fs.listStatus(new Path(jsonDirectory))\r\nval files \u003d fileStatus.map(_.getPath.toString).sorted.take(50)\r\n\r\nval allMatchesDf \u003d spark.read.option(\"multiLine\", true).json(files: _*)\r\n\r\nval filePathColumn \u003d input_file_name()\r\nval matchIdDf \u003d allMatchesDf.withColumn(\"match_id\", regexp_extract(filePathColumn, \"\"\"(\\d+)\\.json$\"\"\", 1))\r\n\r\nval startTime \u003d System.nanoTime()\r\n\r\n// Feature columns\r\nval featureColumns2 \u003d Seq(\r\n  (\"type.name\", \"Pass\", \"Pass_feature\"),\r\n  (\"type.name\", \"Shot\", \"Shot_feature\"),\r\n  (\"type.name\", \"Foul Won\", \"Foul_won_feature\"),\r\n  (\"type.name\", \"Foul Committed\", \"Foul_committed_feature\")\r\n)\r\n\r\nval featureColumns3 \u003d Seq(\r\n  (\"type.name\", \"Bad Behaviour\", \"bad_behaviour.card.name\", \"Yellow Card\", \"Bad_Behaviour_Yellow_Card_feature\"),\r\n  (\"type.name\", \"Bad Behaviour\", \"bad_behaviour.card.name\", \"Second Yellow\", \"Bad_Behaviour_Second_Yellow_feature\"),\r\n  (\"type.name\", \"Goal Keeper\", \"goalkeeper.type.name\", \"Penalty Saved\", \"Goalkeeper_Penalty_Saved_feature\"),\r\n  (\"type.name\", \"Goal Keeper\", \"goalkeeper.type.name\", \"Punch\", \"Goalkeeper_Punch_feature\"),\r\n  (\"type.name\", \"Goal Keeper\", \"goalkeeper.type.name\", \"Save\", \"Goalkeeper_Save_feature\"),\r\n  (\"type.name\", \"Goal Keeper\", \"goalkeeper.type.name\", \"Shot Saved\", \"Goalkeeper_Shot_Saved_feature\"),\r\n  (\"type.name\", \"Goal Keeper\", \"goalkeeper.type.name\", \"Smother\", \"Goalkeeper_Smother_feature\"),\r\n  (\"type.name\", \"Goal Keeper\", \"goalkeeper.type.name\", \"Shot Saved To Post\", \"Goalkeeper_Shot_Saved_To_Post_feature\")\r\n)\r\n\r\nval featureColumnsSeq \u003d Seq(\r\n  (\"type.name\", \"Bad Behaviour\", \"bad_behaviour.card.name\", Seq(\"Red Card\", \"Second Yellow\"), \"Bad_Behaviour_Red_Card_feature\")\r\n)\r\n\r\n// Create feature columns dynamically\r\nval updatedDf2 \u003d featureColumns2.foldLeft(matchIdDf)((df, colInfo) \u003d\u003e {\r\n  val (col1, col2, newCol) \u003d colInfo\r\n  df.withColumn(newCol, when(col(col1) \u003d\u003d\u003d col2, 1).otherwise(0))\r\n})\r\n\r\nval updatedDf3 \u003d featureColumns3.foldLeft(updatedDf2)((df, colInfo) \u003d\u003e {\r\n  val (col1, col2, col3, col4, newCol) \u003d colInfo\r\n  df.withColumn(newCol, when(col(col1) \u003d\u003d\u003d col2 \u0026\u0026 col(col3) \u003d\u003d\u003d col4, 1).otherwise(0))\r\n})\r\n\r\nval updatedDfSeq \u003d featureColumnsSeq.foldLeft(updatedDf3)((df, colInfo) \u003d\u003e {\r\n  val (col1, col2, col3, col4, newCol) \u003d colInfo\r\n  df.withColumn(newCol, when(col(col1) \u003d\u003d\u003d col2 \u0026\u0026 col(col3).isin(col4: _*), 1).otherwise(0))\r\n})\r\n\r\nval aggregatedDf \u003d updatedDfSeq.groupBy(\"match_id\", \"possession_team.name\").agg(\r\n  sum(\"Pass_feature\").alias(\"Pass\"),\r\n  sum(\"Shot_feature\").alias(\"Shot\"),\r\n  sum(\"Foul_won_feature\").alias(\"Foul_won\"),\r\n  sum(\"Foul_committed_feature\").alias(\"Foul_committed\"),\r\n  sum(\"Bad_Behaviour_Yellow_Card_feature\").alias(\"Bad_Behaviour_Yellow_Card\"),\r\n  sum(\"Bad_Behaviour_Second_Yellow_feature\").alias(\"Bad_Behaviour_Second_Yellow\"),\r\n  sum(\"Bad_Behaviour_Red_Card_feature\").alias(\"Bad_Behaviour_Red_Card\"),\r\n  sum(\"Goalkeeper_Penalty_Saved_feature\").alias(\"Goalkeeper_Penalty_Saved\"),\r\n  sum(\"Goalkeeper_Punch_feature\").alias(\"Goalkeeper_Punch\"),\r\n  sum(\"Goalkeeper_Save_feature\").alias(\"Goalkeeper_Save\"),\r\n  sum(\"Goalkeeper_Shot_Saved_feature\").alias(\"Goalkeeper_Shot_Saved\"),\r\n  sum(\"Goalkeeper_Smother_feature\").alias(\"Goalkeeper_Smother\"),\r\n  sum(\"Goalkeeper_Shot_Saved_To_Post_feature\").alias(\"Goalkeeper_Shot_Saved_To_Post\")\r\n)\r\n\r\n// Create self-join to combine team pairs\r\nval joinedDf \u003d aggregatedDf.as(\"df1\")\r\n  .join(aggregatedDf.as(\"df2\"), col(\"df1.match_id\") \u003d\u003d\u003d col(\"df2.match_id\") \u0026\u0026 col(\"df1.name\") \u003c col(\"df2.name\"))\r\n  .select(\r\n    col(\"df1.match_id\"),\r\n    concat_ws(\" vs \", col(\"df1.name\"), col(\"df2.name\")).alias(\"match_teams\"),\r\n    col(\"df1.Pass\").alias(\"Pass_team1\"),\r\n    col(\"df2.Pass\").alias(\"Pass_team2\"),\r\n    col(\"df1.Shot\").alias(\"Shot_team1\"),\r\n    col(\"df2.Shot\").alias(\"Shot_team2\"),\r\n    col(\"df1.Foul_won\").alias(\"Foul_won_team1\"),\r\n    col(\"df2.Foul_won\").alias(\"Foul_won_team2\"),\r\n    col(\"df1.Foul_committed\").alias(\"Foul_committed_team1\"),\r\n    col(\"df2.Foul_committed\").alias(\"Foul_committed_team2\"),\r\n    col(\"df1.Bad_Behaviour_Yellow_Card\").alias(\"Bad_Behaviour_Yellow_Card_team1\"),\r\n    col(\"df2.Bad_Behaviour_Yellow_Card\").alias(\"Bad_Behaviour_Yellow_Card_team2\"),\r\n    (col(\"df1.Bad_Behaviour_Red_Card\") + col(\"df1.Bad_Behaviour_Second_Yellow\")).alias(\"total_red_cards_team1\"),\r\n    (col(\"df2.Bad_Behaviour_Red_Card\") + col(\"df2.Bad_Behaviour_Second_Yellow\")).alias(\"total_red_cards_team2\"),\r\n    (col(\"df1.Goalkeeper_Penalty_Saved\") +\r\n      col(\"df1.Goalkeeper_Punch\") +\r\n      col(\"df1.Goalkeeper_Save\") +\r\n      col(\"df1.Goalkeeper_Shot_Saved\") +\r\n      col(\"df1.Goalkeeper_Smother\") +\r\n      col(\"df1.Goalkeeper_Shot_Saved_To_Post\")).alias(\"total_actions_team1\"),\r\n    (col(\"df2.Goalkeeper_Penalty_Saved\") +\r\n      col(\"df2.Goalkeeper_Punch\") +\r\n      col(\"df2.Goalkeeper_Save\") +\r\n      col(\"df2.Goalkeeper_Shot_Saved\") +\r\n      col(\"df2.Goalkeeper_Smother\") +\r\n      col(\"df2.Goalkeeper_Shot_Saved_To_Post\")).alias(\"total_actions_team2\")\r\n  )\r\n\r\njoinedDf.show()\r\n\r\n// End timing\r\nval endTime \u003d System.nanoTime()\r\nval duration \u003d (endTime - startTime) / 1e9d\r\nprintln(s\"Time taken: $duration seconds\")\r\n",
      "user": "anonymous",
      "dateUpdated": "2024-05-18 14:31:43.222",
      "progress": 7,
      "config": {
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {}
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[33mwarning: \u001b[0m1 deprecation (since 2.13.0)\n\u001b[33mwarning: \u001b[0m1 deprecation (since 2.13.3)\n\u001b[33mwarning: \u001b[0m2 deprecations in total; for details, enable `:setting -deprecation` or `:replay -deprecation`\n+--------+--------------------+----------+----------+----------+----------+--------------+--------------+--------------------+--------------------+-------------------------------+-------------------------------+---------------------+---------------------+-------------------+-------------------+\n|match_id|         match_teams|Pass_team1|Pass_team2|Shot_team1|Shot_team2|Foul_won_team1|Foul_won_team2|Foul_committed_team1|Foul_committed_team2|Bad_Behaviour_Yellow_Card_team1|Bad_Behaviour_Yellow_Card_team2|total_red_cards_team1|total_red_cards_team2|total_actions_team1|total_actions_team2|\n+--------+--------------------+----------+----------+----------+----------+--------------+--------------+--------------------+--------------------+-------------------------------+-------------------------------+---------------------+---------------------+-------------------+-------------------+\n|   18237|Bayern Munich vs ...|       689|       576|        45|        14|            21|            20|                  22|                  21|                              0|                              1|                    0|                    0|                 11|                  5|\n|   18243|Atlético Madrid v...|       709|       649|        22|        31|            22|            18|                  23|                  19|                              1|                              1|                    0|                    0|                  4|                  7|\n|   16182|Barcelona vs Real...|       761|       465|        20|        11|            24|            14|                  26|                  16|                              0|                              1|                    0|                    0|                  5|                  2|\n|   16248|Atlético Madrid v...|       417|       779|         8|        21|            11|            18|                  11|                  20|                              1|                              3|                    0|                    1|                  4|                  7|\n|   18236|Barcelona vs Manc...|       842|       380|        22|         4|            16|             6|                  16|                   6|                              0|                              1|                    0|                    0|                  4|                  6|\n|   16157|Barcelona vs Vale...|       814|       381|        20|        13|             9|             9|                   9|                   9|                              1|                              0|                    0|                    0|                 10|                  4|\n|   16306| Barcelona vs Getafe|       965|       231|        14|        10|            16|             8|                  16|                   8|                              0|                              0|                    0|                    0|                  7|                  1|\n|   16023|Barcelona vs Vale...|      1033|       348|         9|        11|            14|             7|                  14|                   7|                              1|                              1|                    0|                    0|                  3|                  3|\n|   16205|Barcelona vs Rayo...|       740|       332|        12|         8|            17|            13|                  19|                  13|                              1|                              0|                    0|                    0|                  2|                  2|\n|   16265|Barcelona vs Real...|       569|       553|        11|         9|            12|            11|                  13|                  14|                              0|                              0|                    0|                    0|                  1|                  3|\n|   18241|Atlético Madrid v...|       456|       795|        13|        19|            15|            31|                  16|                  34|                              0|                              6|                    0|                    0|                  3|                  5|\n|   16215|Barcelona vs Real...|       480|       627|        16|        13|            11|             7|                  12|                   9|                              1|                              0|                    0|                    0|                  3|                  4|\n|   16073|Atlético Madrid v...|       347|       765|         3|         7|            13|            24|                  13|                  24|                              0|                              3|                    0|                    0|                  1|                  1|\n|   16086|Barcelona vs Espa...|       617|       503|        17|        15|            18|            12|                  18|                  12|                              0|                              0|                    0|                    0|                  8|                  0|\n|   15986| Barcelona vs Girona|       772|       369|        21|         7|            17|            11|                  18|                  11|                              1|                              1|                    0|                    0|                  5|                  6|\n|   16196|Barcelona vs Real...|       531|       525|        10|        18|            22|            12|                  24|                  13|                              0|                              1|                    0|                    0|                  1|                  7|\n|   15998|Barcelona vs Leganés|       858|       264|         9|         9|            20|             9|                  20|                   9|                              0|                              0|                    0|                    0|                  5|                  3|\n|   16079|Barcelona vs Vill...|       713|       442|        15|        12|            17|            11|                  17|                  11|                              0|                              1|                    0|                    0|                  7|                  1|\n|   15978|Barcelona vs Real...|       798|       350|        12|         8|            19|             8|                  19|                   9|                              0|                              1|                    0|                    0|                  3|                  4|\n|   16240|Barcelona vs Vill...|       729|       332|        15|        16|            18|            11|                  18|                  11|                              2|                              0|                    0|                    0|                  4|                  6|\n+--------+--------------------+----------+----------+----------+----------+--------------+--------------+--------------------+--------------------+-------------------------------+-------------------------------+---------------------+---------------------+-------------------+-------------------+\nonly showing top 20 rows\n\nTime taken: 1.816366022 seconds\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\nimport org.apache.hadoop.fs.{FileSystem, Path}\nval \u001b[1m\u001b[34mspark\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.SparkSession\u001b[0m \u003d org.apache.spark.sql.SparkSession@58eeab74\nval \u001b[1m\u001b[34msc\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.SparkContext\u001b[0m \u003d org.apache.spark.SparkContext@15f1bb02\nval \u001b[1m\u001b[34mhadoopConf\u001b[0m: \u001b[1m\u001b[32morg.apache.hadoop.conf.Configuration\u001b[0m \u003d Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-rbf-default.xml, hdfs-site.xml, hdfs-rbf-site.xml, __spark_hadoop_conf__.xml\nval \u001b[1m\u001b[34mfs\u001b[0m: \u001b[1m\u001b[32morg.apache.hadoop.fs.FileSystem\u001b[0m \u003d org.apache.hadoop.hive.ql.io.ProxyLocalFileSy...\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d1791"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d1792"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d1793"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d1794"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d1795"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1715938373648_628789392",
      "id": "paragraph_1715938373648_628789392",
      "dateCreated": "2024-05-17 09:32:53.648",
      "dateStarted": "2024-05-18 14:30:39.281",
      "dateFinished": "2024-05-18 14:30:58.933",
      "status": "FINISHED"
    },
    {
      "text": "%md \n\n# ALL events --\u003e can be long",
      "user": "anonymous",
      "dateUpdated": "2024-05-18 14:35:04.465",
      "progress": 0,
      "config": {
        "tableHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true,
          "completionKey": "TAB",
          "completionSupport": false
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/markdown",
        "fontSize": 9.0,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eALL events \u0026ndash;\u0026gt; can be long\u003c/h1\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1716042865029_1470419814",
      "id": "paragraph_1716042865029_1470419814",
      "dateCreated": "2024-05-18 14:34:25.029",
      "dateStarted": "2024-05-18 14:35:04.465",
      "dateFinished": "2024-05-18 14:35:04.498",
      "status": "FINISHED"
    },
    {
      "text": "import org.apache.spark.sql.SparkSession\r\nimport org.apache.spark.sql.functions._\r\nimport org.apache.spark.sql.types._\r\nimport org.apache.hadoop.fs.{FileSystem, Path}\r\n\r\n\r\nval spark \u003d SparkSession.builder.appName(\"Soccer Match Analysis\").getOrCreate()\r\nval sc \u003d spark.sparkContext\r\nval hadoopConf \u003d sc.hadoopConfiguration\r\nval fs \u003d FileSystem.get(hadoopConf)\r\n\r\nval jsonDirectory \u003d \"./data/events\"\r\nval fileStatus \u003d fs.listStatus(new Path(jsonDirectory))\r\nval files \u003d fileStatus.map(_.getPath.toString)\r\n\r\nval allMatchesDf \u003d spark.read.option(\"multiLine\", true).json(files: _*)\r\n\r\nval filePathColumn \u003d input_file_name()\r\nval matchIdDf \u003d allMatchesDf.withColumn(\"match_id\", regexp_extract(filePathColumn, \"\"\"(\\d+)\\.json$\"\"\", 1))\r\n\r\nval startTime \u003d System.nanoTime()\r\n\r\n// Feature columns\r\nval featureColumns2 \u003d Seq(\r\n  (\"type.name\", \"Pass\", \"Pass_feature\"),\r\n  (\"type.name\", \"Shot\", \"Shot_feature\"),\r\n  (\"type.name\", \"Foul Won\", \"Foul_won_feature\"),\r\n  (\"type.name\", \"Foul Committed\", \"Foul_committed_feature\")\r\n)\r\n\r\nval featureColumns3 \u003d Seq(\r\n  (\"type.name\", \"Bad Behaviour\", \"bad_behaviour.card.name\", \"Yellow Card\", \"Bad_Behaviour_Yellow_Card_feature\"),\r\n  (\"type.name\", \"Bad Behaviour\", \"bad_behaviour.card.name\", \"Second Yellow\", \"Bad_Behaviour_Second_Yellow_feature\"),\r\n  (\"type.name\", \"Goal Keeper\", \"goalkeeper.type.name\", \"Penalty Saved\", \"Goalkeeper_Penalty_Saved_feature\"),\r\n  (\"type.name\", \"Goal Keeper\", \"goalkeeper.type.name\", \"Punch\", \"Goalkeeper_Punch_feature\"),\r\n  (\"type.name\", \"Goal Keeper\", \"goalkeeper.type.name\", \"Save\", \"Goalkeeper_Save_feature\"),\r\n  (\"type.name\", \"Goal Keeper\", \"goalkeeper.type.name\", \"Shot Saved\", \"Goalkeeper_Shot_Saved_feature\"),\r\n  (\"type.name\", \"Goal Keeper\", \"goalkeeper.type.name\", \"Smother\", \"Goalkeeper_Smother_feature\"),\r\n  (\"type.name\", \"Goal Keeper\", \"goalkeeper.type.name\", \"Shot Saved To Post\", \"Goalkeeper_Shot_Saved_To_Post_feature\")\r\n)\r\n\r\nval featureColumnsSeq \u003d Seq(\r\n  (\"type.name\", \"Bad Behaviour\", \"bad_behaviour.card.name\", Seq(\"Red Card\", \"Second Yellow\"), \"Bad_Behaviour_Red_Card_feature\")\r\n)\r\n\r\n// Create feature columns dynamically\r\nval updatedDf2 \u003d featureColumns2.foldLeft(matchIdDf)((df, colInfo) \u003d\u003e {\r\n  val (col1, col2, newCol) \u003d colInfo\r\n  df.withColumn(newCol, when(col(col1) \u003d\u003d\u003d col2, 1).otherwise(0))\r\n})\r\n\r\nval updatedDf3 \u003d featureColumns3.foldLeft(updatedDf2)((df, colInfo) \u003d\u003e {\r\n  val (col1, col2, col3, col4, newCol) \u003d colInfo\r\n  df.withColumn(newCol, when(col(col1) \u003d\u003d\u003d col2 \u0026\u0026 col(col3) \u003d\u003d\u003d col4, 1).otherwise(0))\r\n})\r\n\r\nval updatedDfSeq \u003d featureColumnsSeq.foldLeft(updatedDf3)((df, colInfo) \u003d\u003e {\r\n  val (col1, col2, col3, col4, newCol) \u003d colInfo\r\n  df.withColumn(newCol, when(col(col1) \u003d\u003d\u003d col2 \u0026\u0026 col(col3).isin(col4: _*), 1).otherwise(0))\r\n})\r\n\r\nval aggregatedDf \u003d updatedDfSeq.groupBy(\"match_id\", \"possession_team.name\").agg(\r\n  sum(\"Pass_feature\").alias(\"Pass\"),\r\n  sum(\"Shot_feature\").alias(\"Shot\"),\r\n  sum(\"Foul_won_feature\").alias(\"Foul_won\"),\r\n  sum(\"Foul_committed_feature\").alias(\"Foul_committed\"),\r\n  sum(\"Bad_Behaviour_Yellow_Card_feature\").alias(\"Bad_Behaviour_Yellow_Card\"),\r\n  sum(\"Bad_Behaviour_Second_Yellow_feature\").alias(\"Bad_Behaviour_Second_Yellow\"),\r\n  sum(\"Bad_Behaviour_Red_Card_feature\").alias(\"Bad_Behaviour_Red_Card\"),\r\n  sum(\"Goalkeeper_Penalty_Saved_feature\").alias(\"Goalkeeper_Penalty_Saved\"),\r\n  sum(\"Goalkeeper_Punch_feature\").alias(\"Goalkeeper_Punch\"),\r\n  sum(\"Goalkeeper_Save_feature\").alias(\"Goalkeeper_Save\"),\r\n  sum(\"Goalkeeper_Shot_Saved_feature\").alias(\"Goalkeeper_Shot_Saved\"),\r\n  sum(\"Goalkeeper_Smother_feature\").alias(\"Goalkeeper_Smother\"),\r\n  sum(\"Goalkeeper_Shot_Saved_To_Post_feature\").alias(\"Goalkeeper_Shot_Saved_To_Post\")\r\n)\r\n\r\n// Create self-join to combine team pairs\r\nval joinedDf \u003d aggregatedDf.as(\"df1\")\r\n  .join(aggregatedDf.as(\"df2\"), col(\"df1.match_id\") \u003d\u003d\u003d col(\"df2.match_id\") \u0026\u0026 col(\"df1.name\") \u003c col(\"df2.name\"))\r\n  .select(\r\n    col(\"df1.match_id\"),\r\n    concat_ws(\" vs \", col(\"df1.name\"), col(\"df2.name\")).alias(\"match_teams\"),\r\n    col(\"df1.Pass\").alias(\"Pass_team1\"),\r\n    col(\"df2.Pass\").alias(\"Pass_team2\"),\r\n    col(\"df1.Shot\").alias(\"Shot_team1\"),\r\n    col(\"df2.Shot\").alias(\"Shot_team2\"),\r\n    col(\"df1.Foul_won\").alias(\"Foul_won_team1\"),\r\n    col(\"df2.Foul_won\").alias(\"Foul_won_team2\"),\r\n    col(\"df1.Foul_committed\").alias(\"Foul_committed_team1\"),\r\n    col(\"df2.Foul_committed\").alias(\"Foul_committed_team2\"),\r\n    col(\"df1.Bad_Behaviour_Yellow_Card\").alias(\"Bad_Behaviour_Yellow_Card_team1\"),\r\n    col(\"df2.Bad_Behaviour_Yellow_Card\").alias(\"Bad_Behaviour_Yellow_Card_team2\"),\r\n    (col(\"df1.Bad_Behaviour_Red_Card\") + col(\"df1.Bad_Behaviour_Second_Yellow\")).alias(\"total_red_cards_team1\"),\r\n    (col(\"df2.Bad_Behaviour_Red_Card\") + col(\"df2.Bad_Behaviour_Second_Yellow\")).alias(\"total_red_cards_team2\"),\r\n    (col(\"df1.Goalkeeper_Penalty_Saved\") +\r\n      col(\"df1.Goalkeeper_Punch\") +\r\n      col(\"df1.Goalkeeper_Save\") +\r\n      col(\"df1.Goalkeeper_Shot_Saved\") +\r\n      col(\"df1.Goalkeeper_Smother\") +\r\n      col(\"df1.Goalkeeper_Shot_Saved_To_Post\")).alias(\"total_actions_team1\"),\r\n    (col(\"df2.Goalkeeper_Penalty_Saved\") +\r\n      col(\"df2.Goalkeeper_Punch\") +\r\n      col(\"df2.Goalkeeper_Save\") +\r\n      col(\"df2.Goalkeeper_Shot_Saved\") +\r\n      col(\"df2.Goalkeeper_Smother\") +\r\n      col(\"df2.Goalkeeper_Shot_Saved_To_Post\")).alias(\"total_actions_team2\")\r\n  )\r\n\r\njoinedDf.show()\r\n\r\n// End timing\r\nval endTime \u003d System.nanoTime()\r\nval duration \u003d (endTime - startTime) / 1e9d\r\nprintln(s\"Time taken: $duration seconds\")\r\n",
      "user": "anonymous",
      "dateUpdated": "2024-05-18 14:35:06.677",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[33mwarning: \u001b[0m1 deprecation (since 2.13.0)\n\u001b[33mwarning: \u001b[0m1 deprecation (since 2.13.3)\n\u001b[33mwarning: \u001b[0m2 deprecations in total; for details, enable `:setting -deprecation` or `:replay -deprecation`\n+--------+--------------------+----------+----------+----------+----------+--------------+--------------+--------------------+--------------------+-------------------------------+-------------------------------+---------------------+---------------------+-------------------+-------------------+\n|match_id|         match_teams|Pass_team1|Pass_team2|Shot_team1|Shot_team2|Foul_won_team1|Foul_won_team2|Foul_committed_team1|Foul_committed_team2|Bad_Behaviour_Yellow_Card_team1|Bad_Behaviour_Yellow_Card_team2|total_red_cards_team1|total_red_cards_team2|total_actions_team1|total_actions_team2|\n+--------+--------------------+----------+----------+----------+----------+--------------+--------------+--------------------+--------------------+-------------------------------+-------------------------------+---------------------+---------------------+-------------------+-------------------+\n| 3794686|    Croatia vs Spain|       464|       948|        11|        24|            10|            28|                  10|                  29|                              0|                              1|                    0|                    0|                  2|                  7|\n| 3837938|OGC Nice vs Paris...|       616|       752|        20|        14|             3|             9|                   3|                   9|                              0|                              0|                    0|                    0|                  9|                  3|\n| 3794692|   Sweden vs Ukraine|       684|       793|        13|        15|            10|            10|                  10|                  10|                              0|                              2|                    0|                    0|                  4|                  1|\n| 3795108|Spain vs Switzerland|      1052|       379|        35|        11|            19|            13|                  19|                  13|                              0|                              0|                    0|                    0|                 10|                  6|\n| 3795506|    England vs Italy|       471|       879|        11|        24|            20|            22|                  21|                  26|                              0|                              0|                    0|                    0|                  5|                  4|\n|   18237|Bayern Munich vs ...|       689|       576|        45|        14|            21|            20|                  22|                  21|                              0|                              1|                    0|                    0|                 11|                  5|\n|   18243|Atlético Madrid v...|       709|       649|        22|        31|            22|            18|                  23|                  19|                              1|                              1|                    0|                    0|                  4|                  7|\n| 3773369| Barcelona vs Huesca|       946|       411|        13|         7|            15|            11|                  15|                  11|                              0|                              0|                    0|                    0|                  4|                  0|\n|   70305|Barcelona vs RC D...|       952|       345|        12|         4|            13|            13|                  15|                  14|                              0|                              1|                    0|                    0|                  6|                  1|\n| 3829519|Paris Saint-Germa...|       893|       412|        21|        14|            13|            11|                  13|                  11|                              0|                              0|                    0|                    0|                  9|                  3|\n| 3902240|Netherlands Women...|       457|       764|        10|        26|             9|            19|                   9|                  22|                              0|                              0|                    0|                    0|                  1|                  7|\n|    7582|     Russia vs Spain|       309|      1174|        12|        29|             6|            18|                   9|                  18|                              0|                              0|                    0|                    0|                  5|                  6|\n|   68357|Australia Women\u0027s...|       672|       575|        20|        32|            11|             9|                  12|                  10|                              0|                              0|                    0|                    0|                  7|                 10|\n| 3794685|    Austria vs Italy|       653|       711|        15|        27|            16|            19|                  16|                  20|                              2|                              0|                    0|                    0|                  5|                  2|\n| 3795220|      Italy vs Spain|       418|       953|        13|        19|            14|            25|                  14|                  25|                              0|                              0|                    0|                    0|                  3|                  7|\n| 3869420|   Brazil vs Croatia|       733|       751|        24|        13|            21|            25|                  22|                  26|                              1|                              0|                    0|                    0|                  9|                  4|\n| 2302764|AC Milan vs Liver...|       695|       600|        28|        21|            25|            21|                  25|                  23|                              0|                              0|                    0|                    0|                  8|                  2|\n| 3844387|France Women\u0027s vs...|       618|       583|        32|        10|            14|             9|                  14|                   9|                              0|                              0|                    0|                    0|                  7|                  4|\n|   69296|Barcelona vs Hérc...|       888|       313|        19|         4|            15|            11|                  16|                  12|                              0|                              0|                    0|                    0|                  7|                  2|\n|   69295|Barcelona vs Raci...|       932|       336|        13|         8|            18|             5|                  18|                   5|                              1|                              0|                    0|                    0|                  8|                  3|\n+--------+--------------------+----------+----------+----------+----------+--------------+--------------+--------------------+--------------------+-------------------------------+-------------------------------+---------------------+---------------------+-------------------+-------------------+\nonly showing top 20 rows\n\nTime taken: 115.063433081 seconds\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\nimport org.apache.hadoop.fs.{FileSystem, Path}\nval \u001b[1m\u001b[34mspark\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.SparkSession\u001b[0m \u003d org.apache.spark.sql.SparkSession@58eeab74\nval \u001b[1m\u001b[34msc\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.SparkContext\u001b[0m \u003d org.apache.spark.SparkContext@15f1bb02\nval \u001b[1m\u001b[34mhadoopConf\u001b[0m: \u001b[1m\u001b[32morg.apache.hadoop.conf.Configuration\u001b[0m \u003d Configuration: core-default.xml, core-site.xml, mapred-default.xml, mapred-site.xml, yarn-default.xml, yarn-site.xml, hdfs-default.xml, hdfs-rbf-default.xml, hdfs-site.xml, hdfs-rbf-site.xml, __spark_hadoop_conf__.xml\nval \u001b[1m\u001b[34mfs\u001b[0m: \u001b[1m\u001b[32morg.apache.hadoop.fs.FileSystem\u001b[0m \u003d org.apache.hadoop.hive.ql.io.ProxyLocalFileSy...\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d1796"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d1797"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d1798"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d1799"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d1800"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1716040857629_9003209",
      "id": "paragraph_1716040857629_9003209",
      "dateCreated": "2024-05-18 14:00:57.630",
      "dateStarted": "2024-05-18 14:35:06.692",
      "dateFinished": "2024-05-18 14:40:38.104",
      "status": "FINISHED"
    },
    {
      "text": "val rowCount \u003d joinedDf.count()\r\nprintln(s\"Number of rows in joinedDf: $rowCount\")",
      "user": "anonymous",
      "dateUpdated": "2024-05-18 14:42:14.555",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "fontSize": 9.0,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Number of rows in joinedDf: 3316\nval \u001b[1m\u001b[34mrowCount\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m \u003d 3316\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d1801"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d1802"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d1803"
            },
            {
              "jobUrl": "http://ebe6f6256f03:4040/jobs/job?id\u003d1804"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1716042906691_2095420409",
      "id": "paragraph_1716042906691_2095420409",
      "dateCreated": "2024-05-18 14:35:06.691",
      "dateStarted": "2024-05-18 14:42:14.573",
      "dateFinished": "2024-05-18 14:44:08.813",
      "status": "FINISHED"
    },
    {
      "user": "anonymous",
      "progress": 0,
      "config": {},
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1716043454139_59943401",
      "id": "paragraph_1716043454139_59943401",
      "dateCreated": "2024-05-18 14:44:14.149",
      "status": "READY"
    }
  ],
  "name": "BigData_Project_Analysis",
  "id": "2JVWRDBHK",
  "defaultInterpreterGroup": "spark",
  "version": "0.11.0",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {},
  "config": {
    "isZeppelinNotebookCronEnable": false
  },
  "info": {
    "isRunning": false
  }
}