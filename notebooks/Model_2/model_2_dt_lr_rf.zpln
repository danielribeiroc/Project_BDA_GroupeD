{
  "paragraphs": [
    {
      "text": "import org.apache.spark.sql.SparkSession\r\nimport org.apache.hadoop.fs.{FileSystem, Path}\r\nimport org.apache.spark.sql.functions._\r\n\r\n// Partie où nous définissons la session Spark\r\nval spark = SparkSession.builder\r\n  .appName(\"Soccer Match Analysis\")\r\n  .config(\"spark.executor.instances\", \"2\") // Ensure 2 executors, one for each node\r\n  .config(\"spark.executor.cores\", \"4\")     // Adjust the number of cores per executor based on your needs\r\n  .config(\"spark.executor.memory\", \"4g\")   // Adjust the memory allocation per executor\r\n  .getOrCreate()\r\n\r\nval sc = spark.sparkContext\r\n\r\n// Utilisation de la fonction Spark pour lire tous les fichiers JSON dans le répertoire\r\nval jsonDirectory = \"gs://2024-bda-projet-group-d/open-data/data/events/*\"\r\n\r\n// Lecture de tous les fichiers JSON dans un DataFrame Spark\r\nval allMatchesDf = spark.read.option(\"multiLine\", true).json(jsonDirectory)\r\n\r\n// Récupération de l'ID du match à partir du nom du fichier (ex: 657.json = 657)\r\nval filePathColumn = input_file_name()\r\nval matchIdDf = allMatchesDf.withColumn(\"match_id\", regexp_extract(filePathColumn, \"\"\"(\\d+)\\.json$\"\"\", 1))",
      "user": "anonymous",
      "dateUpdated": "2024-06-03T18:46:22+0000",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "import org.apache.spark.sql.SparkSession\nimport org.apache.hadoop.fs.{FileSystem, Path}\nimport org.apache.spark.sql.functions._\n\u001b[1m\u001b[34mspark\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.SparkSession\u001b[0m = org.apache.spark.sql.SparkSession@7326b243\n\u001b[1m\u001b[34msc\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.SparkContext\u001b[0m = org.apache.spark.SparkContext@3eaa02b8\n\u001b[1m\u001b[34mjsonDirectory\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = gs://2024-bda-projet-group-d/open-data/data/events/*\n\u001b[1m\u001b[34mallMatchesDf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [50_50: struct<outcome: struct<id: bigint, name: string>>, bad_behaviour: struct<card: struct<id: bigint, name: string>> ... 40 more fields]\n\u001b[1m\u001b[34mfilePathColumn\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Column\u001b[0m = input_file_name()\n\u001b[1m\u001b[34mmatchIdDf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark...\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=2",
              "$$hashKey": "object:748"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=3",
              "$$hashKey": "object:749"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1717416434523_1863105371",
      "id": "paragraph_1717416434523_1863105371",
      "dateCreated": "2024-06-03T12:07:14+0000",
      "dateStarted": "2024-06-03T18:46:22+0000",
      "dateFinished": "2024-06-03T18:49:01+0000",
      "status": "FINISHED",
      "focus": true,
      "$$hashKey": "object:282"
    },
    {
      "text": "//matchIdDf.printSchema()",
      "user": "anonymous",
      "dateUpdated": "2024-06-03T18:49:01+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1717417131853_6440146",
      "id": "paragraph_1717417131853_6440146",
      "dateCreated": "2024-06-03T12:18:51+0000",
      "dateStarted": "2024-06-03T18:49:01+0000",
      "dateFinished": "2024-06-03T18:49:02+0000",
      "status": "FINISHED",
      "$$hashKey": "object:283"
    },
    {
      "text": "val typeDF = matchIdDf.select(col(\"type.id\").alias(\"type\"))\n\n// Show the first 5 rows of the new DataFrame\n//typeDF.show(5)",
      "user": "anonymous",
      "dateUpdated": "2024-06-03T18:49:02+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mtypeDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [type: bigint]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1717417342182_1061594600",
      "id": "paragraph_1717417342182_1061594600",
      "dateCreated": "2024-06-03T12:22:22+0000",
      "dateStarted": "2024-06-03T18:49:02+0000",
      "dateFinished": "2024-06-03T18:49:03+0000",
      "status": "FINISHED",
      "$$hashKey": "object:284"
    },
    {
      "text": "import org.apache.spark.sql.expressions.Window\nimport org.apache.spark.ml.{Pipeline, PipelineModel}\nimport org.apache.spark.ml.feature.{VectorAssembler, StringIndexer, OneHotEncoder}\nimport org.apache.spark.ml.classification.RandomForestClassifier\nimport org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator\nimport org.apache.spark.ml.tuning.{ParamGridBuilder, CrossValidator}\n\n// Define the window specification\nval windowSpec = Window.rowsBetween(-19, 0)\n\n// Apply the window function to create the sliding window\nval slidingWindowDF = typeDF\n  .withColumn(\"events_window\", collect_list(\"type\").over(windowSpec))",
      "user": "anonymous",
      "dateUpdated": "2024-06-03T18:49:03+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "import org.apache.spark.sql.expressions.Window\nimport org.apache.spark.ml.{Pipeline, PipelineModel}\nimport org.apache.spark.ml.feature.{VectorAssembler, StringIndexer, OneHotEncoder}\nimport org.apache.spark.ml.classification.RandomForestClassifier\nimport org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator\nimport org.apache.spark.ml.tuning.{ParamGridBuilder, CrossValidator}\n\u001b[1m\u001b[34mwindowSpec\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.expressions.WindowSpec\u001b[0m = org.apache.spark.sql.expressions.WindowSpec@183ba27e\n\u001b[1m\u001b[34mslidingWindowDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [type: bigint, events_window: array<bigint>]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1717417723849_1444734157",
      "id": "paragraph_1717417723849_1444734157",
      "dateCreated": "2024-06-03T12:28:43+0000",
      "dateStarted": "2024-06-03T18:49:03+0000",
      "dateFinished": "2024-06-03T18:49:04+0000",
      "status": "FINISHED",
      "$$hashKey": "object:285"
    },
    {
      "text": "//slidingWindowDF.show(10, false)",
      "user": "anonymous",
      "dateUpdated": "2024-06-03T18:49:04+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1717417743036_960132421",
      "id": "paragraph_1717417743036_960132421",
      "dateCreated": "2024-06-03T12:29:03+0000",
      "dateStarted": "2024-06-03T18:49:04+0000",
      "dateFinished": "2024-06-03T18:49:04+0000",
      "status": "FINISHED",
      "$$hashKey": "object:286"
    },
    {
      "text": "val filteredDF = slidingWindowDF\n  .filter(size(col(\"events_window\")) === 20)",
      "user": "anonymous",
      "dateUpdated": "2024-06-03T18:49:04+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mfilteredDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [type: bigint, events_window: array<bigint>]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1717417750114_1978523870",
      "id": "paragraph_1717417750114_1978523870",
      "dateCreated": "2024-06-03T12:29:10+0000",
      "dateStarted": "2024-06-03T18:49:04+0000",
      "dateFinished": "2024-06-03T18:49:05+0000",
      "status": "FINISHED",
      "$$hashKey": "object:287"
    },
    {
      "text": "val expandedDF = filteredDF\n  .withColumn(\"event1\", col(\"events_window\").getItem(0))\n  .withColumn(\"event2\", col(\"events_window\").getItem(1))\n  .withColumn(\"event3\", col(\"events_window\").getItem(2))\n  .withColumn(\"event4\", col(\"events_window\").getItem(3))\n  .withColumn(\"event5\", col(\"events_window\").getItem(4))\n  .withColumn(\"event6\", col(\"events_window\").getItem(5))\n  .withColumn(\"event7\", col(\"events_window\").getItem(6))\n  .withColumn(\"event8\", col(\"events_window\").getItem(7))\n  .withColumn(\"event9\", col(\"events_window\").getItem(8))\n  .withColumn(\"event10\", col(\"events_window\").getItem(9))\n  .withColumn(\"event11\", col(\"events_window\").getItem(10))\n  .withColumn(\"event12\", col(\"events_window\").getItem(11))\n  .withColumn(\"event13\", col(\"events_window\").getItem(12))\n  .withColumn(\"event14\", col(\"events_window\").getItem(13))\n  .withColumn(\"event15\", col(\"events_window\").getItem(14))\n  .withColumn(\"event16\", col(\"events_window\").getItem(15))\n  .withColumn(\"event17\", col(\"events_window\").getItem(16))\n  .withColumn(\"event18\", col(\"events_window\").getItem(17))\n  .withColumn(\"event19\", col(\"events_window\").getItem(18))\n  .withColumn(\"event20\", col(\"events_window\").getItem(19))\n\n  .drop(\"type\", \"events_window\")\n ",
      "user": "anonymous",
      "dateUpdated": "2024-06-03T18:49:05+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mexpandedDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [event1: bigint, event2: bigint ... 18 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1717417755319_423306418",
      "id": "paragraph_1717417755319_423306418",
      "dateCreated": "2024-06-03T12:29:15+0000",
      "dateStarted": "2024-06-03T18:49:05+0000",
      "dateFinished": "2024-06-03T18:49:06+0000",
      "status": "FINISHED",
      "$$hashKey": "object:288"
    },
    {
      "text": "println(expandedDF.count() + \" rows\")",
      "user": "anonymous",
      "dateUpdated": "2024-06-03T18:49:06+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "11491082 rows\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=4",
              "$$hashKey": "object:1039"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=5",
              "$$hashKey": "object:1040"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1717418295305_1583243927",
      "id": "paragraph_1717418295305_1583243927",
      "dateCreated": "2024-06-03T12:38:15+0000",
      "dateStarted": "2024-06-03T18:49:06+0000",
      "dateFinished": "2024-06-03T18:50:38+0000",
      "status": "FINISHED",
      "$$hashKey": "object:289"
    },
    {
      "text": "import org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._",
      "user": "anonymous",
      "dateUpdated": "2024-06-03T18:50:38+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "import org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1717418481594_1658365920",
      "id": "paragraph_1717418481594_1658365920",
      "dateCreated": "2024-06-03T12:41:21+0000",
      "dateStarted": "2024-06-03T18:50:38+0000",
      "dateFinished": "2024-06-03T18:50:39+0000",
      "status": "FINISHED",
      "$$hashKey": "object:290"
    },
    {
      "text": "// Définition du schéma pour le DataFrame --> utile pour définir quel features ont veut utiliser lors de l'entrainement\nval schema = new StructType()\n  // Ajout des colonnes avec leur nom, type et utilisation ou non\n  .add(\"event1\", LongType, true)\n  .add(\"event2\", LongType, true)\n  .add(\"event3\", LongType, true)\n  .add(\"event4\", LongType, true)\n  .add(\"event5\", LongType, true)\n  .add(\"event6\", LongType, false)\n  .add(\"event7\", LongType, false)\n  .add(\"event8\", LongType, false)\n  .add(\"event9\", LongType, false)\n  .add(\"event10\", LongType, false)\n  .add(\"event11\", LongType, false)\n  .add(\"event12\", LongType, false)\n  .add(\"event13\", LongType, false)\n  .add(\"event14\", LongType, false)\n  .add(\"event15\", LongType, false)\n  .add(\"event16\", LongType, false)\n  .add(\"event17\", LongType, false)\n  .add(\"event18\", LongType, false)\n  .add(\"event19\", LongType, false)\n  .add(\"event20\", LongType, false)",
      "user": "anonymous",
      "dateUpdated": "2024-06-03T18:50:39+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mschema\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.types.StructType\u001b[0m = StructType(StructField(event1,LongType,true),StructField(event2,LongType,true),StructField(event3,LongType,true),StructField(event4,LongType,true),StructField(event5,LongType,true),StructField(event6,LongType,false),StructField(event7,LongType,false),StructField(event8,LongType,false),StructField(event9,LongType,false),StructField(event10,LongType,false),StructField(event11,LongType,false),StructField(event12,LongType,false),StructField(event13,LongType,false),StructField(event14,LongType,false),StructField(event15,LongType,false),StructField(event16,LongType,false),StructField(event17,LongType,false),StructField(event18,LongType,false),StructField(event19,LongType,false),StructField(event20,LongType,false))\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1717417764841_1283523278",
      "id": "paragraph_1717417764841_1283523278",
      "dateCreated": "2024-06-03T12:29:24+0000",
      "dateStarted": "2024-06-03T18:50:39+0000",
      "dateFinished": "2024-06-03T18:50:39+0000",
      "status": "FINISHED",
      "$$hashKey": "object:291"
    },
    {
      "text": "// 1. Définir les colonnes de features et assembler les features en un vecteur\n\nval featureCols = Array(\"event1\", \"event2\", \"event3\", \"event4\", \"event5\") //, \"event6\", \"event7\", \"event8\", \"event9\", \"event10\", \"event11\", \"event12\", \"event13\", \"event14\", \"event15\", \"event16\", \"event17\", \"event18\", \"event19\", \"event20\")\n\nval assembler = new VectorAssembler()\n  .setInputCols(featureCols)\n  .setOutputCol(\"features\")\n\n// Repartition the DataFrame to distribute data across the cluster\nval numPartitions = 200  // Adjust based on your cluster size and data\nval repartitionedDF = expandedDF.repartition(numPartitions)\n\n// Cache the DataFrame to avoid recomputation\nrepartitionedDF.cache()\n",
      "user": "anonymous",
      "dateUpdated": "2024-06-03T18:50:39+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mfeatureCols\u001b[0m: \u001b[1m\u001b[32mArray[String]\u001b[0m = Array(event1, event2, event3, event4, event5)\n\u001b[1m\u001b[34massembler\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.feature.VectorAssembler\u001b[0m = VectorAssembler: uid=vecAssembler_4dace45345de, handleInvalid=error, numInputCols=5\n\u001b[1m\u001b[34mnumPartitions\u001b[0m: \u001b[1m\u001b[32mInt\u001b[0m = 200\n\u001b[1m\u001b[34mrepartitionedDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [event1: bigint, event2: bigint ... 18 more fields]\n\u001b[1m\u001b[34mres6\u001b[0m: \u001b[1m\u001b[32mrepartitionedDF.type\u001b[0m = [event1: bigint, event2: bigint ... 18 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1717418393364_549665381",
      "id": "paragraph_1717418393364_549665381",
      "dateCreated": "2024-06-03T12:39:53+0000",
      "dateStarted": "2024-06-03T18:50:39+0000",
      "dateFinished": "2024-06-03T18:50:40+0000",
      "status": "FINISHED",
      "$$hashKey": "object:292"
    },
    {
      "text": "// 1. Déterminer la taille du DataFrame\r\nval totalRows = repartitionedDF.count()\r\n\r\n// 2. Calculer les indices pour diviser le DataFrame\r\nval splitPoint = (totalRows * 0.8).toLong\r\n\r\n// 3. Ajouter un indice au DataFrame\r\nimport org.apache.spark.sql.functions.{monotonically_increasing_id, col}\r\n\r\nval dfWithIndex = repartitionedDF.withColumn(\"index\", monotonically_increasing_id())\r\n\r\n// 4. Créer deux DataFrames basés sur l'indice\r\nval trainingData = dfWithIndex.filter(col(\"index\") < splitPoint).drop(\"index\")\r\nval testData = dfWithIndex.filter(col(\"index\") >= splitPoint).drop(\"index\")\r\n\r\n// Vérifier la taille des DataFrames pour s'assurer de la bonne répartition\r\nprintln(s\"Training Data Count: ${trainingData.count()}\")\r\nprintln(s\"Test Data Count: ${testData.count()}\")",
      "user": "anonymous",
      "dateUpdated": "2024-06-03T18:50:40+0000",
      "progress": 45,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Training Data Count: 57455\nTest Data Count: 11433627\n\u001b[1m\u001b[34mtotalRows\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 11491082\n\u001b[1m\u001b[34msplitPoint\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 9192865\nimport org.apache.spark.sql.functions.{monotonically_increasing_id, col}\n\u001b[1m\u001b[34mdfWithIndex\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [event1: bigint, event2: bigint ... 19 more fields]\n\u001b[1m\u001b[34mtrainingData\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [event1: bigint, event2: bigint ... 18 more fields]\n\u001b[1m\u001b[34mtestData\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [event1: bigint, event2: bigint ... 18 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=6",
              "$$hashKey": "object:1210"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=7",
              "$$hashKey": "object:1211"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=8",
              "$$hashKey": "object:1212"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=9",
              "$$hashKey": "object:1213"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=10",
              "$$hashKey": "object:1214"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=11",
              "$$hashKey": "object:1215"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=12",
              "$$hashKey": "object:1216"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=13",
              "$$hashKey": "object:1217"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=14",
              "$$hashKey": "object:1218"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1717439184149_1306351649",
      "id": "paragraph_1717439184149_1306351649",
      "dateCreated": "2024-06-03T18:26:24+0000",
      "dateStarted": "2024-06-03T18:50:40+0000",
      "dateFinished": "2024-06-03T18:53:13+0000",
      "status": "FINISHED",
      "$$hashKey": "object:293"
    },
    {
      "text": "import org.apache.spark.ml.classification.{RandomForestClassifier, LogisticRegression, DecisionTreeClassifier, GBTClassifier}\n\n// 3. Split les données en set de train et de test\n//val Array(trainingData, testData) = repartitionedDF.randomSplit(Array(0.8, 0.2))\n\n// 4. Définir les modèles de classification\nval rf = new RandomForestClassifier().setLabelCol(\"event6\").setFeaturesCol(\"features\")\nval lr = new LogisticRegression().setLabelCol(\"event6\").setFeaturesCol(\"features\")\nval dt = new DecisionTreeClassifier().setLabelCol(\"event6\").setFeaturesCol(\"features\")\nval gbt = new GBTClassifier().setLabelCol(\"event6\").setFeaturesCol(\"features\")\n\n// 5. Définir les grilles de paramètres pour chaque modèle\nval rfParamGrid = new ParamGridBuilder()\n  .addGrid(rf.numTrees, Array(1, 2))\n  .addGrid(rf.maxDepth, Array(1, 2))\n  .build()\n\nval lrParamGrid = new ParamGridBuilder()\n  .addGrid(lr.regParam, Array(0.1))\n  .addGrid(lr.maxIter, Array(10))\n  .build()\n\nval dtParamGrid = new ParamGridBuilder()\n  .addGrid(dt.maxDepth, Array(1, 2))\n  .addGrid(dt.maxBins, Array(16, 24))\n  .build()\n\nval gbtParamGrid = new ParamGridBuilder()\n  .addGrid(gbt.maxDepth, Array(1, 2))\n  .addGrid(gbt.maxIter, Array(5, 10))\n  .build()\n\n// 6. Définir l'évaluateur pour mesurer la précision ou autres\nval evaluator = new MulticlassClassificationEvaluator()\n  .setLabelCol(\"event6\")\n  .setPredictionCol(\"prediction\")\n  .setMetricName(\"accuracy\")\n\n// 7. Configurer la cross validation pour chaque modèle\nval rfCv = new CrossValidator()\n  .setEstimator(rf)\n  .setEvaluator(evaluator)\n  .setEstimatorParamMaps(rfParamGrid)\n  .setNumFolds(3)\n\nval lrCv = new CrossValidator()\n  .setEstimator(lr)\n  .setEvaluator(evaluator)\n  .setEstimatorParamMaps(lrParamGrid)\n  .setNumFolds(3)\n\nval dtCv = new CrossValidator()\n  .setEstimator(dt)\n  .setEvaluator(evaluator)\n  .setEstimatorParamMaps(dtParamGrid)\n  .setNumFolds(3)\n\nval gbtCv = new CrossValidator()\n  .setEstimator(gbt)\n  .setEvaluator(evaluator)\n  .setEstimatorParamMaps(gbtParamGrid)\n  .setNumFolds(3)\n\n// 8. Création des pipelines pour chaque modèle\nval rfPipeline = new Pipeline().setStages(Array(assembler, rfCv))\nval lrPipeline = new Pipeline().setStages(Array(assembler, lrCv))\nval dtPipeline = new Pipeline().setStages(Array(assembler, dtCv))\nval gbtPipeline = new Pipeline().setStages(Array(assembler, gbtCv))",
      "user": "anonymous",
      "dateUpdated": "2024-06-03T18:53:13+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "import org.apache.spark.ml.classification.{RandomForestClassifier, LogisticRegression, DecisionTreeClassifier, GBTClassifier}\n\u001b[1m\u001b[34mrf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.classification.RandomForestClassifier\u001b[0m = rfc_202a0e97b420\n\u001b[1m\u001b[34mlr\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.classification.LogisticRegression\u001b[0m = logreg_242ef7458ea4\n\u001b[1m\u001b[34mdt\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.classification.DecisionTreeClassifier\u001b[0m = dtc_c9417e18dcc4\n\u001b[1m\u001b[34mgbt\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.classification.GBTClassifier\u001b[0m = gbtc_08a6422f469b\n\u001b[1m\u001b[34mrfParamGrid\u001b[0m: \u001b[1m\u001b[32mArray[org.apache.spark.ml.param.ParamMap]\u001b[0m =\nArray({\n\trfc_202a0e97b420-maxDepth: 1,\n\trfc_202a0e97b420-numTrees: 1\n}, {\n\trfc_202a0e97b420-maxDepth: 1,\n\trfc_202a0e97b420-numTrees: 2\n}, {\n\trfc_202a0e97b420-maxDepth: ...\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1717418863229_1378469944",
      "id": "paragraph_1717418863229_1378469944",
      "dateCreated": "2024-06-03T12:47:43+0000",
      "dateStarted": "2024-06-03T18:53:13+0000",
      "dateFinished": "2024-06-03T18:53:14+0000",
      "status": "FINISHED",
      "$$hashKey": "object:294"
    },
    {
      "text": "// Train each model\nval rfModel = rfPipeline.fit(trainingData)\nval rfPredictions = rfModel.transform(testData)\nval rfAccuracy = evaluator.evaluate(rfPredictions)\nprintln(s\"Random Forest Accuracy: $rfAccuracy\")",
      "user": "anonymous",
      "dateUpdated": "2024-06-03T18:53:14+0000",
      "progress": 67,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Random Forest Accuracy: 0.6316366626268287\n\u001b[1m\u001b[34mrfModel\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.PipelineModel\u001b[0m = pipeline_cdbb8f2746fc\n\u001b[1m\u001b[34mrfPredictions\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [event1: bigint, event2: bigint ... 22 more fields]\n\u001b[1m\u001b[34mrfAccuracy\u001b[0m: \u001b[1m\u001b[32mDouble\u001b[0m = 0.6316366626268287\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=15",
              "$$hashKey": "object:1336"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=16",
              "$$hashKey": "object:1337"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=17",
              "$$hashKey": "object:1338"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=18",
              "$$hashKey": "object:1339"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=19",
              "$$hashKey": "object:1340"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=20",
              "$$hashKey": "object:1341"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=21",
              "$$hashKey": "object:1342"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=22",
              "$$hashKey": "object:1343"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=23",
              "$$hashKey": "object:1344"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=24",
              "$$hashKey": "object:1345"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=25",
              "$$hashKey": "object:1346"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=26",
              "$$hashKey": "object:1347"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=27",
              "$$hashKey": "object:1348"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=28",
              "$$hashKey": "object:1349"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=29",
              "$$hashKey": "object:1350"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=30",
              "$$hashKey": "object:1351"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=31",
              "$$hashKey": "object:1352"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=32",
              "$$hashKey": "object:1353"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=33",
              "$$hashKey": "object:1354"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=34",
              "$$hashKey": "object:1355"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=35",
              "$$hashKey": "object:1356"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=36",
              "$$hashKey": "object:1357"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=37",
              "$$hashKey": "object:1358"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=38",
              "$$hashKey": "object:1359"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=39",
              "$$hashKey": "object:1360"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=40",
              "$$hashKey": "object:1361"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=41",
              "$$hashKey": "object:1362"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=42",
              "$$hashKey": "object:1363"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=43",
              "$$hashKey": "object:1364"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=44",
              "$$hashKey": "object:1365"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=45",
              "$$hashKey": "object:1366"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=46",
              "$$hashKey": "object:1367"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=47",
              "$$hashKey": "object:1368"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=48",
              "$$hashKey": "object:1369"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=49",
              "$$hashKey": "object:1370"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=50",
              "$$hashKey": "object:1371"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=51",
              "$$hashKey": "object:1372"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=52",
              "$$hashKey": "object:1373"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=53",
              "$$hashKey": "object:1374"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=54",
              "$$hashKey": "object:1375"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=55",
              "$$hashKey": "object:1376"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=56",
              "$$hashKey": "object:1377"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=57",
              "$$hashKey": "object:1378"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=58",
              "$$hashKey": "object:1379"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=59",
              "$$hashKey": "object:1380"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=60",
              "$$hashKey": "object:1381"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=61",
              "$$hashKey": "object:1382"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=62",
              "$$hashKey": "object:1383"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=63",
              "$$hashKey": "object:1384"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=64",
              "$$hashKey": "object:1385"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=65",
              "$$hashKey": "object:1386"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=66",
              "$$hashKey": "object:1387"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=67",
              "$$hashKey": "object:1388"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=68",
              "$$hashKey": "object:1389"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=69",
              "$$hashKey": "object:1390"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=70",
              "$$hashKey": "object:1391"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=71",
              "$$hashKey": "object:1392"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=72",
              "$$hashKey": "object:1393"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=73",
              "$$hashKey": "object:1394"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=74",
              "$$hashKey": "object:1395"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=75",
              "$$hashKey": "object:1396"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=76",
              "$$hashKey": "object:1397"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=77",
              "$$hashKey": "object:1398"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=78",
              "$$hashKey": "object:1399"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=79",
              "$$hashKey": "object:1400"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=80",
              "$$hashKey": "object:1401"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=81",
              "$$hashKey": "object:1402"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=82",
              "$$hashKey": "object:1403"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=83",
              "$$hashKey": "object:1404"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=84",
              "$$hashKey": "object:1405"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=85",
              "$$hashKey": "object:1406"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=86",
              "$$hashKey": "object:1407"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=87",
              "$$hashKey": "object:1408"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=88",
              "$$hashKey": "object:1409"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=89",
              "$$hashKey": "object:1410"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=90",
              "$$hashKey": "object:1411"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=91",
              "$$hashKey": "object:1412"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=92",
              "$$hashKey": "object:1413"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=93",
              "$$hashKey": "object:1414"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=94",
              "$$hashKey": "object:1415"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=95",
              "$$hashKey": "object:1416"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=96",
              "$$hashKey": "object:1417"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=97",
              "$$hashKey": "object:1418"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=98",
              "$$hashKey": "object:1419"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=99",
              "$$hashKey": "object:1420"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=100",
              "$$hashKey": "object:1421"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=101",
              "$$hashKey": "object:1422"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=102",
              "$$hashKey": "object:1423"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=103",
              "$$hashKey": "object:1424"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=104",
              "$$hashKey": "object:1425"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=105",
              "$$hashKey": "object:1426"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=106",
              "$$hashKey": "object:1427"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=107",
              "$$hashKey": "object:1428"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=108",
              "$$hashKey": "object:1429"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=109",
              "$$hashKey": "object:1430"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=110",
              "$$hashKey": "object:1431"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=111",
              "$$hashKey": "object:1432"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=112",
              "$$hashKey": "object:1433"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=113",
              "$$hashKey": "object:1434"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=114",
              "$$hashKey": "object:1435"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=115",
              "$$hashKey": "object:1436"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=116",
              "$$hashKey": "object:1437"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=117",
              "$$hashKey": "object:1438"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=118",
              "$$hashKey": "object:1439"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1717425448497_446992489",
      "id": "paragraph_1717425448497_446992489",
      "dateCreated": "2024-06-03T14:37:28+0000",
      "dateStarted": "2024-06-03T18:53:15+0000",
      "dateFinished": "2024-06-03T18:57:10+0000",
      "status": "FINISHED",
      "$$hashKey": "object:295"
    },
    {
      "text": "// Make predictions on the test data\r\nval lrModel = lrPipeline.fit(trainingData)\r\nval lrPredictions = lrModel.transform(testData)\r\nval lrAccuracy = evaluator.evaluate(lrPredictions)\r\nprintln(s\"Logistic Regression Accuracy: $lrAccuracy\")",
      "user": "anonymous",
      "dateUpdated": "2024-06-03T18:57:10+0000",
      "progress": 66,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Logistic Regression Accuracy: 0.4376650558917131\n\u001b[1m\u001b[34mlrModel\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.PipelineModel\u001b[0m = pipeline_2007de06c8b2\n\u001b[1m\u001b[34mlrPredictions\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [event1: bigint, event2: bigint ... 22 more fields]\n\u001b[1m\u001b[34mlrAccuracy\u001b[0m: \u001b[1m\u001b[32mDouble\u001b[0m = 0.4376650558917131\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=119",
              "$$hashKey": "object:1897"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=120",
              "$$hashKey": "object:1898"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=121",
              "$$hashKey": "object:1899"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=122",
              "$$hashKey": "object:1900"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=123",
              "$$hashKey": "object:1901"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=124",
              "$$hashKey": "object:1902"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=125",
              "$$hashKey": "object:1903"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=126",
              "$$hashKey": "object:1904"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=127",
              "$$hashKey": "object:1905"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=128",
              "$$hashKey": "object:1906"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=129",
              "$$hashKey": "object:1907"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=130",
              "$$hashKey": "object:1908"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=131",
              "$$hashKey": "object:1909"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=132",
              "$$hashKey": "object:1910"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=133",
              "$$hashKey": "object:1911"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=134",
              "$$hashKey": "object:1912"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=135",
              "$$hashKey": "object:1913"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=136",
              "$$hashKey": "object:1914"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=137",
              "$$hashKey": "object:1915"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=138",
              "$$hashKey": "object:1916"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=139",
              "$$hashKey": "object:1917"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=140",
              "$$hashKey": "object:1918"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=141",
              "$$hashKey": "object:1919"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=142",
              "$$hashKey": "object:1920"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=143",
              "$$hashKey": "object:1921"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=144",
              "$$hashKey": "object:1922"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=145",
              "$$hashKey": "object:1923"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=146",
              "$$hashKey": "object:1924"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=147",
              "$$hashKey": "object:1925"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=148",
              "$$hashKey": "object:1926"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=149",
              "$$hashKey": "object:1927"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=150",
              "$$hashKey": "object:1928"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=151",
              "$$hashKey": "object:1929"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=152",
              "$$hashKey": "object:1930"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=153",
              "$$hashKey": "object:1931"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=154",
              "$$hashKey": "object:1932"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=155",
              "$$hashKey": "object:1933"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=156",
              "$$hashKey": "object:1934"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=157",
              "$$hashKey": "object:1935"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=158",
              "$$hashKey": "object:1936"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=159",
              "$$hashKey": "object:1937"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=160",
              "$$hashKey": "object:1938"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=161",
              "$$hashKey": "object:1939"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=162",
              "$$hashKey": "object:1940"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=163",
              "$$hashKey": "object:1941"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=164",
              "$$hashKey": "object:1942"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=165",
              "$$hashKey": "object:1943"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=166",
              "$$hashKey": "object:1944"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=167",
              "$$hashKey": "object:1945"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=168",
              "$$hashKey": "object:1946"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=169",
              "$$hashKey": "object:1947"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=170",
              "$$hashKey": "object:1948"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=171",
              "$$hashKey": "object:1949"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=172",
              "$$hashKey": "object:1950"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=173",
              "$$hashKey": "object:1951"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=174",
              "$$hashKey": "object:1952"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=175",
              "$$hashKey": "object:1953"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=176",
              "$$hashKey": "object:1954"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1717418358588_489151295",
      "id": "paragraph_1717418358588_489151295",
      "dateCreated": "2024-06-03T12:39:18+0000",
      "dateStarted": "2024-06-03T18:57:10+0000",
      "dateFinished": "2024-06-03T18:59:38+0000",
      "status": "FINISHED",
      "$$hashKey": "object:296"
    },
    {
      "text": "val dtModel = dtPipeline.fit(trainingData)\r\nval dtPredictions = dtModel.transform(testData)\r\nval dtAccuracy = evaluator.evaluate(dtPredictions)\r\nprintln(s\"Decision Tree Accuracy: $dtAccuracy\")\r\n",
      "user": "anonymous",
      "dateUpdated": "2024-06-03T18:59:38+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "ERROR",
        "msg": [
          {
            "type": "TEXT",
            "data": "org.apache.spark.SparkException: Job 278 cancelled because SparkContext was shut down\n  at org.apache.spark.scheduler.DAGScheduler.$anonfun$cleanUpAfterSchedulerStop$1(DAGScheduler.scala:1248)\n  at org.apache.spark.scheduler.DAGScheduler.$anonfun$cleanUpAfterSchedulerStop$1$adapted(DAGScheduler.scala:1246)\n  at scala.collection.mutable.HashSet.foreach(HashSet.scala:79)\n  at org.apache.spark.scheduler.DAGScheduler.cleanUpAfterSchedulerStop(DAGScheduler.scala:1246)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onStop(DAGScheduler.scala:3075)\n  at org.apache.spark.util.EventLoop.stop(EventLoop.scala:84)\n  at org.apache.spark.scheduler.DAGScheduler.$anonfun$stop$3(DAGScheduler.scala:2961)\n  at org.apache.spark.util.Utils$.tryLogNonFatalError(Utils.scala:1376)\n  at org.apache.spark.scheduler.DAGScheduler.stop(DAGScheduler.scala:2961)\n  at org.apache.spark.SparkContext.$anonfun$stop$12(SparkContext.scala:2280)\n  at org.apache.spark.util.Utils$.tryLogNonFatalError(Utils.scala:1376)\n  at org.apache.spark.SparkContext.stop(SparkContext.scala:2280)\n  at org.apache.spark.SparkContext.stop(SparkContext.scala:2233)\n  at org.apache.spark.SparkContext.$anonfun$new$35(SparkContext.scala:703)\n  at org.apache.spark.util.SparkShutdownHook.run(ShutdownHookManager.scala:214)\n  at org.apache.spark.util.SparkShutdownHookManager.$anonfun$runAll$2(ShutdownHookManager.scala:188)\n  at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)\n  at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1929)\n  at org.apache.spark.util.SparkShutdownHookManager.$anonfun$runAll$1(ShutdownHookManager.scala:188)\n  at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)\n  at scala.util.Try$.apply(Try.scala:213)\n  at org.apache.spark.util.SparkShutdownHookManager.runAll(ShutdownHookManager.scala:188)\n  at org.apache.spark.util.SparkShutdownHookManager$$anon$2.run(ShutdownHookManager.scala:178)\n  at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)\n  at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)\n  at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\n  at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\n  at java.base/java.lang.Thread.run(Thread.java:829)\n  at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2415)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2436)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2455)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2480)\n  at org.apache.spark.rdd.RDD.$anonfun$collect$1(RDD.scala:1046)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n  at org.apache.spark.rdd.RDD.withScope(RDD.scala:407)\n  at org.apache.spark.rdd.RDD.collect(RDD.scala:1045)\n  at org.apache.spark.rdd.PairRDDFunctions.$anonfun$collectAsMap$1(PairRDDFunctions.scala:738)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n  at org.apache.spark.rdd.RDD.withScope(RDD.scala:407)\n  at org.apache.spark.rdd.PairRDDFunctions.collectAsMap(PairRDDFunctions.scala:737)\n  at org.apache.spark.ml.tree.impl.RandomForest$.findBestSplits(RandomForest.scala:663)\n  at org.apache.spark.ml.tree.impl.RandomForest$.runBagged(RandomForest.scala:208)\n  at org.apache.spark.ml.tree.impl.RandomForest$.run(RandomForest.scala:302)\n  at org.apache.spark.ml.classification.DecisionTreeClassifier.$anonfun$train$1(DecisionTreeClassifier.scala:143)\n  at org.apache.spark.ml.util.Instrumentation$.$anonfun$instrumented$1(Instrumentation.scala:191)\n  at scala.util.Try$.apply(Try.scala:213)\n  at org.apache.spark.ml.util.Instrumentation$.instrumented(Instrumentation.scala:191)\n  at org.apache.spark.ml.classification.DecisionTreeClassifier.train(DecisionTreeClassifier.scala:116)\n  at org.apache.spark.ml.classification.DecisionTreeClassifier.train(DecisionTreeClassifier.scala:48)\n  at org.apache.spark.ml.Predictor.fit(Predictor.scala:114)\n  at org.apache.spark.ml.Predictor.fit(Predictor.scala:78)\n  at org.apache.spark.ml.Estimator.fit(Estimator.scala:59)\n  at org.apache.spark.ml.tuning.CrossValidator.$anonfun$fit$1(CrossValidator.scala:200)\n  at org.apache.spark.ml.util.Instrumentation$.$anonfun$instrumented$1(Instrumentation.scala:191)\n  at scala.util.Try$.apply(Try.scala:213)\n  at org.apache.spark.ml.util.Instrumentation$.instrumented(Instrumentation.scala:191)\n  at org.apache.spark.ml.tuning.CrossValidator.fit(CrossValidator.scala:137)\n  at org.apache.spark.ml.tuning.CrossValidator.fit(CrossValidator.scala:80)\n  at org.apache.spark.ml.Pipeline.$anonfun$fit$5(Pipeline.scala:151)\n  at org.apache.spark.ml.MLEvents.withFitEvent(events.scala:130)\n  at org.apache.spark.ml.MLEvents.withFitEvent$(events.scala:123)\n  at org.apache.spark.ml.util.Instrumentation.withFitEvent(Instrumentation.scala:42)\n  at org.apache.spark.ml.Pipeline.$anonfun$fit$4(Pipeline.scala:151)\n  at scala.collection.Iterator.foreach(Iterator.scala:943)\n  at scala.collection.Iterator.foreach$(Iterator.scala:943)\n  at scala.collection.AbstractIterator.foreach(Iterator.scala:1431)\n  at org.apache.spark.ml.Pipeline.$anonfun$fit$2(Pipeline.scala:147)\n  at org.apache.spark.ml.MLEvents.withFitEvent(events.scala:130)\n  at org.apache.spark.ml.MLEvents.withFitEvent$(events.scala:123)\n  at org.apache.spark.ml.util.Instrumentation.withFitEvent(Instrumentation.scala:42)\n  at org.apache.spark.ml.Pipeline.$anonfun$fit$1(Pipeline.scala:133)\n  at org.apache.spark.ml.util.Instrumentation$.$anonfun$instrumented$1(Instrumentation.scala:191)\n  at scala.util.Try$.apply(Try.scala:213)\n  at org.apache.spark.ml.util.Instrumentation$.instrumented(Instrumentation.scala:191)\n  at org.apache.spark.ml.Pipeline.fit(Pipeline.scala:133)\n  ... 52 elided\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=177",
              "$$hashKey": "object:2228"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=178",
              "$$hashKey": "object:2229"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=179",
              "$$hashKey": "object:2230"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=180",
              "$$hashKey": "object:2231"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=181",
              "$$hashKey": "object:2232"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=182",
              "$$hashKey": "object:2233"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=183",
              "$$hashKey": "object:2234"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=184",
              "$$hashKey": "object:2235"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=185",
              "$$hashKey": "object:2236"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=186",
              "$$hashKey": "object:2237"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=187",
              "$$hashKey": "object:2238"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=188",
              "$$hashKey": "object:2239"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=189",
              "$$hashKey": "object:2240"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=190",
              "$$hashKey": "object:2241"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=191",
              "$$hashKey": "object:2242"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=192",
              "$$hashKey": "object:2243"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=193",
              "$$hashKey": "object:2244"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=194",
              "$$hashKey": "object:2245"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=195",
              "$$hashKey": "object:2246"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=196",
              "$$hashKey": "object:2247"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=197",
              "$$hashKey": "object:2248"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=198",
              "$$hashKey": "object:2249"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=199",
              "$$hashKey": "object:2250"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=200",
              "$$hashKey": "object:2251"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=201",
              "$$hashKey": "object:2252"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=202",
              "$$hashKey": "object:2253"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=203",
              "$$hashKey": "object:2254"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=204",
              "$$hashKey": "object:2255"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=205",
              "$$hashKey": "object:2256"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=206",
              "$$hashKey": "object:2257"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=207",
              "$$hashKey": "object:2258"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=208",
              "$$hashKey": "object:2259"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=209",
              "$$hashKey": "object:2260"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=210",
              "$$hashKey": "object:2261"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=211",
              "$$hashKey": "object:2262"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=212",
              "$$hashKey": "object:2263"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=213",
              "$$hashKey": "object:2264"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=214",
              "$$hashKey": "object:2265"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=215",
              "$$hashKey": "object:2266"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=216",
              "$$hashKey": "object:2267"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=217",
              "$$hashKey": "object:2268"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=218",
              "$$hashKey": "object:2269"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=219",
              "$$hashKey": "object:2270"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=220",
              "$$hashKey": "object:2271"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=221",
              "$$hashKey": "object:2272"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=222",
              "$$hashKey": "object:2273"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=223",
              "$$hashKey": "object:2274"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=224",
              "$$hashKey": "object:2275"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=225",
              "$$hashKey": "object:2276"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=226",
              "$$hashKey": "object:2277"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=227",
              "$$hashKey": "object:2278"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=228",
              "$$hashKey": "object:2279"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=229",
              "$$hashKey": "object:2280"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=230",
              "$$hashKey": "object:2281"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=231",
              "$$hashKey": "object:2282"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=232",
              "$$hashKey": "object:2283"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=233",
              "$$hashKey": "object:2284"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=234",
              "$$hashKey": "object:2285"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=235",
              "$$hashKey": "object:2286"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=236",
              "$$hashKey": "object:2287"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=237",
              "$$hashKey": "object:2288"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=238",
              "$$hashKey": "object:2289"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=239",
              "$$hashKey": "object:2290"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=240",
              "$$hashKey": "object:2291"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=241",
              "$$hashKey": "object:2292"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=242",
              "$$hashKey": "object:2293"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=243",
              "$$hashKey": "object:2294"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=244",
              "$$hashKey": "object:2295"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=245",
              "$$hashKey": "object:2296"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=246",
              "$$hashKey": "object:2297"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=247",
              "$$hashKey": "object:2298"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=248",
              "$$hashKey": "object:2299"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=249",
              "$$hashKey": "object:2300"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=250",
              "$$hashKey": "object:2301"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=251",
              "$$hashKey": "object:2302"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=252",
              "$$hashKey": "object:2303"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=253",
              "$$hashKey": "object:2304"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=254",
              "$$hashKey": "object:2305"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=255",
              "$$hashKey": "object:2306"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=256",
              "$$hashKey": "object:2307"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=257",
              "$$hashKey": "object:2308"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=258",
              "$$hashKey": "object:2309"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=259",
              "$$hashKey": "object:2310"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=260",
              "$$hashKey": "object:2311"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=261",
              "$$hashKey": "object:2312"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=262",
              "$$hashKey": "object:2313"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=263",
              "$$hashKey": "object:2314"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=264",
              "$$hashKey": "object:2315"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=265",
              "$$hashKey": "object:2316"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=266",
              "$$hashKey": "object:2317"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=267",
              "$$hashKey": "object:2318"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=268",
              "$$hashKey": "object:2319"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=269",
              "$$hashKey": "object:2320"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=270",
              "$$hashKey": "object:2321"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=271",
              "$$hashKey": "object:2322"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=272",
              "$$hashKey": "object:2323"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=273",
              "$$hashKey": "object:2324"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=274",
              "$$hashKey": "object:2325"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=275",
              "$$hashKey": "object:2326"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=276",
              "$$hashKey": "object:2327"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=277",
              "$$hashKey": "object:2328"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:42369/jobs/job?id=278",
              "$$hashKey": "object:2329"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1717425346418_2004355645",
      "id": "paragraph_1717425346418_2004355645",
      "dateCreated": "2024-06-03T14:35:46+0000",
      "dateStarted": "2024-06-03T18:59:38+0000",
      "dateFinished": "2024-06-03T19:01:54+0000",
      "status": "ERROR",
      "$$hashKey": "object:297"
    },
    {
      "text": "val gbtModel = gbtPipeline.fit(trainingData)\nval gbtPredictions = gbtModel.transform(testData)\nval gbtAccuracy = evaluator.evaluate(gbtPredictions)\nprintln(s\"Gradient-Boosted Trees Accuracy: $gbtAccuracy\")\n",
      "user": "anonymous",
      "dateUpdated": "2024-06-03T18:34:45+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "ERROR",
        "msg": [
          {
            "type": "TEXT",
            "data": "org.apache.spark.SparkException: Exception thrown in awaitResult:\n  at org.apache.spark.util.SparkThreadUtils$.awaitResult(SparkThreadUtils.scala:56)\n  at org.apache.spark.util.ThreadUtils$.awaitResult(ThreadUtils.scala:310)\n  at org.apache.spark.ml.tuning.CrossValidator.$anonfun$fit$9(CrossValidator.scala:186)\n  at org.apache.spark.ml.tuning.CrossValidator.$anonfun$fit$9$adapted(CrossValidator.scala:186)\n  at scala.collection.TraversableLike.$anonfun$map$1(TraversableLike.scala:286)\n  at scala.collection.IndexedSeqOptimized.foreach(IndexedSeqOptimized.scala:36)\n  at scala.collection.IndexedSeqOptimized.foreach$(IndexedSeqOptimized.scala:33)\n  at scala.collection.mutable.ArrayOps$ofRef.foreach(ArrayOps.scala:198)\n  at scala.collection.TraversableLike.map(TraversableLike.scala:286)\n  at scala.collection.TraversableLike.map$(TraversableLike.scala:279)\n  at scala.collection.mutable.ArrayOps$ofRef.map(ArrayOps.scala:198)\n  at org.apache.spark.ml.tuning.CrossValidator.$anonfun$fit$4(CrossValidator.scala:186)\n  at scala.collection.TraversableLike.$anonfun$map$1(TraversableLike.scala:286)\n  at scala.collection.IndexedSeqOptimized.foreach(IndexedSeqOptimized.scala:36)\n  at scala.collection.IndexedSeqOptimized.foreach$(IndexedSeqOptimized.scala:33)\n  at scala.collection.mutable.ArrayOps$ofRef.foreach(ArrayOps.scala:198)\n  at scala.collection.TraversableLike.map(TraversableLike.scala:286)\n  at scala.collection.TraversableLike.map$(TraversableLike.scala:279)\n  at scala.collection.mutable.ArrayOps$ofRef.map(ArrayOps.scala:198)\n  at org.apache.spark.ml.tuning.CrossValidator.$anonfun$fit$1(CrossValidator.scala:166)\n  at org.apache.spark.ml.util.Instrumentation$.$anonfun$instrumented$1(Instrumentation.scala:191)\n  at scala.util.Try$.apply(Try.scala:213)\n  at org.apache.spark.ml.util.Instrumentation$.instrumented(Instrumentation.scala:191)\n  at org.apache.spark.ml.tuning.CrossValidator.fit(CrossValidator.scala:137)\n  at org.apache.spark.ml.tuning.CrossValidator.fit(CrossValidator.scala:80)\n  at org.apache.spark.ml.Pipeline.$anonfun$fit$5(Pipeline.scala:151)\n  at org.apache.spark.ml.MLEvents.withFitEvent(events.scala:130)\n  at org.apache.spark.ml.MLEvents.withFitEvent$(events.scala:123)\n  at org.apache.spark.ml.util.Instrumentation.withFitEvent(Instrumentation.scala:42)\n  at org.apache.spark.ml.Pipeline.$anonfun$fit$4(Pipeline.scala:151)\n  at scala.collection.Iterator.foreach(Iterator.scala:943)\n  at scala.collection.Iterator.foreach$(Iterator.scala:943)\n  at scala.collection.AbstractIterator.foreach(Iterator.scala:1431)\n  at org.apache.spark.ml.Pipeline.$anonfun$fit$2(Pipeline.scala:147)\n  at org.apache.spark.ml.MLEvents.withFitEvent(events.scala:130)\n  at org.apache.spark.ml.MLEvents.withFitEvent$(events.scala:123)\n  at org.apache.spark.ml.util.Instrumentation.withFitEvent(Instrumentation.scala:42)\n  at org.apache.spark.ml.Pipeline.$anonfun$fit$1(Pipeline.scala:133)\n  at org.apache.spark.ml.util.Instrumentation$.$anonfun$instrumented$1(Instrumentation.scala:191)\n  at scala.util.Try$.apply(Try.scala:213)\n  at org.apache.spark.ml.util.Instrumentation$.instrumented(Instrumentation.scala:191)\n  at org.apache.spark.ml.Pipeline.fit(Pipeline.scala:133)\n  ... 50 elided\nCaused by: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 982.0 failed 4 times, most recent failure: Lost task 0.3 in stage 982.0 (TID 61571) (cluster-14e4-w-1.europe-west6-a.c.bigdatasemestre2.internal executor 10): java.lang.RuntimeException: Labels MUST be in {0, 1}, but got 30.0\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.project_doConsume_0$(Unknown Source)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\n\tat org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)\n\tat scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)\n\tat scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)\n\tat scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)\n\tat scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)\n\tat scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)\n\tat scala.collection.Iterator$SliceIterator.hasNext(Iterator.scala:268)\n\tat scala.collection.Iterator.foreach(Iterator.scala:943)\n\tat scala.collection.Iterator.foreach$(Iterator.scala:943)\n\tat scala.collection.AbstractIterator.foreach(Iterator.scala:1431)\n\tat scala.collection.generic.Growable.$plus$plus$eq(Growable.scala:62)\n\tat scala.collection.generic.Growable.$plus$plus$eq$(Growable.scala:53)\n\tat scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:105)\n\tat scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:49)\n\tat scala.collection.TraversableOnce.to(TraversableOnce.scala:366)\n\tat scala.collection.TraversableOnce.to$(TraversableOnce.scala:364)\n\tat scala.collection.AbstractIterator.to(Iterator.scala:1431)\n\tat scala.collection.TraversableOnce.toBuffer(TraversableOnce.scala:358)\n\tat scala.collection.TraversableOnce.toBuffer$(TraversableOnce.scala:358)\n\tat scala.collection.AbstractIterator.toBuffer(Iterator.scala:1431)\n\tat scala.collection.TraversableOnce.toArray(TraversableOnce.scala:345)\n\tat scala.collection.TraversableOnce.toArray$(TraversableOnce.scala:339)\n\tat scala.collection.AbstractIterator.toArray(Iterator.scala:1431)\n\tat org.apache.spark.rdd.RDD.$anonfun$take$2(RDD.scala:1489)\n\tat org.apache.spark.SparkContext.$anonfun$runJob$5(SparkContext.scala:2455)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)\n\tat org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:141)\n\tat org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)\n\tat org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)\n\tat org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)\n\tat org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:95)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\n\tat java.base/java.lang.Thread.run(Thread.java:829)\n\nDriver stacktrace:\n  at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)\n  at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)\n  at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)\n  at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)\n  at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)\n  at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)\n  at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)\n  at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)\n  at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)\n  at scala.Option.foreach(Option.scala:407)\n  at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)\n  at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)\n  at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2415)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2436)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:2455)\n  at org.apache.spark.rdd.RDD.$anonfun$take$1(RDD.scala:1489)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n  at org.apache.spark.rdd.RDD.withScope(RDD.scala:407)\n  at org.apache.spark.rdd.RDD.take(RDD.scala:1462)\n  at org.apache.spark.ml.tree.impl.DecisionTreeMetadata$.buildMetadata(DecisionTreeMetadata.scala:119)\n  at org.apache.spark.ml.tree.impl.GradientBoostedTrees$.boost(GradientBoostedTrees.scala:333)\n  at org.apache.spark.ml.tree.impl.GradientBoostedTrees$.run(GradientBoostedTrees.scala:61)\n  at org.apache.spark.ml.classification.GBTClassifier.$anonfun$train$1(GBTClassifier.scala:201)\n  at org.apache.spark.ml.util.Instrumentation$.$anonfun$instrumented$1(Instrumentation.scala:191)\n  at scala.util.Try$.apply(Try.scala:213)\n  at org.apache.spark.ml.util.Instrumentation$.instrumented(Instrumentation.scala:191)\n  at org.apache.spark.ml.classification.GBTClassifier.train(GBTClassifier.scala:170)\n  at org.apache.spark.ml.classification.GBTClassifier.train(GBTClassifier.scala:58)\n  at org.apache.spark.ml.Predictor.fit(Predictor.scala:114)\n  at org.apache.spark.ml.Predictor.fit(Predictor.scala:78)\n  at org.apache.spark.ml.Estimator.fit(Estimator.scala:59)\n  at org.apache.spark.ml.tuning.CrossValidator.$anonfun$fit$7(CrossValidator.scala:174)\n  at scala.runtime.java8.JFunction0$mcD$sp.apply(JFunction0$mcD$sp.java:23)\n  at scala.concurrent.Future$.$anonfun$apply$1(Future.scala:659)\n  at scala.util.Success.$anonfun$map$1(Try.scala:255)\n  at scala.util.Success.map(Try.scala:213)\n  at scala.concurrent.Future.$anonfun$map$1(Future.scala:292)\n  at scala.concurrent.impl.Promise.liftedTree1$1(Promise.scala:33)\n  at scala.concurrent.impl.Promise.$anonfun$transform$1(Promise.scala:33)\n  at scala.concurrent.impl.CallbackRunnable.run(Promise.scala:64)\n  at org.apache.spark.util.ThreadUtils$$anon$1.execute(ThreadUtils.scala:99)\n  at scala.concurrent.impl.ExecutionContextImpl$$anon$4.execute(ExecutionContextImpl.scala:138)\n  at scala.concurrent.impl.CallbackRunnable.executeWithValue(Promise.scala:72)\n  at scala.concurrent.impl.Promise$KeptPromise$Kept.onComplete(Promise.scala:372)\n  at scala.concurrent.impl.Promise$KeptPromise$Kept.onComplete$(Promise.scala:371)\n  at scala.concurrent.impl.Promise$KeptPromise$Successful.onComplete(Promise.scala:379)\n  at scala.concurrent.impl.Promise.transform(Promise.scala:33)\n  at scala.concurrent.impl.Promise.transform$(Promise.scala:31)\n  at scala.concurrent.impl.Promise$KeptPromise$Successful.transform(Promise.scala:379)\n  at scala.concurrent.Future.map(Future.scala:292)\n  at scala.concurrent.Future.map$(Future.scala:292)\n  at scala.concurrent.impl.Promise$KeptPromise$Successful.map(Promise.scala:379)\n  at scala.concurrent.Future$.apply(Future.scala:659)\n  at org.apache.spark.ml.tuning.CrossValidator.$anonfun$fit$6(CrossValidator.scala:182)\n  at scala.collection.TraversableLike.$anonfun$map$1(TraversableLike.scala:286)\n  at scala.collection.IndexedSeqOptimized.foreach(IndexedSeqOptimized.scala:36)\n  at scala.collection.IndexedSeqOptimized.foreach$(IndexedSeqOptimized.scala:33)\n  at scala.collection.mutable.ArrayOps$ofRef.foreach(ArrayOps.scala:198)\n  at scala.collection.TraversableLike.map(TraversableLike.scala:286)\n  at scala.collection.TraversableLike.map$(TraversableLike.scala:279)\n  at scala.collection.mutable.ArrayOps$ofRef.map(ArrayOps.scala:198)\n  at org.apache.spark.ml.tuning.CrossValidator.$anonfun$fit$4(CrossValidator.scala:172)\n  ... 80 more\nCaused by: java.lang.RuntimeException: Labels MUST be in {0, 1}, but got 30.0\n  at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.project_doConsume_0$(Unknown Source)\n  at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)\n  at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\n  at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)\n  at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)\n  at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)\n  at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)\n  at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)\n  at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)\n  at scala.collection.Iterator$SliceIterator.hasNext(Iterator.scala:268)\n  at scala.collection.Iterator.foreach(Iterator.scala:943)\n  at scala.collection.Iterator.foreach$(Iterator.scala:943)\n  at scala.collection.AbstractIterator.foreach(Iterator.scala:1431)\n  at scala.collection.generic.Growable.$plus$plus$eq(Growable.scala:62)\n  at scala.collection.generic.Growable.$plus$plus$eq$(Growable.scala:53)\n  at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:105)\n  at scala.collection.mutable.ArrayBuffer.$plus$plus$eq(ArrayBuffer.scala:49)\n  at scala.collection.TraversableOnce.to(TraversableOnce.scala:366)\n  at scala.collection.TraversableOnce.to$(TraversableOnce.scala:364)\n  at scala.collection.AbstractIterator.to(Iterator.scala:1431)\n  at scala.collection.TraversableOnce.toBuffer(TraversableOnce.scala:358)\n  at scala.collection.TraversableOnce.toBuffer$(TraversableOnce.scala:358)\n  at scala.collection.AbstractIterator.toBuffer(Iterator.scala:1431)\n  at scala.collection.TraversableOnce.toArray(TraversableOnce.scala:345)\n  at scala.collection.TraversableOnce.toArray$(TraversableOnce.scala:339)\n  at scala.collection.AbstractIterator.toArray(Iterator.scala:1431)\n  at org.apache.spark.rdd.RDD.$anonfun$take$2(RDD.scala:1489)\n  at org.apache.spark.SparkContext.$anonfun$runJob$5(SparkContext.scala:2455)\n  at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)\n  at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)\n  at org.apache.spark.scheduler.Task.run(Task.scala:141)\n  at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)\n  at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)\n  at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)\n  at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:95)\n  at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)\n  ... 3 more\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:35819/jobs/job?id=272",
              "$$hashKey": "object:2779"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:35819/jobs/job?id=273",
              "$$hashKey": "object:2780"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:35819/jobs/job?id=274",
              "$$hashKey": "object:2781"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:35819/jobs/job?id=275",
              "$$hashKey": "object:2782"
            },
            {
              "jobUrl": "http://cluster-14e4-m.europe-west6-a.c.bigdatasemestre2.internal:35819/jobs/job?id=276",
              "$$hashKey": "object:2783"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1717425404282_1996302402",
      "id": "paragraph_1717425404282_1996302402",
      "dateCreated": "2024-06-03T14:36:44+0000",
      "dateStarted": "2024-06-03T15:09:55+0000",
      "dateFinished": "2024-06-03T15:19:18+0000",
      "status": "ERROR",
      "$$hashKey": "object:298"
    },
    {
      "user": "anonymous",
      "dateUpdated": "2024-06-03T18:34:45+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": true,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1717419283729_1504620502",
      "id": "paragraph_1717419283729_1504620502",
      "dateCreated": "2024-06-03T12:54:43+0000",
      "status": "READY",
      "$$hashKey": "object:299"
    }
  ],
  "name": "Model2_perso",
  "id": "2K1GK49UX",
  "defaultInterpreterGroup": "spark",
  "version": "0.10.1",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {},
  "config": {
    "isZeppelinNotebookCronEnable": false,
    "looknfeel": "default",
    "personalizedMode": "false"
  },
  "info": {
    "isRunning": false
  },
  "path": "/Model2_perso"
}