{
  "paragraphs": [
    {
      "text": "import org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.expressions.Window\nimport org.apache.spark.ml.{Pipeline, PipelineModel}\nimport org.apache.spark.ml.feature.{VectorAssembler, StringIndexer, OneHotEncoder}\nimport org.apache.spark.ml.classification.RandomForestClassifier\nimport org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator\nimport org.apache.spark.ml.tuning.{ParamGridBuilder, CrossValidator}\nimport org.apache.spark.util.SizeEstimator",
      "user": "anonymous",
      "dateUpdated": "2024-06-03T12:14:31+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "import org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.expressions.Window\nimport org.apache.spark.ml.{Pipeline, PipelineModel}\nimport org.apache.spark.ml.feature.{VectorAssembler, StringIndexer, OneHotEncoder}\nimport org.apache.spark.ml.classification.RandomForestClassifier\nimport org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator\nimport org.apache.spark.ml.tuning.{ParamGridBuilder, CrossValidator}\nimport org.apache.spark.util.SizeEstimator\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1717416686375_35938328",
      "id": "paragraph_1717157940361_1842310479",
      "dateCreated": "2024-06-03T12:11:26+0000",
      "dateStarted": "2024-06-03T12:14:31+0000",
      "dateFinished": "2024-06-03T12:14:31+0000",
      "status": "FINISHED",
      "focus": true,
      "$$hashKey": "object:2763"
    },
    {
      "text": "val spark = SparkSession.builder()\n  .appName(\"Football Data Analysis\")\n  .getOrCreate()\n  \n// Specify the path to the directory containing the JSON files\nval bucketPath = \"gs://2024-bda-projet-group-d/open-data/data/events/*.json\"\n\n// Read all JSON files in the directory\nval eventsDF = spark.read\n  .option(\"header\", \"true\")\n  .option(\"multiline\", \"true\")\n  .json(bucketPath)\n\n// Show the first 5 rows of the DataFrame\neventsDF.show(5)",
      "user": "anonymous",
      "dateUpdated": "2024-06-03T12:14:31+0000",
      "progress": 100,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-------------+------------+-------------+-----+-----+---------+------------+-------+----+--------+--------------+--------+----------+--------+----------+--------------------+-----+---------------+------------+------------+------+----------+----------+----+--------------------+------+------------------+-------------------+----------+--------------------+----------+---------------+--------------------+------+----+------------+--------------------+--------------+------------+-----------------+--------------+\n|50_50|bad_behaviour|ball_receipt|ball_recovery|block|carry|clearance|counterpress|dribble|duel|duration|foul_committed|foul_won|goalkeeper|half_end|half_start|                  id|index|injury_stoppage|interception|    location|minute|miscontrol|off_camera| out|                pass|period|      play_pattern|             player|player_off|            position|possession|possession_team|      related_events|second|shot|substitution|             tactics|          team|   timestamp|             type|under_pressure|\n+-----+-------------+------------+-------------+-----+-----+---------+------------+-------+----+--------+--------------+--------+----------+--------+----------+--------------------+-----+---------------+------------+------------+------+----------+----------+----+--------------------+------+------------------+-------------------+----------+--------------------+----------+---------------+--------------------+------+----+------------+--------------------+--------------+------------+-----------------+--------------+\n| NULL|         NULL|        NULL|         NULL| NULL| NULL|     NULL|        NULL|   NULL|NULL|     0.0|          NULL|    NULL|      NULL|    NULL|      NULL|85301abf-234c-4fa...|    1|           NULL|        NULL|        NULL|     0|      NULL|      NULL|NULL|                NULL|     1| {1, Regular Play}|               NULL|      NULL|                NULL|         1| {785, Croatia}|                NULL|     0|NULL|        NULL|{433, [{1, {16531...|{785, Croatia}|00:00:00.000|{35, Starting XI}|          NULL|\n| NULL|         NULL|        NULL|         NULL| NULL| NULL|     NULL|        NULL|   NULL|NULL|     0.0|          NULL|    NULL|      NULL|    NULL|      NULL|b859d5b8-fdc2-409...|    2|           NULL|        NULL|        NULL|     0|      NULL|      NULL|NULL|                NULL|     1| {1, Regular Play}|               NULL|      NULL|                NULL|         1| {785, Croatia}|                NULL|     0|NULL|        NULL|{4411, [{1, {5547...| {781, Brazil}|00:00:00.000|{35, Starting XI}|          NULL|\n| NULL|         NULL|        NULL|         NULL| NULL| NULL|     NULL|        NULL|   NULL|NULL|     0.0|          NULL|    NULL|      NULL|    NULL|      NULL|1263eb64-ec56-4b2...|    3|           NULL|        NULL|        NULL|     0|      NULL|      NULL|NULL|                NULL|     1| {1, Regular Play}|               NULL|      NULL|                NULL|         1| {785, Croatia}|[03eed776-a228-40...|     0|NULL|        NULL|                NULL|{785, Croatia}|00:00:00.000| {18, Half Start}|          NULL|\n| NULL|         NULL|        NULL|         NULL| NULL| NULL|     NULL|        NULL|   NULL|NULL|     0.0|          NULL|    NULL|      NULL|    NULL|      NULL|03eed776-a228-408...|    4|           NULL|        NULL|        NULL|     0|      NULL|      NULL|NULL|                NULL|     1| {1, Regular Play}|               NULL|      NULL|                NULL|         1| {785, Croatia}|[1263eb64-ec56-4b...|     0|NULL|        NULL|                NULL| {781, Brazil}|00:00:00.000| {18, Half Start}|          NULL|\n| NULL|         NULL|        NULL|         NULL| NULL| NULL|     NULL|        NULL|   NULL|NULL| 0.86554|          NULL|    NULL|      NULL|    NULL|      NULL|9f66f598-c069-4be...|    5|           NULL|        NULL|[60.0, 40.0]|     0|      NULL|      NULL|NULL|{NULL, -3.038068,...|     1|{9, From Kick Off}|{5463, Luka Modrić}|      NULL|{13, Right Center...|         2| {785, Croatia}|[687facae-c228-45...|     0|NULL|        NULL|                NULL|{785, Croatia}|00:00:00.489|       {30, Pass}|          NULL|\n+-----+-------------+------------+-------------+-----+-----+---------+------------+-------+----+--------+--------------+--------+----------+--------+----------+--------------------+-----+---------------+------------+------------+------+----------+----------+----+--------------------+------+------------------+-------------------+----------+--------------------+----------+---------------+--------------------+------+----+------------+--------------------+--------------+------------+-----------------+--------------+\nonly showing top 5 rows\n\n\u001b[1m\u001b[34mspark\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.SparkSession\u001b[0m = org.apache.spark.sql.SparkSession@1d3c234d\n\u001b[1m\u001b[34mbucketPath\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = gs://2024-bda-projet-group-d/open-data/data/events/*.json\n\u001b[1m\u001b[34meventsDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [50_50: struct<outcome: struct<id: bigint, name: string>>, bad_behaviour: struct<card: struct<id: bigint, name: string>> ... 40 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=1",
              "$$hashKey": "object:3199"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=2",
              "$$hashKey": "object:3200"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=3",
              "$$hashKey": "object:3201"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1717416686376_1283310802",
      "id": "paragraph_1717053394427_1873686067",
      "dateCreated": "2024-06-03T12:11:26+0000",
      "dateStarted": "2024-06-03T12:14:31+0000",
      "dateFinished": "2024-06-03T12:17:09+0000",
      "status": "FINISHED",
      "$$hashKey": "object:2764"
    },
    {
      "text": "val typeDF = eventsDF.select(col(\"type.id\").alias(\"type\"))\n\n// Show the first 5 rows of the new DataFrame\ntypeDF.show(5)",
      "user": "anonymous",
      "dateUpdated": "2024-06-03T12:17:09+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----+\n|type|\n+----+\n|  35|\n|  35|\n|  18|\n|  18|\n|  30|\n+----+\nonly showing top 5 rows\n\n\u001b[1m\u001b[34mtypeDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [type: bigint]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=4",
              "$$hashKey": "object:3267"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1717416686376_1270722857",
      "id": "paragraph_1717054060732_868004925",
      "dateCreated": "2024-06-03T12:11:26+0000",
      "dateStarted": "2024-06-03T12:17:09+0000",
      "dateFinished": "2024-06-03T12:17:11+0000",
      "status": "FINISHED",
      "$$hashKey": "object:2765"
    },
    {
      "text": "// Define the window specification\nval windowSpec = Window.rowsBetween(-19, 0)\n\n// Apply the window function to create the sliding window\nval slidingWindowDF = typeDF\n  .withColumn(\"events_window\", collect_list(\"type\").over(windowSpec))\n",
      "user": "anonymous",
      "dateUpdated": "2024-06-03T12:17:11+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mwindowSpec\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.expressions.WindowSpec\u001b[0m = org.apache.spark.sql.expressions.WindowSpec@1f5c3964\n\u001b[1m\u001b[34mslidingWindowDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [type: bigint, events_window: array<bigint>]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1717416686377_1582203445",
      "id": "paragraph_1717137303524_1709748586",
      "dateCreated": "2024-06-03T12:11:26+0000",
      "dateStarted": "2024-06-03T12:17:11+0000",
      "dateFinished": "2024-06-03T12:17:11+0000",
      "status": "FINISHED",
      "$$hashKey": "object:2766"
    },
    {
      "text": "// Show the first 5 rows of the new DataFrame with the sliding window\nslidingWindowDF.show(10, false)",
      "user": "anonymous",
      "dateUpdated": "2024-06-03T12:17:11+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+----+----------------------------------------+\n|type|events_window                           |\n+----+----------------------------------------+\n|35  |[35]                                    |\n|35  |[35, 35]                                |\n|18  |[35, 35, 18]                            |\n|18  |[35, 35, 18, 18]                        |\n|30  |[35, 35, 18, 18, 30]                    |\n|42  |[35, 35, 18, 18, 30, 42]                |\n|43  |[35, 35, 18, 18, 30, 42, 43]            |\n|30  |[35, 35, 18, 18, 30, 42, 43, 30]        |\n|42  |[35, 35, 18, 18, 30, 42, 43, 30, 42]    |\n|43  |[35, 35, 18, 18, 30, 42, 43, 30, 42, 43]|\n+----+----------------------------------------+\nonly showing top 10 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=5",
              "$$hashKey": "object:3377"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=6",
              "$$hashKey": "object:3378"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1717416686377_183128489",
      "id": "paragraph_1717137462426_35282807",
      "dateCreated": "2024-06-03T12:11:26+0000",
      "dateStarted": "2024-06-03T12:17:11+0000",
      "dateFinished": "2024-06-03T12:18:23+0000",
      "status": "FINISHED",
      "$$hashKey": "object:2767"
    },
    {
      "text": "val filteredDF = slidingWindowDF\n  .filter(size(col(\"events_window\")) === 20)",
      "user": "anonymous",
      "dateUpdated": "2024-06-03T12:18:23+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mfilteredDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [type: bigint, events_window: array<bigint>]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1717416686377_132546235",
      "id": "paragraph_1717139229374_1292929337",
      "dateCreated": "2024-06-03T12:11:26+0000",
      "dateStarted": "2024-06-03T12:18:23+0000",
      "dateFinished": "2024-06-03T12:18:23+0000",
      "status": "FINISHED",
      "$$hashKey": "object:2768"
    },
    {
      "text": "val expandedDF = filteredDF\n  .withColumn(\"event1\", col(\"events_window\").getItem(0))\n  .withColumn(\"event2\", col(\"events_window\").getItem(1))\n  .withColumn(\"event3\", col(\"events_window\").getItem(2))\n  .withColumn(\"event4\", col(\"events_window\").getItem(3))\n  .withColumn(\"event5\", col(\"events_window\").getItem(4))\n  .withColumn(\"event6\", col(\"events_window\").getItem(5))\n  .withColumn(\"event7\", col(\"events_window\").getItem(6))\n  .withColumn(\"event8\", col(\"events_window\").getItem(7))\n  .withColumn(\"event9\", col(\"events_window\").getItem(8))\n  .withColumn(\"event10\", col(\"events_window\").getItem(9))\n  .withColumn(\"event11\", col(\"events_window\").getItem(10))\n  .withColumn(\"event12\", col(\"events_window\").getItem(11))\n  .withColumn(\"event13\", col(\"events_window\").getItem(12))\n  .withColumn(\"event14\", col(\"events_window\").getItem(13))\n  .withColumn(\"event15\", col(\"events_window\").getItem(14))\n  .withColumn(\"event16\", col(\"events_window\").getItem(15))\n  .withColumn(\"event17\", col(\"events_window\").getItem(16))\n  .withColumn(\"event18\", col(\"events_window\").getItem(17))\n  .withColumn(\"event19\", col(\"events_window\").getItem(18))\n  .withColumn(\"event20\", col(\"events_window\").getItem(19))\n\n  .drop(\"type\", \"events_window\")\n \nexpandedDF.show(5)",
      "user": "anonymous",
      "dateUpdated": "2024-06-03T12:18:23+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+------+------+------+------+------+------+------+------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+\n|event1|event2|event3|event4|event5|event6|event7|event8|event9|event10|event11|event12|event13|event14|event15|event16|event17|event18|event19|event20|\n+------+------+------+------+------+------+------+------+------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+\n|    35|    35|    18|    18|    30|    42|    43|    30|    42|     43|     30|     42|     43|     30|     42|     30|     42|     43|     30|     42|\n|    35|    18|    18|    30|    42|    43|    30|    42|    43|     30|     42|     43|     30|     42|     30|     42|     43|     30|     42|     43|\n|    18|    18|    30|    42|    43|    30|    42|    43|    30|     42|     43|     30|     42|     30|     42|     43|     30|     42|     43|     30|\n|    18|    30|    42|    43|    30|    42|    43|    30|    42|     43|     30|     42|     30|     42|     43|     30|     42|     43|     30|     42|\n|    30|    42|    43|    30|    42|    43|    30|    42|    43|     30|     42|     30|     42|     43|     30|     42|     43|     30|     42|     43|\n+------+------+------+------+------+------+------+------+------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+-------+\nonly showing top 5 rows\n\n\u001b[1m\u001b[34mexpandedDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [event1: bigint, event2: bigint ... 18 more fields]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=7",
              "$$hashKey": "object:3492"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=8",
              "$$hashKey": "object:3493"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1717416686377_414861410",
      "id": "paragraph_1717137576409_1065319230",
      "dateCreated": "2024-06-03T12:11:26+0000",
      "dateStarted": "2024-06-03T12:18:23+0000",
      "dateFinished": "2024-06-03T12:19:25+0000",
      "status": "FINISHED",
      "$$hashKey": "object:2769"
    },
    {
      "text": "// Show size in GB of expandedDF\nprintln(expandedDF.count() + \" rows\")\nprintln(SizeEstimator.estimate(expandedDF))",
      "user": "anonymous",
      "dateUpdated": "2024-06-03T12:19:25+0000",
      "progress": 0,
      "config": {
        "colWidth": 12,
        "fontSize": 9,
        "results": {},
        "enabled": true,
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "11491082 rows\n30628488\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1717416686377_951157130",
      "id": "",
      "dateCreated": "2024-06-03T12:11:26+0000",
      "dateStarted": "2024-06-03T12:19:26+0000",
      "dateFinished": "2024-06-03T12:20:40+0000",
      "status": "FINISHED",
      "$$hashKey": "object:2770"
    },
    {
      "text": "// Définition du schéma pour le DataFrame --> utile pour définir quel features ont veut utiliser lors de l'entrainement\nval schema = new StructType()\n  // Ajout des colonnes avec leur nom, type et utilisation ou non\n  .add(\"event1\", LongType, true)\n  .add(\"event2\", LongType, true)\n  .add(\"event3\", LongType, true)\n  .add(\"event4\", LongType, true)\n  .add(\"event5\", LongType, true)\n  .add(\"event6\", LongType, false)\n  .add(\"event7\", LongType, false)\n  .add(\"event8\", LongType, false)\n  .add(\"event9\", LongType, false)\n  .add(\"event10\", LongType, false)\n  .add(\"event11\", LongType, false)\n  .add(\"event12\", LongType, false)\n  .add(\"event13\", LongType, false)\n  .add(\"event14\", LongType, false)\n  .add(\"event15\", LongType, false)\n  .add(\"event16\", LongType, false)\n  .add(\"event17\", LongType, false)\n  .add(\"event18\", LongType, false)\n  .add(\"event19\", LongType, false)\n  .add(\"event20\", LongType, false)",
      "user": "anonymous",
      "dateUpdated": "2024-06-03T12:20:40+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[1m\u001b[34mschema\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.types.StructType\u001b[0m = StructType(StructField(event1,LongType,true),StructField(event2,LongType,true),StructField(event3,LongType,true),StructField(event4,LongType,true),StructField(event5,LongType,true),StructField(event6,LongType,false),StructField(event7,LongType,false),StructField(event8,LongType,false),StructField(event9,LongType,false),StructField(event10,LongType,false),StructField(event11,LongType,false),StructField(event12,LongType,false),StructField(event13,LongType,false),StructField(event14,LongType,false),StructField(event15,LongType,false),StructField(event16,LongType,false),StructField(event17,LongType,false),StructField(event18,LongType,false),StructField(event19,LongType,false),StructField(event20,LongType,false))\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1717416686377_1786659157",
      "id": "paragraph_1717139186651_286996340",
      "dateCreated": "2024-06-03T12:11:26+0000",
      "dateStarted": "2024-06-03T12:20:40+0000",
      "dateFinished": "2024-06-03T12:20:40+0000",
      "status": "FINISHED",
      "$$hashKey": "object:2771"
    },
    {
      "text": "// 1. Définir les colonnes de features et assembler les features en un vecteur\n\nval featureCols = Array(\"event1\", \"event2\", \"event3\", \"event4\", \"event5\") //, \"event6\", \"event7\", \"event8\", \"event9\", \"event10\", \"event11\", \"event12\", \"event13\", \"event14\", \"event15\", \"event16\", \"event17\", \"event18\", \"event19\", \"event20\")\n\nval assembler = new VectorAssembler()\n  .setInputCols(featureCols)\n  .setOutputCol(\"features\")\n\n// Repartition the DataFrame to distribute data across the cluster\nval numPartitions = 200  // Adjust based on your cluster size and data\nval repartitionedDF = expandedDF.repartition(numPartitions)\n\n// Cache the DataFrame to avoid recomputation\nrepartitionedDF.cache()\n\n\n// 3. Split les données en set de train et de test\nval Array(trainingData, testData) = repartitionedDF.randomSplit(Array(0.8, 0.2))\n\n// 4. Définir les modèles de classification\nval rf = new RandomForestClassifier()\n  .setLabelCol(\"event6\")\n  .setFeaturesCol(\"features\")\n\nval rfParamGrid = new ParamGridBuilder() // --> random forest\n  .addGrid(rf.numTrees, Array(20, 50))\n  .addGrid(rf.maxDepth, Array(5, 10))\n  .build()\n\n// 6. Définir l'évaluateur pour mesurer la précision ou autres\nval evaluator = new MulticlassClassificationEvaluator()\n  .setLabelCol(\"event6\")\n  .setPredictionCol(\"prediction\")\n  .setMetricName(\"accuracy\")\n\n// 7. Configurer la cross validation\nval rfCv = new CrossValidator() // --> random forest\n  .setEstimator(rf)\n  .setEvaluator(evaluator)\n  .setEstimatorParamMaps(rfParamGrid)\n  .setNumFolds(3)\n\n// 8. Création des pipelines pour chaque modèle (comme dans la documentation)\nval rfPipeline = new Pipeline().setStages(Array(assembler, rfCv)) // --> random forest\n\n// Train\nval rfModel = rfPipeline.fit(trainingData) // --> random forest\n\n// Faire les prédictions\nval rfPredictions = rfModel.transform(testData) // --> random forest\n\n// Evaluer les modèles\nval rfAccuracy = evaluator.evaluate(rfPredictions) // --> random forest\n\nprintln(s\"Random Forest Test set accuracy = $rfAccuracy\")",
      "user": "anonymous",
      "dateUpdated": "2024-06-03T12:23:07+0000",
      "progress": 47,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "Random Forest Test set accuracy = 0.7271217973998748\n\u001b[1m\u001b[34mfeatureCols\u001b[0m: \u001b[1m\u001b[32mArray[String]\u001b[0m = Array(event1, event2, event3, event4, event5)\n\u001b[1m\u001b[34massembler\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.feature.VectorAssembler\u001b[0m = VectorAssembler: uid=vecAssembler_e47377c21824, handleInvalid=error, numInputCols=5\n\u001b[1m\u001b[34mnumPartitions\u001b[0m: \u001b[1m\u001b[32mInt\u001b[0m = 200\n\u001b[1m\u001b[34mrepartitionedDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [event1: bigint, event2: bigint ... 18 more fields]\n\u001b[1m\u001b[34mtrainingData\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [event1: bigint, event2: bigint ... 18 more fields]\n\u001b[1m\u001b[34mtestData\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [event1: bigint, event2: bigint ... 18 more fields]\n\u001b[1m\u001b[34mrf\u001b[0m: \u001b[1m\u001b[32morg.ap...\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=11",
              "$$hashKey": "object:3659"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=12",
              "$$hashKey": "object:3660"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=13",
              "$$hashKey": "object:3661"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=14",
              "$$hashKey": "object:3662"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=15",
              "$$hashKey": "object:3663"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=16",
              "$$hashKey": "object:3664"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=17",
              "$$hashKey": "object:3665"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=18",
              "$$hashKey": "object:3666"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=19",
              "$$hashKey": "object:3667"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=20",
              "$$hashKey": "object:3668"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=21",
              "$$hashKey": "object:3669"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=22",
              "$$hashKey": "object:3670"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=23",
              "$$hashKey": "object:3671"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=24",
              "$$hashKey": "object:3672"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=25",
              "$$hashKey": "object:3673"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=26",
              "$$hashKey": "object:3674"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=27",
              "$$hashKey": "object:3675"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=28",
              "$$hashKey": "object:3676"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=29",
              "$$hashKey": "object:3677"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=30",
              "$$hashKey": "object:3678"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=31",
              "$$hashKey": "object:3679"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=32",
              "$$hashKey": "object:3680"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=33",
              "$$hashKey": "object:3681"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=34",
              "$$hashKey": "object:3682"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=35",
              "$$hashKey": "object:3683"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=36",
              "$$hashKey": "object:3684"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=37",
              "$$hashKey": "object:3685"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=38",
              "$$hashKey": "object:3686"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=39",
              "$$hashKey": "object:3687"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=40",
              "$$hashKey": "object:3688"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=41",
              "$$hashKey": "object:3689"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=42",
              "$$hashKey": "object:3690"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=43",
              "$$hashKey": "object:3691"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=44",
              "$$hashKey": "object:3692"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=45",
              "$$hashKey": "object:3693"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=46",
              "$$hashKey": "object:3694"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=47",
              "$$hashKey": "object:3695"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=48",
              "$$hashKey": "object:3696"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=49",
              "$$hashKey": "object:3697"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=50",
              "$$hashKey": "object:3698"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=51",
              "$$hashKey": "object:3699"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=52",
              "$$hashKey": "object:3700"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=53",
              "$$hashKey": "object:3701"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=54",
              "$$hashKey": "object:3702"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=55",
              "$$hashKey": "object:3703"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=56",
              "$$hashKey": "object:3704"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=57",
              "$$hashKey": "object:3705"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=58",
              "$$hashKey": "object:3706"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=59",
              "$$hashKey": "object:3707"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=60",
              "$$hashKey": "object:3708"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=61",
              "$$hashKey": "object:3709"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=62",
              "$$hashKey": "object:3710"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=63",
              "$$hashKey": "object:3711"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=64",
              "$$hashKey": "object:3712"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=65",
              "$$hashKey": "object:3713"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=66",
              "$$hashKey": "object:3714"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=67",
              "$$hashKey": "object:3715"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=68",
              "$$hashKey": "object:3716"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=69",
              "$$hashKey": "object:3717"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=70",
              "$$hashKey": "object:3718"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=71",
              "$$hashKey": "object:3719"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=72",
              "$$hashKey": "object:3720"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=73",
              "$$hashKey": "object:3721"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=74",
              "$$hashKey": "object:3722"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=75",
              "$$hashKey": "object:3723"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=76",
              "$$hashKey": "object:3724"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=77",
              "$$hashKey": "object:3725"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=78",
              "$$hashKey": "object:3726"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=79",
              "$$hashKey": "object:3727"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=80",
              "$$hashKey": "object:3728"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=81",
              "$$hashKey": "object:3729"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=82",
              "$$hashKey": "object:3730"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=83",
              "$$hashKey": "object:3731"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=84",
              "$$hashKey": "object:3732"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=85",
              "$$hashKey": "object:3733"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=86",
              "$$hashKey": "object:3734"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=87",
              "$$hashKey": "object:3735"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=88",
              "$$hashKey": "object:3736"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=89",
              "$$hashKey": "object:3737"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=90",
              "$$hashKey": "object:3738"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=91",
              "$$hashKey": "object:3739"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=92",
              "$$hashKey": "object:3740"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=93",
              "$$hashKey": "object:3741"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=94",
              "$$hashKey": "object:3742"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=95",
              "$$hashKey": "object:3743"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=96",
              "$$hashKey": "object:3744"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=97",
              "$$hashKey": "object:3745"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=98",
              "$$hashKey": "object:3746"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=99",
              "$$hashKey": "object:3747"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=100",
              "$$hashKey": "object:3748"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=101",
              "$$hashKey": "object:3749"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=102",
              "$$hashKey": "object:3750"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=103",
              "$$hashKey": "object:3751"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=104",
              "$$hashKey": "object:3752"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=105",
              "$$hashKey": "object:3753"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=106",
              "$$hashKey": "object:3754"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=107",
              "$$hashKey": "object:3755"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=108",
              "$$hashKey": "object:3756"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=109",
              "$$hashKey": "object:3757"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=110",
              "$$hashKey": "object:3758"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=111",
              "$$hashKey": "object:3759"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=112",
              "$$hashKey": "object:3760"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=113",
              "$$hashKey": "object:3761"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=114",
              "$$hashKey": "object:3762"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=115",
              "$$hashKey": "object:3763"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=116",
              "$$hashKey": "object:3764"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=117",
              "$$hashKey": "object:3765"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=118",
              "$$hashKey": "object:3766"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=119",
              "$$hashKey": "object:3767"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=120",
              "$$hashKey": "object:3768"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=121",
              "$$hashKey": "object:3769"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=122",
              "$$hashKey": "object:3770"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=123",
              "$$hashKey": "object:3771"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=124",
              "$$hashKey": "object:3772"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=125",
              "$$hashKey": "object:3773"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=126",
              "$$hashKey": "object:3774"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=127",
              "$$hashKey": "object:3775"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=128",
              "$$hashKey": "object:3776"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=129",
              "$$hashKey": "object:3777"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=130",
              "$$hashKey": "object:3778"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=131",
              "$$hashKey": "object:3779"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=132",
              "$$hashKey": "object:3780"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=133",
              "$$hashKey": "object:3781"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=134",
              "$$hashKey": "object:3782"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=135",
              "$$hashKey": "object:3783"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=136",
              "$$hashKey": "object:3784"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=137",
              "$$hashKey": "object:3785"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=138",
              "$$hashKey": "object:3786"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=139",
              "$$hashKey": "object:3787"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=140",
              "$$hashKey": "object:3788"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=141",
              "$$hashKey": "object:3789"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=142",
              "$$hashKey": "object:3790"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=143",
              "$$hashKey": "object:3791"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=144",
              "$$hashKey": "object:3792"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=145",
              "$$hashKey": "object:3793"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=146",
              "$$hashKey": "object:3794"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=147",
              "$$hashKey": "object:3795"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=148",
              "$$hashKey": "object:3796"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=149",
              "$$hashKey": "object:3797"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=150",
              "$$hashKey": "object:3798"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=151",
              "$$hashKey": "object:3799"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=152",
              "$$hashKey": "object:3800"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=153",
              "$$hashKey": "object:3801"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=154",
              "$$hashKey": "object:3802"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=155",
              "$$hashKey": "object:3803"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=156",
              "$$hashKey": "object:3804"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=157",
              "$$hashKey": "object:3805"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=158",
              "$$hashKey": "object:3806"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=159",
              "$$hashKey": "object:3807"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=160",
              "$$hashKey": "object:3808"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=161",
              "$$hashKey": "object:3809"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=162",
              "$$hashKey": "object:3810"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=163",
              "$$hashKey": "object:3811"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=164",
              "$$hashKey": "object:3812"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=165",
              "$$hashKey": "object:3813"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=166",
              "$$hashKey": "object:3814"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=167",
              "$$hashKey": "object:3815"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=168",
              "$$hashKey": "object:3816"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=169",
              "$$hashKey": "object:3817"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=170",
              "$$hashKey": "object:3818"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=171",
              "$$hashKey": "object:3819"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=172",
              "$$hashKey": "object:3820"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=173",
              "$$hashKey": "object:3821"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=174",
              "$$hashKey": "object:3822"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=175",
              "$$hashKey": "object:3823"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=176",
              "$$hashKey": "object:3824"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=177",
              "$$hashKey": "object:3825"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=178",
              "$$hashKey": "object:3826"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=179",
              "$$hashKey": "object:3827"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=180",
              "$$hashKey": "object:3828"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=181",
              "$$hashKey": "object:3829"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=182",
              "$$hashKey": "object:3830"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=183",
              "$$hashKey": "object:3831"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=184",
              "$$hashKey": "object:3832"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=185",
              "$$hashKey": "object:3833"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=186",
              "$$hashKey": "object:3834"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=187",
              "$$hashKey": "object:3835"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=188",
              "$$hashKey": "object:3836"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=189",
              "$$hashKey": "object:3837"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=190",
              "$$hashKey": "object:3838"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=191",
              "$$hashKey": "object:3839"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=192",
              "$$hashKey": "object:3840"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=193",
              "$$hashKey": "object:3841"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=194",
              "$$hashKey": "object:3842"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=195",
              "$$hashKey": "object:3843"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=196",
              "$$hashKey": "object:3844"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=197",
              "$$hashKey": "object:3845"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=198",
              "$$hashKey": "object:3846"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=199",
              "$$hashKey": "object:3847"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=200",
              "$$hashKey": "object:3848"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=201",
              "$$hashKey": "object:3849"
            },
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=202",
              "$$hashKey": "object:3850"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1717416686377_760708209",
      "id": "paragraph_1717139737688_1095583986",
      "dateCreated": "2024-06-03T12:11:26+0000",
      "dateStarted": "2024-06-03T12:23:07+0000",
      "dateFinished": "2024-06-03T14:16:12+0000",
      "status": "FINISHED",
      "$$hashKey": "object:2772"
    },
    {
      "text": "rfPredictions.select(\"event6\", \"prediction\").show(10)",
      "user": "anonymous",
      "dateUpdated": "2024-06-03T12:23:11+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+------+----------+\n|event6|prediction|\n+------+----------+\n|    34|      42.0|\n|    30|      30.0|\n|     6|      43.0|\n|    30|      43.0|\n|    43|      43.0|\n|    43|      43.0|\n|    43|      43.0|\n|    43|      43.0|\n|    43|      43.0|\n|     9|       2.0|\n+------+----------+\nonly showing top 10 rows\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {
        "jobUrl": {
          "propertyName": "jobUrl",
          "label": "SPARK JOB",
          "tooltip": "View in Spark web UI",
          "group": "spark",
          "values": [
            {
              "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:40133/jobs/job?id=203",
              "$$hashKey": "object:4672"
            }
          ],
          "interpreterSettingId": "spark"
        }
      },
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1717416686378_1797762205",
      "id": "paragraph_1717144308475_1163562688",
      "dateCreated": "2024-06-03T12:11:26+0000",
      "dateStarted": "2024-06-03T12:23:11+0000",
      "dateFinished": "2024-06-03T14:16:13+0000",
      "status": "FINISHED",
      "$$hashKey": "object:2773"
    },
    {
      "text": "",
      "user": "anonymous",
      "dateUpdated": "2024-06-03T12:11:26+0000",
      "progress": 0,
      "config": {
        "editorSetting": {
          "language": "scala",
          "editOnDblClick": false,
          "completionKey": "TAB",
          "completionSupport": true
        },
        "colWidth": 12,
        "editorMode": "ace/mode/scala",
        "fontSize": 9,
        "editorHide": false,
        "results": {},
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1717416686378_162976118",
      "id": "paragraph_1717140585210_855311603",
      "dateCreated": "2024-06-03T12:11:26+0000",
      "status": "READY",
      "$$hashKey": "object:2774"
    }
  ],
  "name": "Model_2_v1",
  "id": "2K1RT2X3K",
  "defaultInterpreterGroup": "spark",
  "version": "0.10.1",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {},
  "config": {
    "isZeppelinNotebookCronEnable": false,
    "looknfeel": "default",
    "personalizedMode": "false"
  },
  "info": {
    "isRunning": false
  },
  "path": "/Model_2_v1"
}