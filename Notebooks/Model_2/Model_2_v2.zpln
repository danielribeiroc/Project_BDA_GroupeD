{
 "paragraphs": [
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "READY",
   "text": "%md\n\n# Modèle 2 : Prédiction de l'événement suivant dans un match de football\n\nCe Zeppelin notebook a pour objectif de prédire l'événement suivant dans un match de football en utilisant les données d'événements de matchs de football. \n\nContrairement au modèle 1, celui-ci va tenir compte des bonnes pratiques lors de l'utilisation des time series data. En effet, les données d'événements de matchs de football sont des données de séries temporelles, car chaque événement est enregistré dans l'ordre chronologique et se suit dans le temps. \n\nLa façon d'effectuer la fenêtre glissante est différente de celle du modèle 1, car on doit tenir compte de la séparation des matchs. En effet, on ne peut pas mélanger les événements de deux matchs différents.\n\n### Prétraitement des Données\n\nLe dossier `./data/events` contient plusieurs fichiers JSON, chacun étant nommé avec un identifiant unique représentant un match dans le dataset. Le contenu de chaque fichier est à la fois vaste et bien structuré, comme documenté dans le [répertoire GitHub de StatsBomb](https://github.com/statsbomb/open-data/tree/master/doc). Chaque fichier inclut toutes les actions du match, telles que chaque passe, tir, carton jaune, réception, arrêt de balle, etc. Nous avons donc supposé qu'il était possible de regrouper les statistiques d'un match pour créer un modèle capable de prédire laquelle des deux équipes remportera le match.",
   "id": "",
   "dateCreated": "2024-06-04 16:32:29.570",
   "config": {}
  },
  {
   "text": "import org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.DataFrame\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.expressions.Window\nimport org.apache.spark.ml.{Pipeline, PipelineModel}\nimport org.apache.spark.ml.feature.{VectorAssembler, StringIndexer, OneHotEncoder}\nimport org.apache.spark.ml.classification.RandomForestClassifier\nimport org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator\nimport org.apache.spark.ml.tuning.{ParamGridBuilder, CrossValidator}",
   "user": "anonymous",
   "dateUpdated": "2024-06-03T15:20:54+0000",
   "progress": 0,
   "config": {
    "editorSetting": {
     "language": "scala",
     "editOnDblClick": false,
     "completionKey": "TAB",
     "completionSupport": true
    },
    "colWidth": 12,
    "editorMode": "ace/mode/scala",
    "fontSize": 9,
    "results": {},
    "enabled": true
   },
   "settings": {
    "params": {},
    "forms": {}
   },
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "import org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.DataFrame\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.expressions.Window\nimport org.apache.spark.ml.{Pipeline, PipelineModel}\nimport org.apache.spark.ml.feature.{VectorAssembler, StringIndexer, OneHotEncoder}\nimport org.apache.spark.ml.classification.RandomForestClassifier\nimport org.apache.spark.ml.evaluation.MulticlassClassificationEvaluator\nimport org.apache.spark.ml.tuning.{ParamGridBuilder, CrossValidator}\n"
     }
    ]
   },
   "apps": [],
   "runtimeInfos": {},
   "progressUpdateIntervalMs": 500,
   "jobName": "paragraph_1717426918867_644742826",
   "id": "paragraph_1717157940361_1842310479",
   "dateCreated": "2024-06-03T15:01:58+0000",
   "dateStarted": "2024-06-03T15:21:42+0000",
   "dateFinished": "2024-06-03T15:21:42+0000",
   "status": "FINISHED",
   "focus": true,
   "$$hashKey": "object:228"
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "READY",
   "text": "%md\n\n### Lecture des Données\nPremière étape : lire les données JSON dans un DataFrame Spark. Nous avons utilisé la méthode `spark.read.json` pour lire les fichiers JSON dans le dossier `./data/events`. Nous avons également spécifié les options `header` et `multiline` pour traiter les fichiers JSON multilignes.\n\nOn a ajouté une colonne `file_name` pour identifier le fichier d'origine de chaque événement. Cela nous permettra de séparer les matchs lors de la création de la fenêtre glissante.",
   "id": "",
   "dateCreated": "2024-06-04 16:34:13.713",
   "config": {}
  },
  {
   "text": "val spark = SparkSession.builder()\n  .appName(\"Football Data Analysis\")\n  .getOrCreate()\n  \n// Specify the path to the directory containing the JSON files\nval bucketPath = \"gs://2024-bda-projet-group-d/open-data/data/events/*.json\"\n\n// Read all JSON files in the directory\nval eventsDF = spark.read\n  .option(\"header\", \"true\")\n  .option(\"multiline\", \"true\")\n  .json(bucketPath)\n\nval dfWithFileNames = eventsDF.withColumn(\"file_name\", input_file_name())\n// Show the first 5 rows of the DataFrame\ndfWithFileNames.show(5)",
   "user": "anonymous",
   "dateUpdated": "2024-06-03T15:02:07+0000",
   "progress": 100,
   "config": {
    "editorSetting": {
     "language": "scala",
     "editOnDblClick": false,
     "completionKey": "TAB",
     "completionSupport": true
    },
    "colWidth": 12,
    "editorMode": "ace/mode/scala",
    "fontSize": 9,
    "editorHide": false,
    "results": {},
    "enabled": true
   },
   "settings": {
    "params": {},
    "forms": {}
   },
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "+-----+-------------+------------+-------------+-----+-----+---------+------------+-------+----+--------+--------------+--------+----------+--------+----------+--------------------+-----+---------------+------------+------------+------+----------+----------+----+--------------------+------+------------------+-------------------+----------+--------------------+----------+---------------+--------------------+------+----+------------+--------------------+--------------+------------+-----------------+--------------+--------------------+\n|50_50|bad_behaviour|ball_receipt|ball_recovery|block|carry|clearance|counterpress|dribble|duel|duration|foul_committed|foul_won|goalkeeper|half_end|half_start|                  id|index|injury_stoppage|interception|    location|minute|miscontrol|off_camera| out|                pass|period|      play_pattern|             player|player_off|            position|possession|possession_team|      related_events|second|shot|substitution|             tactics|          team|   timestamp|             type|under_pressure|           file_name|\n+-----+-------------+------------+-------------+-----+-----+---------+------------+-------+----+--------+--------------+--------+----------+--------+----------+--------------------+-----+---------------+------------+------------+------+----------+----------+----+--------------------+------+------------------+-------------------+----------+--------------------+----------+---------------+--------------------+------+----+------------+--------------------+--------------+------------+-----------------+--------------+--------------------+\n| NULL|         NULL|        NULL|         NULL| NULL| NULL|     NULL|        NULL|   NULL|NULL|     0.0|          NULL|    NULL|      NULL|    NULL|      NULL|85301abf-234c-4fa...|    1|           NULL|        NULL|        NULL|     0|      NULL|      NULL|NULL|                NULL|     1| {1, Regular Play}|               NULL|      NULL|                NULL|         1| {785, Croatia}|                NULL|     0|NULL|        NULL|{433, [{1, {16531...|{785, Croatia}|00:00:00.000|{35, Starting XI}|          NULL|gs://2024-bda-pro...|\n| NULL|         NULL|        NULL|         NULL| NULL| NULL|     NULL|        NULL|   NULL|NULL|     0.0|          NULL|    NULL|      NULL|    NULL|      NULL|b859d5b8-fdc2-409...|    2|           NULL|        NULL|        NULL|     0|      NULL|      NULL|NULL|                NULL|     1| {1, Regular Play}|               NULL|      NULL|                NULL|         1| {785, Croatia}|                NULL|     0|NULL|        NULL|{4411, [{1, {5547...| {781, Brazil}|00:00:00.000|{35, Starting XI}|          NULL|gs://2024-bda-pro...|\n| NULL|         NULL|        NULL|         NULL| NULL| NULL|     NULL|        NULL|   NULL|NULL|     0.0|          NULL|    NULL|      NULL|    NULL|      NULL|1263eb64-ec56-4b2...|    3|           NULL|        NULL|        NULL|     0|      NULL|      NULL|NULL|                NULL|     1| {1, Regular Play}|               NULL|      NULL|                NULL|         1| {785, Croatia}|[03eed776-a228-40...|     0|NULL|        NULL|                NULL|{785, Croatia}|00:00:00.000| {18, Half Start}|          NULL|gs://2024-bda-pro...|\n| NULL|         NULL|        NULL|         NULL| NULL| NULL|     NULL|        NULL|   NULL|NULL|     0.0|          NULL|    NULL|      NULL|    NULL|      NULL|03eed776-a228-408...|    4|           NULL|        NULL|        NULL|     0|      NULL|      NULL|NULL|                NULL|     1| {1, Regular Play}|               NULL|      NULL|                NULL|         1| {785, Croatia}|[1263eb64-ec56-4b...|     0|NULL|        NULL|                NULL| {781, Brazil}|00:00:00.000| {18, Half Start}|          NULL|gs://2024-bda-pro...|\n| NULL|         NULL|        NULL|         NULL| NULL| NULL|     NULL|        NULL|   NULL|NULL| 0.86554|          NULL|    NULL|      NULL|    NULL|      NULL|9f66f598-c069-4be...|    5|           NULL|        NULL|[60.0, 40.0]|     0|      NULL|      NULL|NULL|{NULL, -3.038068,...|     1|{9, From Kick Off}|{5463, Luka Modrić}|      NULL|{13, Right Center...|         2| {785, Croatia}|[687facae-c228-45...|     0|NULL|        NULL|                NULL|{785, Croatia}|00:00:00.489|       {30, Pass}|          NULL|gs://2024-bda-pro...|\n+-----+-------------+------------+-------------+-----+-----+---------+------------+-------+----+--------+--------------+--------+----------+--------+----------+--------------------+-----+---------------+------------+------------+------+----------+----------+----+--------------------+------+------------------+-------------------+----------+--------------------+----------+---------------+--------------------+------+----+------------+--------------------+--------------+------------+-----------------+--------------+--------------------+\nonly showing top 5 rows\n\n\u001b[1m\u001b[34mspark\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.SparkSession\u001b[0m = org.apache.spark.sql.SparkSession@1efdfceb\n\u001b[1m\u001b[34mbucketPath\u001b[0m: \u001b[1m\u001b[32mString\u001b[0m = gs://2024-bda-projet-group-d/open-data/data/events/*.json\n\u001b[1m\u001b[34meventsDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [50_50: struct<outcome: struct<id: bigint, name: string>>, bad_behaviour: struct<card: struct<id: bigint, name: string>> ... 40 more fields]\n\u001b[1m\u001b[34mdfWithFileNames\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [50_50: struct<outcome: struct<id: bigint, name: string>>, bad_behaviour: struct<card: struct<id: bigint, name: string>> ... 41 more fields]\n"
     }
    ]
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=0",
       "$$hashKey": "object:735"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=1",
       "$$hashKey": "object:736"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=2",
       "$$hashKey": "object:737"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500,
   "jobName": "paragraph_1717426918867_601371521",
   "id": "paragraph_1717053394427_1873686067",
   "dateCreated": "2024-06-03T15:01:58+0000",
   "dateStarted": "2024-06-03T15:02:10+0000",
   "dateFinished": "2024-06-03T15:04:48+0000",
   "status": "FINISHED",
   "$$hashKey": "object:229"
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "READY",
   "text": "%md\n\nRécupère l'id du type d'action pour chaque événement et crée un nouveau DataFrame avec une colonne `type` contenant l'id du type d'action. On a également conservé la colonne `file_name` pour identifier le fichier d'origine de chaque événement.",
   "id": "",
   "dateCreated": "2024-06-04 16:34:34.863",
   "config": {}
  },
  {
   "text": "val typeDF = dfWithFileNames.select(col(\"type.id\").alias(\"type\"), col(\"file_name\"))\n\n// Show the first 5 rows of the new DataFrame\ntypeDF.show(5)",
   "user": "anonymous",
   "dateUpdated": "2024-06-03T15:06:04+0000",
   "progress": 100,
   "config": {
    "editorSetting": {
     "language": "scala",
     "editOnDblClick": false,
     "completionKey": "TAB",
     "completionSupport": true
    },
    "colWidth": 12,
    "editorMode": "ace/mode/scala",
    "fontSize": 9,
    "editorHide": false,
    "results": {},
    "enabled": true
   },
   "settings": {
    "params": {},
    "forms": {}
   },
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "+----+--------------------+\n|type|           file_name|\n+----+--------------------+\n|  35|gs://2024-bda-pro...|\n|  35|gs://2024-bda-pro...|\n|  18|gs://2024-bda-pro...|\n|  18|gs://2024-bda-pro...|\n|  30|gs://2024-bda-pro...|\n+----+--------------------+\nonly showing top 5 rows\n\n\u001b[1m\u001b[34mtypeDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [type: bigint, file_name: string]\n"
     }
    ]
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=3",
       "$$hashKey": "object:791"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500,
   "jobName": "paragraph_1717426918867_572255105",
   "id": "paragraph_1717054060732_868004925",
   "dateCreated": "2024-06-03T15:01:58+0000",
   "dateStarted": "2024-06-03T15:06:04+0000",
   "dateFinished": "2024-06-03T15:06:05+0000",
   "status": "FINISHED",
   "$$hashKey": "object:230"
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "READY",
   "text": "%md\n\n### Séparation des Données\n\nIl est important de séparer d'entrée les données en un ensemble d'entraînement et un ensemble de test lors de traitement de time series. En effet, les données de test ne doivent pas être utilisées indirectement pour l'entraînement du modèle.\n\nNous avons décidé de diviser les données en un ensemble d'entraînement et un ensemble de test en utilisant une approche basée sur les fichiers. Nous avons compté le nombre de fichiers uniques et déterminé que 80 % des fichiers seraient utilisés pour l'ensemble d'entraînement. Nous avons ensuite extrait les noms de fichiers uniques pour l'ensemble d'entraînement et séparé les données en conséquence.",
   "id": "",
   "dateCreated": "2024-06-04 16:34:49.198",
   "config": {}
  },
  {
   "text": "// Count the unique file names\nval uniqueFileNamesCount = typeDF.select(countDistinct(\"file_name\")).first().getLong(0)\n\n// Determine 80% of the file names for the training set\nval trainingFileNamesCount = (uniqueFileNamesCount * 0.8).toLong\n\n// Get the unique file names for the training set\nval trainingFileNames = typeDF\n  .select(\"file_name\")\n  .distinct()\n  .limit(trainingFileNamesCount.toInt)\n  .collect()\n  .map(_.getString(0))\n\n// Split the DataFrame into training and testing sets\nval trainingDF = typeDF.filter(col(\"file_name\").isin(trainingFileNames: _*))\nval testingDF = typeDF.except(trainingDF)\n",
   "user": "anonymous",
   "dateUpdated": "2024-06-03T15:11:05+0000",
   "progress": 0,
   "config": {
    "editorSetting": {
     "language": "scala",
     "editOnDblClick": false,
     "completionKey": "TAB",
     "completionSupport": true
    },
    "colWidth": 12,
    "editorMode": "ace/mode/scala",
    "fontSize": 9,
    "results": {},
    "enabled": true
   },
   "settings": {
    "params": {},
    "forms": {}
   },
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "\u001b[1m\u001b[34muniqueFileNamesCount\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 3263\n\u001b[1m\u001b[34mtrainingFileNamesCount\u001b[0m: \u001b[1m\u001b[32mLong\u001b[0m = 2610\n\u001b[1m\u001b[34mtrainingFileNames\u001b[0m: \u001b[1m\u001b[32mArray[String]\u001b[0m = Array(gs://2024-bda-projet-group-d/open-data/data/events/266827.json, gs://2024-bda-projet-group-d/open-data/data/events/16023.json, gs://2024-bda-projet-group-d/open-data/data/events/16248.json, gs://2024-bda-projet-group-d/open-data/data/events/69302.json, gs://2024-bda-projet-group-d/open-data/data/events/3802802.json, gs://2024-bda-projet-group-d/open-data/data/events/69272.json, gs://2024-bda-projet-group-d/open-data/data/events/16157.json, gs://2024-bda-projet-group-d/open-data/data/events/3890351.json, gs://2024-bda-projet-group-d/open-data/data/events/70263.json, gs://2024-bda-projet-group-d/open-da...\n"
     }
    ]
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=6",
       "$$hashKey": "object:837"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=7",
       "$$hashKey": "object:838"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=8",
       "$$hashKey": "object:839"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=9",
       "$$hashKey": "object:840"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=10",
       "$$hashKey": "object:841"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500,
   "jobName": "paragraph_1717427374724_1516623568",
   "id": "paragraph_1717427374724_1516623568",
   "dateCreated": "2024-06-03T15:09:34+0000",
   "dateStarted": "2024-06-03T15:11:05+0000",
   "dateFinished": "2024-06-03T15:13:18+0000",
   "status": "FINISHED",
   "$$hashKey": "object:231"
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "READY",
   "text": "%md\n\n### Traitement des Données\n\nNous allons maintenant créer une fenêtre glissante de taille 6 pour chaque match. Cela signifie que nous allons prédire le 6ème événement en fonction des 5 événements précédents. Nous allons également filtrer les fenêtres qui ne contiennent pas exactement 6 événements.\n\nToutes les opérations de traitement des données seront effectuées dans la fonction `processDataFrame`, qui prend un DataFrame en entrée et renvoie un DataFrame traité.",
   "id": "",
   "dateCreated": "2024-06-04 16:36:05.629",
   "config": {}
  },
  {
   "text": "def processDataFrame(df: DataFrame): DataFrame = {\n  // Define the window specification partitioned by 'file_name'\n  val windowSpec = Window.partitionBy(\"file_name\").rowsBetween(-5, 0)\n  \n  // Apply the window function to create the sliding window\n  val slidingWindowDF = df\n    .withColumn(\"events_window\", collect_list(\"type\").over(windowSpec))\n  \n  // Filter rows where the window size is 6\n  val filteredDF = slidingWindowDF\n    .filter(size(col(\"events_window\")) === 6)\n  \n  // Expand the events_window array into separate columns\n  val expandedDF = filteredDF\n    .withColumn(\"event1\", col(\"events_window\").getItem(0))\n    .withColumn(\"event2\", col(\"events_window\").getItem(1))\n    .withColumn(\"event3\", col(\"events_window\").getItem(2))\n    .withColumn(\"event4\", col(\"events_window\").getItem(3))\n    .withColumn(\"event5\", col(\"events_window\").getItem(4))\n    .withColumn(\"event6\", col(\"events_window\").getItem(5))\n    .drop(\"type\", \"events_window\", \"file_name\")\n\n  // Return the expanded DataFrame\n  expandedDF\n}",
   "user": "anonymous",
   "dateUpdated": "2024-06-03T15:21:43+0000",
   "progress": 0,
   "config": {
    "editorSetting": {
     "language": "scala",
     "editOnDblClick": false,
     "completionKey": "TAB",
     "completionSupport": true
    },
    "colWidth": 12,
    "editorMode": "ace/mode/scala",
    "fontSize": 9,
    "results": {},
    "enabled": true
   },
   "settings": {
    "params": {},
    "forms": {}
   },
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "\u001b[1m\u001b[34mprocessDataFrame\u001b[0m: \u001b[1m\u001b[32m(df: org.apache.spark.sql.DataFrame)org.apache.spark.sql.DataFrame\u001b[0m\n"
     }
    ]
   },
   "apps": [],
   "runtimeInfos": {},
   "progressUpdateIntervalMs": 500,
   "jobName": "paragraph_1717427643085_1245991094",
   "id": "paragraph_1717427643085_1245991094",
   "dateCreated": "2024-06-03T15:14:03+0000",
   "dateStarted": "2024-06-03T15:21:44+0000",
   "dateFinished": "2024-06-03T15:21:44+0000",
   "status": "FINISHED",
   "$$hashKey": "object:232"
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "READY",
   "text": "%md\n\nNous allons maintenant appliquer la fonction `processDataFrame` aux DataFrames d'entraînement et de test pour créer des DataFrames traités. Nous afficherons les 5 premières lignes de chaque DataFrame pour vérifier que le traitement a été effectué correctement.",
   "id": "",
   "dateCreated": "2024-06-04 16:36:38.786",
   "config": {}
  },
  {
   "text": "val trainingProcessedDF = processDataFrame(trainingDF)\nval testingProcessedDF = processDataFrame(testingDF)",
   "user": "anonymous",
   "dateUpdated": "2024-06-03T15:21:47+0000",
   "progress": 24,
   "config": {
    "editorSetting": {
     "language": "scala",
     "editOnDblClick": false,
     "completionKey": "TAB",
     "completionSupport": true
    },
    "colWidth": 12,
    "editorMode": "ace/mode/scala",
    "fontSize": 9,
    "results": {},
    "enabled": true
   },
   "settings": {
    "params": {},
    "forms": {}
   },
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "\u001b[1m\u001b[34mtrainingProcessedDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [event1: bigint, event2: bigint ... 4 more fields]\n\u001b[1m\u001b[34mtestingProcessedDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [event1: bigint, event2: bigint ... 4 more fields]\n"
     }
    ]
   },
   "apps": [],
   "runtimeInfos": {},
   "progressUpdateIntervalMs": 500,
   "jobName": "paragraph_1717427690948_1358668691",
   "id": "paragraph_1717427690948_1358668691",
   "dateCreated": "2024-06-03T15:14:50+0000",
   "dateStarted": "2024-06-03T15:21:51+0000",
   "dateFinished": "2024-06-03T15:21:52+0000",
   "status": "FINISHED",
   "$$hashKey": "object:233"
  },
  {
   "text": "trainingProcessedDF.show(5)",
   "user": "anonymous",
   "dateUpdated": "2024-06-03T15:21:55+0000",
   "progress": 0,
   "config": {
    "editorSetting": {
     "language": "scala",
     "editOnDblClick": false,
     "completionKey": "TAB",
     "completionSupport": true
    },
    "colWidth": 12,
    "editorMode": "ace/mode/scala",
    "fontSize": 9,
    "results": {},
    "enabled": true
   },
   "settings": {
    "params": {},
    "forms": {}
   },
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "+------+------+------+------+------+------+\n|event1|event2|event3|event4|event5|event6|\n+------+------+------+------+------+------+\n|    35|    35|    18|    18|    30|    42|\n|    35|    18|    18|    30|    42|    43|\n|    18|    18|    30|    42|    43|    30|\n|    18|    30|    42|    43|    30|    42|\n|    30|    42|    43|    30|    42|     4|\n+------+------+------+------+------+------+\nonly showing top 5 rows\n\n"
     }
    ]
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=23",
       "$$hashKey": "object:983"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=24",
       "$$hashKey": "object:984"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500,
   "jobName": "paragraph_1717428013940_1695899246",
   "id": "paragraph_1717428013940_1695899246",
   "dateCreated": "2024-06-03T15:20:13+0000",
   "dateStarted": "2024-06-03T15:21:55+0000",
   "dateFinished": "2024-06-03T15:22:53+0000",
   "status": "FINISHED",
   "$$hashKey": "object:234"
  },
  {
   "text": "testingProcessedDF.show(5)",
   "user": "anonymous",
   "dateUpdated": "2024-06-03T15:21:58+0000",
   "progress": 0,
   "config": {
    "editorSetting": {
     "language": "scala",
     "editOnDblClick": false,
     "completionKey": "TAB",
     "completionSupport": true
    },
    "colWidth": 12,
    "editorMode": "ace/mode/scala",
    "fontSize": 9,
    "results": {},
    "enabled": true
   },
   "settings": {
    "params": {},
    "forms": {}
   },
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "+------+------+------+------+------+------+\n|event1|event2|event3|event4|event5|event6|\n+------+------+------+------+------+------+\n|    16|    39|    24|    14|    28|    38|\n|    39|    24|    14|    28|    38|    36|\n|    24|    14|    28|    38|    36|    10|\n|    14|    28|    38|    36|    10|    40|\n|    28|    38|    36|    10|    40|    30|\n+------+------+------+------+------+------+\nonly showing top 5 rows\n\n"
     }
    ]
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=25",
       "$$hashKey": "object:1034"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=26",
       "$$hashKey": "object:1035"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=27",
       "$$hashKey": "object:1036"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=28",
       "$$hashKey": "object:1037"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=29",
       "$$hashKey": "object:1038"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500,
   "jobName": "paragraph_1717428031447_2077239153",
   "id": "paragraph_1717428031447_2077239153",
   "dateCreated": "2024-06-03T15:20:31+0000",
   "dateStarted": "2024-06-03T15:21:58+0000",
   "dateFinished": "2024-06-03T15:24:54+0000",
   "status": "FINISHED",
   "$$hashKey": "object:235"
  },
  {
   "text": "println(\"Number of training rows: \" + trainingProcessedDF.count() + \" rows\")\nprintln(\"Number of testing rows: \" + testingProcessedDF.count() + \" rows\")",
   "user": "anonymous",
   "dateUpdated": "2024-06-03T15:22:01+0000",
   "progress": 0,
   "config": {
    "editorSetting": {
     "language": "scala",
     "editOnDblClick": false,
     "completionKey": "TAB",
     "completionSupport": true
    },
    "colWidth": 12,
    "editorMode": "ace/mode/scala",
    "fontSize": 9,
    "results": {},
    "enabled": true
   },
   "settings": {
    "params": {},
    "forms": {}
   },
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "Number of training rows: 9290957 rows\nNumber of testing rows: 14374 rows\n"
     }
    ]
   },
   "apps": [],
   "runtimeInfos": {},
   "progressUpdateIntervalMs": 500,
   "jobName": "paragraph_1717426918867_610350491",
   "id": "",
   "dateCreated": "2024-06-03T15:01:58+0000",
   "dateStarted": "2024-06-03T15:22:53+0000",
   "dateFinished": "2024-06-03T15:28:10+0000",
   "status": "FINISHED",
   "$$hashKey": "object:236"
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "READY",
   "text": "%md\n\n### Définition du Schéma\n\nNous allons maintenant définir le schéma pour le DataFrame traité. Cela nous permettra de spécifier quelles fonctionnalités nous voulons utiliser lors de l'entraînement du modèle.",
   "id": "",
   "dateCreated": "2024-06-04 16:36:58.087",
   "config": {}
  },
  {
   "text": "// Définition du schéma pour le DataFrame --> utile pour définir quel features ont veut utiliser lors de l'entrainement\nval schema = new StructType()\n  // Ajout des colonnes avec leur nom, type et utilisation ou non\n  .add(\"event1\", LongType, true)\n  .add(\"event2\", LongType, true)\n  .add(\"event3\", LongType, true)\n  .add(\"event4\", LongType, true)\n  .add(\"event5\", LongType, true)\n  .add(\"event6\", LongType, false)",
   "user": "anonymous",
   "dateUpdated": "2024-06-03T15:28:27+0000",
   "progress": 0,
   "config": {
    "editorSetting": {
     "language": "scala",
     "editOnDblClick": false,
     "completionKey": "TAB",
     "completionSupport": true
    },
    "colWidth": 12,
    "editorMode": "ace/mode/scala",
    "fontSize": 9,
    "editorHide": false,
    "results": {},
    "enabled": true
   },
   "settings": {
    "params": {},
    "forms": {}
   },
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "\u001b[1m\u001b[34mschema\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.types.StructType\u001b[0m = StructType(StructField(event1,LongType,true),StructField(event2,LongType,true),StructField(event3,LongType,true),StructField(event4,LongType,true),StructField(event5,LongType,true),StructField(event6,LongType,false))\n"
     }
    ]
   },
   "apps": [],
   "runtimeInfos": {},
   "progressUpdateIntervalMs": 500,
   "jobName": "paragraph_1717426918867_1420381577",
   "id": "paragraph_1717139186651_286996340",
   "dateCreated": "2024-06-03T15:01:58+0000",
   "dateStarted": "2024-06-03T15:28:27+0000",
   "dateFinished": "2024-06-03T15:28:28+0000",
   "status": "FINISHED",
   "$$hashKey": "object:237"
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "READY",
   "text": "%md\n\n### Assemblage des Features\n\nNous allons assembler les colonnes de features en un vecteur en utilisant la classe `VectorAssembler`. Cela nous permettra de combiner les colonnes de features en une seule colonne contenant un vecteur de features.\n\nNous allons également répartir les DataFrames d'entraînement et de test sur plusieurs partitions pour distribuer les données sur le cluster. Enfin, nous allons mettre en cache les DataFrames pour éviter de recalculer les transformations.",
   "id": "",
   "dateCreated": "2024-06-04 16:37:12.018",
   "config": {}
  },
  {
   "text": "// 1. Définir les colonnes de features et assembler les features en un vecteur\n\nval featureCols = Array(\"event1\", \"event2\", \"event3\", \"event4\", \"event5\") \n\nval assembler = new VectorAssembler()\n  .setInputCols(featureCols)\n  .setOutputCol(\"features\")\n\n// Repartition the DataFrame to distribute data across the cluster\nval numPartitions = 200 \nval repartitionedTrainingDF = trainingProcessedDF.repartition(numPartitions)\nval repartitionedTestingDF = testingProcessedDF.repartition(numPartitions)\n\n// Cache the DataFrame to avoid recomputation\nrepartitionedTrainingDF.cache()\nrepartitionedTestingDF.cache()",
   "user": "anonymous",
   "dateUpdated": "2024-06-03T15:28:30+0000",
   "progress": 0,
   "config": {
    "editorSetting": {
     "language": "scala",
     "editOnDblClick": false,
     "completionKey": "TAB",
     "completionSupport": true
    },
    "colWidth": 12,
    "editorMode": "ace/mode/scala",
    "fontSize": 9,
    "results": {},
    "enabled": true
   },
   "settings": {
    "params": {},
    "forms": {}
   },
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "\u001b[1m\u001b[34mfeatureCols\u001b[0m: \u001b[1m\u001b[32mArray[String]\u001b[0m = Array(event1, event2, event3, event4, event5)\n\u001b[1m\u001b[34massembler\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.feature.VectorAssembler\u001b[0m = VectorAssembler: uid=vecAssembler_08793aed46ba, handleInvalid=error, numInputCols=5\n\u001b[1m\u001b[34mnumPartitions\u001b[0m: \u001b[1m\u001b[32mInt\u001b[0m = 200\n\u001b[1m\u001b[34mrepartitionedTrainingDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [event1: bigint, event2: bigint ... 4 more fields]\n\u001b[1m\u001b[34mrepartitionedTestingDF\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.Dataset[org.apache.spark.sql.Row]\u001b[0m = [event1: bigint, event2: bigint ... 4 more fields]\n\u001b[1m\u001b[34mres16\u001b[0m: \u001b[1m\u001b[32mrepartitionedTestingDF.type\u001b[0m = [event1: bigint, event2: bigint ... 4 more fields]\n"
     }
    ]
   },
   "apps": [],
   "runtimeInfos": {},
   "progressUpdateIntervalMs": 500,
   "jobName": "paragraph_1717428220600_461951848",
   "id": "paragraph_1717428220600_461951848",
   "dateCreated": "2024-06-03T15:23:40+0000",
   "dateStarted": "2024-06-03T15:28:30+0000",
   "dateFinished": "2024-06-03T15:28:31+0000",
   "status": "FINISHED",
   "$$hashKey": "object:238"
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "READY",
   "text": "%md\n\n### Modèle de Classification\n\nNous allons utiliser un modèle de classification RandomForest pour prédire l'événement suivant. Nous allons définir les paramètres du modèle RandomForest et les grilles de recherche pour la validation croisée.",
   "id": "",
   "dateCreated": "2024-06-04 16:37:29.462",
   "config": {}
  },
  {
   "text": "// 4. Définir les modèles de classification\nval rf = new RandomForestClassifier()\n  .setLabelCol(\"event6\")\n  .setFeaturesCol(\"features\")\n\nval rfParamGrid = new ParamGridBuilder() // --> random forest\n  .addGrid(rf.numTrees, Array(20, 50))\n  .addGrid(rf.maxDepth, Array(5, 10))\n  .build()\n\n// 6. Définir l'évaluateur pour mesurer la précision ou autres\nval evaluator = new MulticlassClassificationEvaluator()\n  .setLabelCol(\"event6\")\n  .setPredictionCol(\"prediction\")\n  .setMetricName(\"accuracy\")\n\n// 7. Configurer la cross validation\nval rfCv = new CrossValidator() // --> random forest\n  .setEstimator(rf)\n  .setEvaluator(evaluator)\n  .setEstimatorParamMaps(rfParamGrid)\n  .setNumFolds(3)\n\n// 8. Création des pipelines pour chaque modèle (comme dans la documentation)\nval rfPipeline = new Pipeline().setStages(Array(assembler, rfCv)) // --> random forest\n\n// Train\nval rfModel = rfPipeline.fit(repartitionedTrainingDF) // --> random forest",
   "user": "anonymous",
   "dateUpdated": "2024-06-03T15:28:35+0000",
   "progress": 69,
   "config": {
    "editorSetting": {
     "language": "scala",
     "editOnDblClick": false,
     "completionKey": "TAB",
     "completionSupport": true
    },
    "colWidth": 12,
    "editorMode": "ace/mode/scala",
    "fontSize": 9,
    "results": {},
    "enabled": true
   },
   "settings": {
    "params": {},
    "forms": {}
   },
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "\u001b[1m\u001b[34mrf\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.classification.RandomForestClassifier\u001b[0m = rfc_83d34e423aee\n\u001b[1m\u001b[34mrfParamGrid\u001b[0m: \u001b[1m\u001b[32mArray[org.apache.spark.ml.param.ParamMap]\u001b[0m =\nArray({\n\trfc_83d34e423aee-maxDepth: 5,\n\trfc_83d34e423aee-numTrees: 20\n}, {\n\trfc_83d34e423aee-maxDepth: 10,\n\trfc_83d34e423aee-numTrees: 20\n}, {\n\trfc_83d34e423aee-maxDepth: 5,\n\trfc_83d34e423aee-numTrees: 50\n}, {\n\trfc_83d34e423aee-maxDepth: 10,\n\trfc_83d34e423aee-numTrees: 50\n})\n\u001b[1m\u001b[34mevaluator\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.evaluation.MulticlassClassificationEvaluator\u001b[0m = MulticlassClassificationEvaluator: uid=mcEval_58195b017485, metricName=accuracy, metricLabel=0.0, beta=1.0, eps=1.0E-15\n\u001b[1m\u001b[34mrfCv\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.ml.tuning.CrossValidator\u001b[0m = cv_7bf761139974\n\u001b[1m\u001b[34mrfPipe...\n"
     }
    ]
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=39",
       "$$hashKey": "object:1220"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=40",
       "$$hashKey": "object:1221"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=41",
       "$$hashKey": "object:1222"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=42",
       "$$hashKey": "object:1223"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=43",
       "$$hashKey": "object:1224"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=44",
       "$$hashKey": "object:1225"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=45",
       "$$hashKey": "object:1226"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=46",
       "$$hashKey": "object:1227"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=47",
       "$$hashKey": "object:1228"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=48",
       "$$hashKey": "object:1229"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=49",
       "$$hashKey": "object:1230"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=50",
       "$$hashKey": "object:1231"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=51",
       "$$hashKey": "object:1232"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=52",
       "$$hashKey": "object:1233"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=53",
       "$$hashKey": "object:1234"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=54",
       "$$hashKey": "object:1235"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=55",
       "$$hashKey": "object:1236"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=56",
       "$$hashKey": "object:1237"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=57",
       "$$hashKey": "object:1238"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=58",
       "$$hashKey": "object:1239"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=59",
       "$$hashKey": "object:1240"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=60",
       "$$hashKey": "object:1241"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=61",
       "$$hashKey": "object:1242"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=62",
       "$$hashKey": "object:1243"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=63",
       "$$hashKey": "object:1244"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=64",
       "$$hashKey": "object:1245"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=65",
       "$$hashKey": "object:1246"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=66",
       "$$hashKey": "object:1247"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=67",
       "$$hashKey": "object:1248"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=68",
       "$$hashKey": "object:1249"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=69",
       "$$hashKey": "object:1250"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=70",
       "$$hashKey": "object:1251"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=71",
       "$$hashKey": "object:1252"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=72",
       "$$hashKey": "object:1253"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=73",
       "$$hashKey": "object:1254"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=74",
       "$$hashKey": "object:1255"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=75",
       "$$hashKey": "object:1256"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=76",
       "$$hashKey": "object:1257"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=77",
       "$$hashKey": "object:1258"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=78",
       "$$hashKey": "object:1259"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=79",
       "$$hashKey": "object:1260"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=80",
       "$$hashKey": "object:1261"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=81",
       "$$hashKey": "object:1262"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=82",
       "$$hashKey": "object:1263"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=83",
       "$$hashKey": "object:1264"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=84",
       "$$hashKey": "object:1265"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=85",
       "$$hashKey": "object:1266"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=86",
       "$$hashKey": "object:1267"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=87",
       "$$hashKey": "object:1268"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=88",
       "$$hashKey": "object:1269"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=89",
       "$$hashKey": "object:1270"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=90",
       "$$hashKey": "object:1271"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=91",
       "$$hashKey": "object:1272"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=92",
       "$$hashKey": "object:1273"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=93",
       "$$hashKey": "object:1274"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=94",
       "$$hashKey": "object:1275"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=95",
       "$$hashKey": "object:1276"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=96",
       "$$hashKey": "object:1277"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=97",
       "$$hashKey": "object:1278"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=98",
       "$$hashKey": "object:1279"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=99",
       "$$hashKey": "object:1280"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=100",
       "$$hashKey": "object:1281"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=101",
       "$$hashKey": "object:1282"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=102",
       "$$hashKey": "object:1283"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=103",
       "$$hashKey": "object:1284"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=104",
       "$$hashKey": "object:1285"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=105",
       "$$hashKey": "object:1286"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=106",
       "$$hashKey": "object:1287"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=107",
       "$$hashKey": "object:1288"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=108",
       "$$hashKey": "object:1289"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=109",
       "$$hashKey": "object:1290"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=110",
       "$$hashKey": "object:1291"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=111",
       "$$hashKey": "object:1292"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=112",
       "$$hashKey": "object:1293"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=113",
       "$$hashKey": "object:1294"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=114",
       "$$hashKey": "object:1295"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=115",
       "$$hashKey": "object:1296"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=116",
       "$$hashKey": "object:1297"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=117",
       "$$hashKey": "object:1298"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=118",
       "$$hashKey": "object:1299"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=119",
       "$$hashKey": "object:1300"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=120",
       "$$hashKey": "object:1301"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=121",
       "$$hashKey": "object:1302"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=122",
       "$$hashKey": "object:1303"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=123",
       "$$hashKey": "object:1304"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=124",
       "$$hashKey": "object:1305"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=125",
       "$$hashKey": "object:1306"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=126",
       "$$hashKey": "object:1307"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=127",
       "$$hashKey": "object:1308"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=128",
       "$$hashKey": "object:1309"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=129",
       "$$hashKey": "object:1310"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=130",
       "$$hashKey": "object:1311"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=131",
       "$$hashKey": "object:1312"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=132",
       "$$hashKey": "object:1313"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=133",
       "$$hashKey": "object:1314"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=134",
       "$$hashKey": "object:1315"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=135",
       "$$hashKey": "object:1316"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=136",
       "$$hashKey": "object:1317"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=137",
       "$$hashKey": "object:1318"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=138",
       "$$hashKey": "object:1319"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=139",
       "$$hashKey": "object:1320"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=140",
       "$$hashKey": "object:1321"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=141",
       "$$hashKey": "object:1322"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=142",
       "$$hashKey": "object:1323"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=143",
       "$$hashKey": "object:1324"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=144",
       "$$hashKey": "object:1325"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=145",
       "$$hashKey": "object:1326"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=146",
       "$$hashKey": "object:1327"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=147",
       "$$hashKey": "object:1328"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=148",
       "$$hashKey": "object:1329"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=149",
       "$$hashKey": "object:1330"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=150",
       "$$hashKey": "object:1331"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=151",
       "$$hashKey": "object:1332"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=152",
       "$$hashKey": "object:1333"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=153",
       "$$hashKey": "object:1334"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=154",
       "$$hashKey": "object:1335"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=155",
       "$$hashKey": "object:1336"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=156",
       "$$hashKey": "object:1337"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=157",
       "$$hashKey": "object:1338"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=158",
       "$$hashKey": "object:1339"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=159",
       "$$hashKey": "object:1340"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=160",
       "$$hashKey": "object:1341"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=161",
       "$$hashKey": "object:1342"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=162",
       "$$hashKey": "object:1343"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=163",
       "$$hashKey": "object:1344"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=164",
       "$$hashKey": "object:1345"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=165",
       "$$hashKey": "object:1346"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=166",
       "$$hashKey": "object:1347"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=167",
       "$$hashKey": "object:1348"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=168",
       "$$hashKey": "object:1349"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=169",
       "$$hashKey": "object:1350"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=170",
       "$$hashKey": "object:1351"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=171",
       "$$hashKey": "object:1352"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=172",
       "$$hashKey": "object:1353"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=173",
       "$$hashKey": "object:1354"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=174",
       "$$hashKey": "object:1355"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=175",
       "$$hashKey": "object:1356"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=176",
       "$$hashKey": "object:1357"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=177",
       "$$hashKey": "object:1358"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=178",
       "$$hashKey": "object:1359"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=179",
       "$$hashKey": "object:1360"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=180",
       "$$hashKey": "object:1361"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=181",
       "$$hashKey": "object:1362"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=182",
       "$$hashKey": "object:1363"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=183",
       "$$hashKey": "object:1364"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=184",
       "$$hashKey": "object:1365"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=185",
       "$$hashKey": "object:1366"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=186",
       "$$hashKey": "object:1367"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=187",
       "$$hashKey": "object:1368"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=188",
       "$$hashKey": "object:1369"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=189",
       "$$hashKey": "object:1370"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=190",
       "$$hashKey": "object:1371"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=191",
       "$$hashKey": "object:1372"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=192",
       "$$hashKey": "object:1373"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=193",
       "$$hashKey": "object:1374"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=194",
       "$$hashKey": "object:1375"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=195",
       "$$hashKey": "object:1376"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=196",
       "$$hashKey": "object:1377"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=197",
       "$$hashKey": "object:1378"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=198",
       "$$hashKey": "object:1379"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=199",
       "$$hashKey": "object:1380"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=200",
       "$$hashKey": "object:1381"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=201",
       "$$hashKey": "object:1382"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=202",
       "$$hashKey": "object:1383"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=203",
       "$$hashKey": "object:1384"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=204",
       "$$hashKey": "object:1385"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=205",
       "$$hashKey": "object:1386"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=206",
       "$$hashKey": "object:1387"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=207",
       "$$hashKey": "object:1388"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=208",
       "$$hashKey": "object:1389"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=209",
       "$$hashKey": "object:1390"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=210",
       "$$hashKey": "object:1391"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=211",
       "$$hashKey": "object:1392"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=212",
       "$$hashKey": "object:1393"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=213",
       "$$hashKey": "object:1394"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=214",
       "$$hashKey": "object:1395"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=215",
       "$$hashKey": "object:1396"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=216",
       "$$hashKey": "object:1397"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=217",
       "$$hashKey": "object:1398"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=218",
       "$$hashKey": "object:1399"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=219",
       "$$hashKey": "object:1400"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=220",
       "$$hashKey": "object:1401"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=221",
       "$$hashKey": "object:1402"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=222",
       "$$hashKey": "object:1403"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=223",
       "$$hashKey": "object:1404"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=224",
       "$$hashKey": "object:1405"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=225",
       "$$hashKey": "object:1406"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=226",
       "$$hashKey": "object:1407"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=227",
       "$$hashKey": "object:1408"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=228",
       "$$hashKey": "object:1409"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=229",
       "$$hashKey": "object:1410"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=230",
       "$$hashKey": "object:1411"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=231",
       "$$hashKey": "object:1412"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500,
   "jobName": "paragraph_1717428228430_2022299729",
   "id": "paragraph_1717428228430_2022299729",
   "dateCreated": "2024-06-03T15:23:48+0000",
   "dateStarted": "2024-06-03T15:28:35+0000",
   "dateFinished": "2024-06-03T17:25:12+0000",
   "status": "FINISHED",
   "$$hashKey": "object:239"
  },
  {
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "status": "READY",
   "text": "%md\n\n### Faire les Prédictions\n\nNous allons maintenant faire des prédictions sur l'ensemble de test en utilisant le modèle RandomForest que nous avons entraîné. Nous allons évaluer les prédictions en utilisant l'évaluateur que nous avons défini précédemment.",
   "id": "",
   "dateCreated": "2024-06-04 16:37:45.416",
   "config": {}
  },
  {
   "text": "// Faire les prédictions\nval rfPredictions = rfModel.transform(repartitionedTestingDF) // --> random forest\n\n// Evaluer les modèles\nval rfAccuracy = evaluator.evaluate(rfPredictions) // --> random forest\n\nprintln(s\"Random Forest Test set accuracy = $rfAccuracy\")",
   "user": "anonymous",
   "dateUpdated": "2024-06-03T15:28:37+0000",
   "progress": 47,
   "config": {
    "editorSetting": {
     "language": "scala",
     "editOnDblClick": false,
     "completionKey": "TAB",
     "completionSupport": true
    },
    "colWidth": 12,
    "editorMode": "ace/mode/scala",
    "fontSize": 9,
    "results": {},
    "enabled": true
   },
   "settings": {
    "params": {},
    "forms": {}
   },
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "Random Forest Test set accuracy = 0.03478502852372339\n\u001b[1m\u001b[34mrfPredictions\u001b[0m: \u001b[1m\u001b[32morg.apache.spark.sql.DataFrame\u001b[0m = [event1: bigint, event2: bigint ... 8 more fields]\n\u001b[1m\u001b[34mrfAccuracy\u001b[0m: \u001b[1m\u001b[32mDouble\u001b[0m = 0.03478502852372339\n"
     }
    ]
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=232",
       "$$hashKey": "object:2226"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=233",
       "$$hashKey": "object:2227"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=234",
       "$$hashKey": "object:2228"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=235",
       "$$hashKey": "object:2229"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=236",
       "$$hashKey": "object:2230"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=237",
       "$$hashKey": "object:2231"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=238",
       "$$hashKey": "object:2232"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500,
   "jobName": "paragraph_1717428244665_711552631",
   "id": "paragraph_1717428244665_711552631",
   "dateCreated": "2024-06-03T15:24:04+0000",
   "dateStarted": "2024-06-03T15:28:37+0000",
   "dateFinished": "2024-06-03T17:27:51+0000",
   "status": "FINISHED",
   "$$hashKey": "object:240"
  },
  {
   "text": "rfPredictions.select(\"event6\", \"prediction\").show(10)",
   "user": "anonymous",
   "dateUpdated": "2024-06-03T15:28:39+0000",
   "progress": 0,
   "config": {
    "editorSetting": {
     "language": "scala",
     "editOnDblClick": false,
     "completionKey": "TAB",
     "completionSupport": true
    },
    "colWidth": 12,
    "editorMode": "ace/mode/scala",
    "fontSize": 9,
    "results": {},
    "enabled": true
   },
   "settings": {
    "params": {},
    "forms": {}
   },
   "results": {
    "code": "SUCCESS",
    "msg": [
     {
      "type": "TEXT",
      "data": "+------+----------+\n|event6|prediction|\n+------+----------+\n|     6|      30.0|\n|     2|      30.0|\n|    14|       4.0|\n|     3|      30.0|\n|     9|      23.0|\n|    43|      30.0|\n|    28|      43.0|\n|    38|      30.0|\n|     3|      40.0|\n|    27|      30.0|\n+------+----------+\nonly showing top 10 rows\n\n"
     }
    ]
   },
   "apps": [],
   "runtimeInfos": {
    "jobUrl": {
     "propertyName": "jobUrl",
     "label": "SPARK JOB",
     "tooltip": "View in Spark web UI",
     "group": "spark",
     "values": [
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=239",
       "$$hashKey": "object:2302"
      },
      {
       "jobUrl": "http://spark-m.europe-west6-c.c.bda-project-425310.internal:36725/jobs/job?id=240",
       "$$hashKey": "object:2303"
      }
     ],
     "interpreterSettingId": "spark"
    }
   },
   "progressUpdateIntervalMs": 500,
   "jobName": "paragraph_1717426918868_1003470511",
   "id": "paragraph_1717144308475_1163562688",
   "dateCreated": "2024-06-03T15:01:58+0000",
   "dateStarted": "2024-06-03T17:25:12+0000",
   "dateFinished": "2024-06-03T17:27:53+0000",
   "status": "FINISHED",
   "$$hashKey": "object:241"
  },
  {
   "text": "",
   "user": "anonymous",
   "dateUpdated": "2024-06-03T15:01:58+0000",
   "progress": 0,
   "config": {
    "editorSetting": {
     "language": "scala",
     "editOnDblClick": false,
     "completionKey": "TAB",
     "completionSupport": true
    },
    "colWidth": 12,
    "editorMode": "ace/mode/scala",
    "fontSize": 9,
    "editorHide": false,
    "results": {},
    "enabled": true
   },
   "settings": {
    "params": {},
    "forms": {}
   },
   "apps": [],
   "runtimeInfos": {},
   "progressUpdateIntervalMs": 500,
   "jobName": "paragraph_1717426918868_797030023",
   "id": "paragraph_1717140585210_855311603",
   "dateCreated": "2024-06-03T15:01:58+0000",
   "status": "READY",
   "$$hashKey": "object:242"
  }
 ],
 "name": "Model_2_v2",
 "id": "2JZ28RNG2",
 "defaultInterpreterGroup": "spark",
 "version": "0.10.1",
 "noteParams": {},
 "noteForms": {},
 "angularObjects": {},
 "config": {
  "isZeppelinNotebookCronEnable": false,
  "looknfeel": "default",
  "personalizedMode": "false"
 },
 "info": {},
 "path": "/Model_2_v2"
}